!function(){"use strict";var e={338:function(e,t,s){var n=s(795);t.H=n.createRoot,n.hydrateRoot},795:function(e){e.exports=window.ReactDOM}},t={};function s(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,s),a.exports}var n,r=s(338),a=window.React,i=s(795);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},l.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(n||(n={}));const o="popstate";function c(e,t){if(!1===e||null==e)throw new Error(t)}function d(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(e){}}}function u(e,t){return{usr:e.state,key:e.key,idx:t}}function h(e,t,s,n){return void 0===s&&(s=null),l({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?g(t):t,{state:s,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function m(e){let{pathname:t="/",search:s="",hash:n=""}=e;return s&&"?"!==s&&(t+="?"===s.charAt(0)?s:"?"+s),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function g(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substr(s),e=e.substr(0,s));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}var p;function x(e,t,s){return void 0===s&&(s="/"),function(e,t,s,n){let r=P(("string"==typeof t?g(t):t).pathname||"/",s);if(null==r)return null;let a=f(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){return e.length===t.length&&e.slice(0,-1).every((e,s)=>e===t[s])?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(a);let i=null;for(let e=0;null==i&&e<a.length;++e){let t=M(r);i=R(a[e],t,n)}return i}(e,t,s,!1)}function f(e,t,s,n){void 0===t&&(t=[]),void 0===s&&(s=[]),void 0===n&&(n="");let r=(e,r,a)=>{let i={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};i.relativePath.startsWith("/")&&(c(i.relativePath.startsWith(n),'Absolute route path "'+i.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(n.length));let l=A([n,i.relativePath]),o=s.concat(i);e.children&&e.children.length>0&&(c(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+l+'".'),f(e.children,t,o,l)),(null!=e.path||e.index)&&t.push({path:l,score:S(l,e.index),routesMeta:o})};return e.forEach((e,t)=>{var s;if(""!==e.path&&null!=(s=e.path)&&s.includes("?"))for(let s of v(e.path))r(e,t,s);else r(e,t)}),t}function v(e){let t=e.split("/");if(0===t.length)return[];let[s,...n]=t,r=s.endsWith("?"),a=s.replace(/\?$/,"");if(0===n.length)return r?[a,""]:[a];let i=v(n.join("/")),l=[];return l.push(...i.map(e=>""===e?a:[a,e].join("/"))),r&&l.push(...i),l.map(t=>e.startsWith("/")&&""===t?"/":t)}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(p||(p={})),new Set(["lazy","caseSensitive","path","id","index","children"]);const b=/^:[\w-]+$/,y=3,j=2,w=1,N=10,C=-2,k=e=>"*"===e;function S(e,t){let s=e.split("/"),n=s.length;return s.some(k)&&(n+=C),t&&(n+=j),s.filter(e=>!k(e)).reduce((e,t)=>e+(b.test(t)?y:""===t?w:N),n)}function R(e,t,s){void 0===s&&(s=!1);let{routesMeta:n}=e,r={},a="/",i=[];for(let e=0;e<n.length;++e){let l=n[e],o=e===n.length-1,c="/"===a?t:t.slice(a.length)||"/",d=L({path:l.relativePath,caseSensitive:l.caseSensitive,end:o},c),u=l.route;if(!d&&o&&s&&!n[n.length-1].route.index&&(d=L({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!d)return null;Object.assign(r,d.params),i.push({params:r,pathname:A([a,d.pathname]),pathnameBase:z(A([a,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(a=A([a,d.pathnameBase]))}return i}function L(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[s,n]=function(e,t,s){void 0===t&&(t=!1),void 0===s&&(s=!0),d("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,s)=>(n.push({paramName:t,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),n]}(e.path,e.caseSensitive,e.end),r=t.match(s);if(!r)return null;let a=r[0],i=a.replace(/(.)\/+$/,"$1"),l=r.slice(1),o=n.reduce((e,t,s)=>{let{paramName:n,isOptional:r}=t;if("*"===n){let e=l[s]||"";i=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const o=l[s];return e[n]=r&&!o?void 0:(o||"").replace(/%2F/g,"/"),e},{});return{params:o,pathname:a,pathnameBase:i,pattern:e}}function M(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return d(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function P(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,n=e.charAt(s);return n&&"/"!==n?null:e.slice(s)||"/"}const _=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function I(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?s.length>1&&s.pop():"."!==e&&s.push(e)}),s.length>1?s.join("/"):"/"}function F(e,t,s,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+s+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function E(e,t){let s=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t?s.map((e,t)=>t===s.length-1?e.pathname:e.pathnameBase):s.map(e=>e.pathnameBase)}function O(e,t,s,n){let r;void 0===n&&(n=!1),"string"==typeof e?r=g(e):(r=l({},e),c(!r.pathname||!r.pathname.includes("?"),F("?","pathname","search",r)),c(!r.pathname||!r.pathname.includes("#"),F("#","pathname","hash",r)),c(!r.search||!r.search.includes("#"),F("#","search","hash",r)));let a,i=""===e||""===r.pathname,o=i?"/":r.pathname;if(null==o)a=s;else{let e=t.length-1;if(!n&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}a=e>=0?t[e]:"/"}let u=function(e,t){void 0===t&&(t="/");let s,{pathname:n,search:r="",hash:a=""}="string"==typeof e?g(e):e;if(n)if(i=n,_.test(i))s=n;else{if(n.includes("//")){let e=n;n=n.replace(/\/\/+/g,"/"),d(!1,"Pathnames cannot have embedded double slashes - normalizing "+e+" -> "+n)}s=n.startsWith("/")?I(n.substring(1),"/"):I(n,t)}else s=t;var i;return{pathname:s,search:T(r),hash:D(a)}}(r,a),h=o&&"/"!==o&&o.endsWith("/"),m=(i||"."===o)&&s.endsWith("/");return u.pathname.endsWith("/")||!h&&!m||(u.pathname+="/"),u}const A=e=>e.join("/").replace(/\/\/+/g,"/"),z=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),T=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",D=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;const B=["post","put","patch","delete"],V=(new Set(B),["get",...B]);function W(){return W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},W.apply(this,arguments)}new Set(V),new Set([301,302,303,307,308]),new Set([307,308]),Symbol("deferred");const H=a.createContext(null),$=a.createContext(null),q=a.createContext(null),U=a.createContext(null),Q=a.createContext({outlet:null,matches:[],isDataRoute:!1}),G=a.createContext(null);function K(){return null!=a.useContext(U)}function X(){return K()||c(!1),a.useContext(U).location}function J(e){a.useContext(q).static||a.useLayoutEffect(e)}function Y(){let{isDataRoute:e}=a.useContext(Q);return e?function(){let{router:e}=function(){let e=a.useContext(H);return e||c(!1),e}(ae.UseNavigateStable),t=le(ie.UseNavigateStable),s=a.useRef(!1);return J(()=>{s.current=!0}),a.useCallback(function(n,r){void 0===r&&(r={}),s.current&&("number"==typeof n?e.navigate(n):e.navigate(n,W({fromRouteId:t},r)))},[e,t])}():function(){K()||c(!1);let e=a.useContext(H),{basename:t,future:s,navigator:n}=a.useContext(q),{matches:r}=a.useContext(Q),{pathname:i}=X(),l=JSON.stringify(E(r,s.v7_relativeSplatPath)),o=a.useRef(!1);return J(()=>{o.current=!0}),a.useCallback(function(s,r){if(void 0===r&&(r={}),!o.current)return;if("number"==typeof s)return void n.go(s);let a=O(s,JSON.parse(l),i,"path"===r.relative);null==e&&"/"!==t&&(a.pathname="/"===a.pathname?t:A([t,a.pathname])),(r.replace?n.replace:n.push)(a,r.state,r)},[t,n,l,i,e])}()}function Z(e,t){let{relative:s}=void 0===t?{}:t,{future:n}=a.useContext(q),{matches:r}=a.useContext(Q),{pathname:i}=X(),l=JSON.stringify(E(r,n.v7_relativeSplatPath));return a.useMemo(()=>O(e,JSON.parse(l),i,"path"===s),[e,l,i,s])}function ee(e,t,s,r){K()||c(!1);let{navigator:i}=a.useContext(q),{matches:l}=a.useContext(Q),o=l[l.length-1],d=o?o.params:{},u=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let h,m=X();if(t){var p;let e="string"==typeof t?g(t):t;"/"===u||(null==(p=e.pathname)?void 0:p.startsWith(u))||c(!1),h=e}else h=m;let f=h.pathname||"/",v=f;if("/"!==u){let e=u.replace(/^\//,"").split("/");v="/"+f.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=x(e,{pathname:v}),y=function(e,t,s,n){var r;if(void 0===t&&(t=[]),void 0===s&&(s=null),void 0===n&&(n=null),null==e){var i;if(!s)return null;if(s.errors)e=s.matches;else{if(!(null!=(i=n)&&i.v7_partialHydration&&0===t.length&&!s.initialized&&s.matches.length>0))return null;e=s.matches}}let l=e,o=null==(r=s)?void 0:r.errors;if(null!=o){let e=l.findIndex(e=>e.route.id&&void 0!==(null==o?void 0:o[e.route.id]));e>=0||c(!1),l=l.slice(0,Math.min(l.length,e+1))}let d=!1,u=-1;if(s&&n&&n.v7_partialHydration)for(let e=0;e<l.length;e++){let t=l[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(u=e),t.route.id){let{loaderData:e,errors:n}=s,r=t.route.loader&&void 0===e[t.route.id]&&(!n||void 0===n[t.route.id]);if(t.route.lazy||r){d=!0,l=u>=0?l.slice(0,u+1):[l[0]];break}}}return l.reduceRight((e,n,r)=>{let i,c=!1,h=null,m=null;var g;s&&(i=o&&n.route.id?o[n.route.id]:void 0,h=n.route.errorElement||se,d&&(u<0&&0===r?(oe[g="route-fallback"]||(oe[g]=!0),c=!0,m=null):u===r&&(c=!0,m=n.route.hydrateFallbackElement||null)));let p=t.concat(l.slice(0,r+1)),x=()=>{let t;return t=i?h:c?m:n.route.Component?a.createElement(n.route.Component,null):n.route.element?n.route.element:e,a.createElement(re,{match:n,routeContext:{outlet:e,matches:p,isDataRoute:null!=s},children:t})};return s&&(n.route.ErrorBoundary||n.route.errorElement||0===r)?a.createElement(ne,{location:s.location,revalidation:s.revalidation,component:h,error:i,children:x(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):x()},null)}(b&&b.map(e=>Object.assign({},e,{params:Object.assign({},d,e.params),pathname:A([u,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:A([u,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),l,s,r);return t&&y?a.createElement(U.Provider,{value:{location:W({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:n.Pop}},y):y}function te(){let e=function(){var e;let t=a.useContext(G),s=function(){let e=a.useContext($);return e||c(!1),e}(ie.UseRouteError),n=le(ie.UseRouteError);return void 0!==t?t:null==(e=s.errors)?void 0:e[n]}(),t=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),s?a.createElement("pre",{style:n},s):null,null)}const se=a.createElement(te,null);class ne extends a.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?a.createElement(Q.Provider,{value:this.props.routeContext},a.createElement(G.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function re(e){let{routeContext:t,match:s,children:n}=e,r=a.useContext(H);return r&&r.static&&r.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=s.route.id),a.createElement(Q.Provider,{value:t},n)}var ae=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ae||{}),ie=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ie||{});function le(e){let t=function(){let e=a.useContext(Q);return e||c(!1),e}(),s=t.matches[t.matches.length-1];return s.route.id||c(!1),s.route.id}const oe={};function ce(e){let{to:t,replace:s,state:n,relative:r}=e;K()||c(!1);let{future:i,static:l}=a.useContext(q),{matches:o}=a.useContext(Q),{pathname:d}=X(),u=Y(),h=O(t,E(o,i.v7_relativeSplatPath),d,"path"===r),m=JSON.stringify(h);return a.useEffect(()=>u(JSON.parse(m),{replace:s,state:n,relative:r}),[u,m,r,s,n]),null}function de(e){c(!1)}function ue(e){let{basename:t="/",children:s=null,location:r,navigationType:i=n.Pop,navigator:l,static:o=!1,future:d}=e;K()&&c(!1);let u=t.replace(/^\/*/,"/"),h=a.useMemo(()=>({basename:u,navigator:l,static:o,future:W({v7_relativeSplatPath:!1},d)}),[u,d,l,o]);"string"==typeof r&&(r=g(r));let{pathname:m="/",search:p="",hash:x="",state:f=null,key:v="default"}=r,b=a.useMemo(()=>{let e=P(m,u);return null==e?null:{location:{pathname:e,search:p,hash:x,state:f,key:v},navigationType:i}},[u,m,p,x,f,v,i]);return null==b?null:a.createElement(q.Provider,{value:h},a.createElement(U.Provider,{children:s,value:b}))}function he(e){let{children:t,location:s}=e;return ee(me(t),s)}function me(e,t){void 0===t&&(t=[]);let s=[];return a.Children.forEach(e,(e,n)=>{if(!a.isValidElement(e))return;let r=[...t,n];if(e.type===a.Fragment)return void s.push.apply(s,me(e.props.children,r));e.type!==de&&c(!1),e.props.index&&e.props.children&&c(!1);let i={id:e.props.id||r.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=me(e.props.children,r)),s.push(i)}),s}function ge(){return ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},ge.apply(this,arguments)}function pe(e,t){if(null==e)return{};var s,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)s=a[n],t.indexOf(s)>=0||(r[s]=e[s]);return r}a.startTransition,new Promise(()=>{}),a.Component,new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const xe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],fe=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"];try{window.__reactRouterVersion="6"}catch(e){}const ve=a.createContext({isTransitioning:!1});new Map;const be=a.startTransition;function ye(e){let{basename:t,children:s,future:r,window:i}=e,p=a.useRef();var x;null==p.current&&(p.current=(void 0===(x={window:i,v5Compat:!0})&&(x={}),function(e,t,s,r){void 0===r&&(r={});let{window:a=document.defaultView,v5Compat:i=!1}=r,d=a.history,g=n.Pop,p=null,x=f();function f(){return(d.state||{idx:null}).idx}function v(){g=n.Pop;let e=f(),t=null==e?null:e-x;x=e,p&&p({action:g,location:y.location,delta:t})}function b(e){let t="null"!==a.location.origin?a.location.origin:a.location.href,s="string"==typeof e?e:m(e);return s=s.replace(/ $/,"%20"),c(t,"No window.location.(origin|href) available to create URL for href: "+s),new URL(s,t)}null==x&&(x=0,d.replaceState(l({},d.state,{idx:x}),""));let y={get action(){return g},get location(){return e(a,d)},listen(e){if(p)throw new Error("A history only accepts one active listener");return a.addEventListener(o,v),p=e,()=>{a.removeEventListener(o,v),p=null}},createHref(e){return t(a,e)},createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){g=n.Push;let r=h(y.location,e,t);s&&s(r,e),x=f()+1;let l=u(r,x),o=y.createHref(r);try{d.pushState(l,"",o)}catch(e){if(e instanceof DOMException&&"DataCloneError"===e.name)throw e;a.location.assign(o)}i&&p&&p({action:g,location:y.location,delta:1})},replace:function(e,t){g=n.Replace;let r=h(y.location,e,t);s&&s(r,e),x=f();let a=u(r,x),l=y.createHref(r);d.replaceState(a,"",l),i&&p&&p({action:g,location:y.location,delta:0})},go(e){return d.go(e)}};return y}(function(e,t){let{pathname:s="/",search:n="",hash:r=""}=g(e.location.hash.substr(1));return s.startsWith("/")||s.startsWith(".")||(s="/"+s),h("",{pathname:s,search:n,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){let s=e.document.querySelector("base"),n="";if(s&&s.getAttribute("href")){let t=e.location.href,s=t.indexOf("#");n=-1===s?t:t.slice(0,s)}return n+"#"+("string"==typeof t?t:m(t))},function(e,t){d("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")},x)));let f=p.current,[v,b]=a.useState({action:f.action,location:f.location}),{v7_startTransition:y}=r||{},j=a.useCallback(e=>{y&&be?be(()=>b(e)):b(e)},[b,y]);return a.useLayoutEffect(()=>f.listen(j),[f,j]),a.useEffect(()=>{return null==(e=r)||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),void(t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation));var e,t},[r]),a.createElement(ue,{basename:t,children:s,location:v.location,navigationType:v.action,navigator:f,future:r})}i.flushSync,a.useId;const je="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,we=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ne=a.forwardRef(function(e,t){let s,{onClick:n,relative:r,reloadDocument:i,replace:l,state:o,target:d,to:u,preventScrollReset:h,viewTransition:g}=e,p=pe(e,xe),{basename:x}=a.useContext(q),f=!1;if("string"==typeof u&&we.test(u)&&(s=u,je))try{let e=new URL(window.location.href),t=u.startsWith("//")?new URL(e.protocol+u):new URL(u),s=P(t.pathname,x);t.origin===e.origin&&null!=s?u=s+t.search+t.hash:f=!0}catch(e){}let v=function(e,t){let{relative:s}=void 0===t?{}:t;K()||c(!1);let{basename:n,navigator:r}=a.useContext(q),{hash:i,pathname:l,search:o}=Z(e,{relative:s}),d=l;return"/"!==n&&(d="/"===l?n:A([n,l])),r.createHref({pathname:d,search:o,hash:i})}(u,{relative:r}),b=function(e,t){let{target:s,replace:n,state:r,preventScrollReset:i,relative:l,viewTransition:o}=void 0===t?{}:t,c=Y(),d=X(),u=Z(e,{relative:l});return a.useCallback(t=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(t,s)){t.preventDefault();let s=void 0!==n?n:m(d)===m(u);c(e,{replace:s,state:r,preventScrollReset:i,relative:l,viewTransition:o})}},[d,c,u,n,r,s,e,i,l,o])}(u,{replace:l,state:o,target:d,preventScrollReset:h,relative:r,viewTransition:g});return a.createElement("a",ge({},p,{href:s||v,onClick:f||i?n:function(e){n&&n(e),e.defaultPrevented||b(e)},ref:t,target:d}))}),Ce=a.forwardRef(function(e,t){let{"aria-current":s="page",caseSensitive:n=!1,className:r="",end:i=!1,style:l,to:o,viewTransition:d,children:u}=e,h=pe(e,fe),m=Z(o,{relative:h.relative}),g=X(),p=a.useContext($),{navigator:x,basename:f}=a.useContext(q),v=null!=p&&function(e,t){void 0===t&&(t={});let s=a.useContext(ve);null==s&&c(!1);let{basename:n}=function(){let e=a.useContext(H);return e||c(!1),e}(ke.useViewTransitionState),r=Z(e,{relative:t.relative});if(!s.isTransitioning)return!1;let i=P(s.currentLocation.pathname,n)||s.currentLocation.pathname,l=P(s.nextLocation.pathname,n)||s.nextLocation.pathname;return null!=L(r.pathname,l)||null!=L(r.pathname,i)}(m)&&!0===d,b=x.encodeLocation?x.encodeLocation(m).pathname:m.pathname,y=g.pathname,j=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;n||(y=y.toLowerCase(),j=j?j.toLowerCase():null,b=b.toLowerCase()),j&&f&&(j=P(j,f)||j);const w="/"!==b&&b.endsWith("/")?b.length-1:b.length;let N,C=y===b||!i&&y.startsWith(b)&&"/"===y.charAt(w),k=null!=j&&(j===b||!i&&j.startsWith(b)&&"/"===j.charAt(b.length)),S={isActive:C,isPending:k,isTransitioning:v},R=C?s:void 0;N="function"==typeof r?r(S):[r,C?"active":null,k?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let M="function"==typeof l?l(S):l;return a.createElement(Ne,ge({},h,{"aria-current":R,className:N,ref:t,style:M,to:o,viewTransition:d}),"function"==typeof u?u(S):u)});var ke,Se;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(ke||(ke={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Se||(Se={}));var Re={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Le=new class{#e=Re;#t=!1;setTimeoutProvider(e){this.#e=e}setTimeout(e,t){return this.#e.setTimeout(e,t)}clearTimeout(e){this.#e.clearTimeout(e)}setInterval(e,t){return this.#e.setInterval(e,t)}clearInterval(e){this.#e.clearInterval(e)}},Me="undefined"==typeof window||"Deno"in globalThis;function Pe(){}function _e(e){return"number"==typeof e&&e>=0&&e!==1/0}function Ie(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Fe(e,t){return"function"==typeof e?e(t):e}function Ee(e,t){return"function"==typeof e?e(t):e}function Oe(e,t){const{type:s="all",exact:n,fetchStatus:r,predicate:a,queryKey:i,stale:l}=e;if(i)if(n){if(t.queryHash!==ze(i,t.options))return!1}else if(!De(t.queryKey,i))return!1;if("all"!==s){const e=t.isActive();if("active"===s&&!e)return!1;if("inactive"===s&&e)return!1}return!("boolean"==typeof l&&t.isStale()!==l||r&&r!==t.state.fetchStatus||a&&!a(t))}function Ae(e,t){const{exact:s,status:n,predicate:r,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(s){if(Te(t.options.mutationKey)!==Te(a))return!1}else if(!De(t.options.mutationKey,a))return!1}return!(n&&t.state.status!==n||r&&!r(t))}function ze(e,t){return(t?.queryKeyHashFn||Te)(e)}function Te(e){return JSON.stringify(e,(e,t)=>$e(t)?Object.keys(t).sort().reduce((e,s)=>(e[s]=t[s],e),{}):t)}function De(e,t){return e===t||typeof e==typeof t&&!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&Object.keys(t).every(s=>De(e[s],t[s]))}var Be=Object.prototype.hasOwnProperty;function Ve(e,t,s=0){if(e===t)return e;if(s>500)return t;const n=He(e)&&He(t);if(!(n||$e(e)&&$e(t)))return t;const r=(n?e:Object.keys(e)).length,a=n?t:Object.keys(t),i=a.length,l=n?new Array(i):{};let o=0;for(let c=0;c<i;c++){const i=n?c:a[c],d=e[i],u=t[i];if(d===u){l[i]=d,(n?c<r:Be.call(e,i))&&o++;continue}if(null===d||null===u||"object"!=typeof d||"object"!=typeof u){l[i]=u;continue}const h=Ve(d,u,s+1);l[i]=h,h===d&&o++}return r===i&&o===r?e:l}function We(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}function He(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function $e(e){if(!qe(e))return!1;const t=e.constructor;if(void 0===t)return!0;const s=t.prototype;return!!qe(s)&&!!s.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype}function qe(e){return"[object Object]"===Object.prototype.toString.call(e)}function Ue(e,t,s){return"function"==typeof s.structuralSharing?s.structuralSharing(e,t):!1!==s.structuralSharing?Ve(e,t):t}function Qe(e,t,s=0){const n=[...e,t];return s&&n.length>s?n.slice(1):n}function Ge(e,t,s=0){const n=[t,...e];return s&&n.length>s?n.slice(0,-1):n}var Ke=Symbol();function Xe(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==Ke?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`))}function Je(e,t){return"function"==typeof e?e(...t):!!e}var Ye=function(e){setTimeout(e,0)},Ze=function(){let e=[],t=0,s=e=>{e()},n=e=>{e()},r=Ye;const a=n=>{t?e.push(n):r(()=>{s(n)})};return{batch:a=>{let i;t++;try{i=a()}finally{t--,t||(()=>{const t=e;e=[],t.length&&r(()=>{n(()=>{t.forEach(e=>{s(e)})})})})()}return i},batchCalls:e=>(...t)=>{a(()=>{e(...t)})},schedule:a,setNotifyFunction:e=>{s=e},setBatchNotifyFunction:e=>{n=e},setScheduler:e=>{r=e}}}(),et=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},tt=new class extends et{#s;#n;#r;constructor(){super(),this.#r=e=>{if(!Me&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#n||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#n?.(),this.#n=void 0)}setEventListener(e){this.#r=e,this.#n?.(),this.#n=e(e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()})}setFocused(e){this.#s!==e&&(this.#s=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return"boolean"==typeof this.#s?this.#s:"hidden"!==globalThis.document?.visibilityState}},st=new class extends et{#a=!0;#n;#r;constructor(){super(),this.#r=e=>{if(!Me&&window.addEventListener){const t=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",s)}}}}onSubscribe(){this.#n||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#n?.(),this.#n=void 0)}setEventListener(e){this.#r=e,this.#n?.(),this.#n=e(this.setOnline.bind(this))}setOnline(e){this.#a!==e&&(this.#a=e,this.listeners.forEach(t=>{t(e)}))}isOnline(){return this.#a}};function nt(){let e,t;const s=new Promise((s,n)=>{e=s,t=n});function n(e){Object.assign(s,e),delete s.resolve,delete s.reject}return s.status="pending",s.catch(()=>{}),s.resolve=t=>{n({status:"fulfilled",value:t}),e(t)},s.reject=e=>{n({status:"rejected",reason:e}),t(e)},s}function rt(e){return Math.min(1e3*2**e,3e4)}function at(e){return"online"!==(e??"online")||st.isOnline()}var it=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function lt(e){let t,s=!1,n=0;const r=nt(),a=()=>"pending"!==r.status,i=()=>tt.isFocused()&&("always"===e.networkMode||st.isOnline())&&e.canRun(),l=()=>at(e.networkMode)&&e.canRun(),o=e=>{a()||(t?.(),r.resolve(e))},c=e=>{a()||(t?.(),r.reject(e))},d=()=>new Promise(s=>{t=e=>{(a()||i())&&s(e)},e.onPause?.()}).then(()=>{t=void 0,a()||e.onContinue?.()}),u=()=>{if(a())return;let t;const r=0===n?e.initialPromise:void 0;try{t=r??e.fn()}catch(e){t=Promise.reject(e)}Promise.resolve(t).then(o).catch(t=>{if(a())return;const r=e.retry??(Me?0:3),l=e.retryDelay??rt,o="function"==typeof l?l(n,t):l,h=!0===r||"number"==typeof r&&n<r||"function"==typeof r&&r(n,t);var m;!s&&h?(n++,e.onFail?.(n,t),(m=o,new Promise(e=>{Le.setTimeout(e,m)})).then(()=>i()?void 0:d()).then(()=>{s?c(t):u()})):c(t)})};return{promise:r,status:()=>r.status,cancel:t=>{if(!a()){const s=new it(t);c(s),e.onCancel?.(s)}},continue:()=>(t?.(),r),cancelRetry:()=>{s=!0},continueRetry:()=>{s=!1},canStart:l,start:()=>(l()?u():d().then(u),r)}}var ot=class{#i;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),_e(this.gcTime)&&(this.#i=Le.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Me?1/0:3e5))}clearGcTimeout(){this.#i&&(Le.clearTimeout(this.#i),this.#i=void 0)}},ct=class extends ot{#l;#o;#c;#d;#u;#h;#m;constructor(e){super(),this.#m=!1,this.#h=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#d=e.client,this.#c=this.#d.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#l=ht(this.options),this.state=e.state??this.#l,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#u?.promise}setOptions(e){if(this.options={...this.#h,...e},this.updateGcTime(this.options.gcTime),this.state&&void 0===this.state.data){const e=ht(this.options);void 0!==e.data&&(this.setState(ut(e.data,e.dataUpdatedAt)),this.#l=e)}}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||this.#c.remove(this)}setData(e,t){const s=Ue(this.state.data,e,this.options);return this.#g({data:s,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),s}setState(e,t){this.#g({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#u?.promise;return this.#u?.cancel(e),t?t.then(Pe).catch(Pe):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#l)}isActive(){return this.observers.some(e=>!1!==Ee(e.options.enabled,this))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ke||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0&&this.observers.some(e=>"static"===Fe(e.options.staleTime,this))}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):void 0===this.state.data||this.state.isInvalidated}isStaleByTime(e=0){return void 0===this.state.data||"static"!==e&&(!!this.state.isInvalidated||!Ie(this.state.dataUpdatedAt,e))}onFocus(){const e=this.observers.find(e=>e.shouldFetchOnWindowFocus());e?.refetch({cancelRefetch:!1}),this.#u?.continue()}onOnline(){const e=this.observers.find(e=>e.shouldFetchOnReconnect());e?.refetch({cancelRefetch:!1}),this.#u?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#c.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#u&&(this.#m?this.#u.cancel({revert:!0}):this.#u.cancelRetry()),this.scheduleGc()),this.#c.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#g({type:"invalidate"})}async fetch(e,t){if("idle"!==this.state.fetchStatus&&"rejected"!==this.#u?.status())if(void 0!==this.state.data&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#u)return this.#u.continueRetry(),this.#u.promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find(e=>e.options.queryFn);e&&this.setOptions(e.options)}const s=new AbortController,n=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(this.#m=!0,s.signal)})},r=()=>{const e=Xe(this.options,t),s=(()=>{const e={client:this.#d,queryKey:this.queryKey,meta:this.meta};return n(e),e})();return this.#m=!1,this.options.persister?this.options.persister(e,s,this):e(s)},a=(()=>{const e={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#d,state:this.state,fetchFn:r};return n(e),e})();this.options.behavior?.onFetch(a,this),this.#o=this.state,"idle"!==this.state.fetchStatus&&this.state.fetchMeta===a.fetchOptions?.meta||this.#g({type:"fetch",meta:a.fetchOptions?.meta}),this.#u=lt({initialPromise:t?.initialPromise,fn:a.fetchFn,onCancel:e=>{e instanceof it&&e.revert&&this.setState({...this.#o,fetchStatus:"idle"}),s.abort()},onFail:(e,t)=>{this.#g({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#g({type:"pause"})},onContinue:()=>{this.#g({type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0});try{const e=await this.#u.start();if(void 0===e)throw new Error(`${this.queryHash} data is undefined`);return this.setData(e),this.#c.config.onSuccess?.(e,this),this.#c.config.onSettled?.(e,this.state.error,this),e}catch(e){if(e instanceof it){if(e.silent)return this.#u.promise;if(e.revert){if(void 0===this.state.data)throw e;return this.state.data}}throw this.#g({type:"error",error:e}),this.#c.config.onError?.(e,this),this.#c.config.onSettled?.(this.state.data,e,this),e}finally{this.scheduleGc()}}#g(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...dt(t.data,this.options),fetchMeta:e.meta??null};case"success":const s={...t,...ut(e.data,e.dataUpdatedAt),dataUpdateCount:t.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#o=e.manual?s:void 0,s;case"error":const n=e.error;return{...t,error:n,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}})(this.state),Ze.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),this.#c.notify({query:this,type:"updated",action:e})})}};function dt(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:at(t.networkMode)?"fetching":"paused",...void 0===e&&{error:null,status:"pending"}}}function ut(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function ht(e){const t="function"==typeof e.initialData?e.initialData():e.initialData,s=void 0!==t,n=s?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var mt=class extends et{constructor(e={}){super(),this.config=e,this.#p=new Map}#p;build(e,t,s){const n=t.queryKey,r=t.queryHash??ze(n,t);let a=this.get(r);return a||(a=new ct({client:e,queryKey:n,queryHash:r,options:e.defaultQueryOptions(t),state:s,defaultOptions:e.getQueryDefaults(n)}),this.add(a)),a}add(e){this.#p.has(e.queryHash)||(this.#p.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#p.get(e.queryHash);t&&(e.destroy(),t===e&&this.#p.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Ze.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#p.get(e)}getAll(){return[...this.#p.values()]}find(e){const t={exact:!0,...e};return this.getAll().find(e=>Oe(t,e))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(t=>Oe(e,t)):t}notify(e){Ze.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){Ze.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Ze.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},gt=class extends ot{#d;#x;#f;#u;constructor(e){super(),this.#d=e.client,this.mutationId=e.mutationId,this.#f=e.mutationCache,this.#x=[],this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#x.includes(e)||(this.#x.push(e),this.clearGcTimeout(),this.#f.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#x=this.#x.filter(t=>t!==e),this.scheduleGc(),this.#f.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#x.length||("pending"===this.state.status?this.scheduleGc():this.#f.remove(this))}continue(){return this.#u?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#g({type:"continue"})},s={client:this.#d,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#u=lt({fn:()=>this.options.mutationFn?this.options.mutationFn(e,s):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{this.#g({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#g({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#f.canRun(this)});const n="pending"===this.state.status,r=!this.#u.canStart();try{if(n)t();else{this.#g({type:"pending",variables:e,isPaused:r}),await(this.#f.config.onMutate?.(e,this,s));const t=await(this.options.onMutate?.(e,s));t!==this.state.context&&this.#g({type:"pending",context:t,variables:e,isPaused:r})}const a=await this.#u.start();return await(this.#f.config.onSuccess?.(a,e,this.state.context,this,s)),await(this.options.onSuccess?.(a,e,this.state.context,s)),await(this.#f.config.onSettled?.(a,null,this.state.variables,this.state.context,this,s)),await(this.options.onSettled?.(a,null,e,this.state.context,s)),this.#g({type:"success",data:a}),a}catch(t){try{await(this.#f.config.onError?.(t,e,this.state.context,this,s))}catch(e){Promise.reject(e)}try{await(this.options.onError?.(t,e,this.state.context,s))}catch(e){Promise.reject(e)}try{await(this.#f.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this,s))}catch(e){Promise.reject(e)}try{await(this.options.onSettled?.(void 0,t,e,this.state.context,s))}catch(e){Promise.reject(e)}throw this.#g({type:"error",error:t}),t}finally{this.#f.runNext(this)}}#g(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),Ze.batch(()=>{this.#x.forEach(t=>{t.onMutationUpdate(e)}),this.#f.notify({mutation:this,type:"updated",action:e})})}},pt=class extends et{constructor(e={}){super(),this.config=e,this.#v=new Set,this.#b=new Map,this.#y=0}#v;#b;#y;build(e,t,s){const n=new gt({client:e,mutationCache:this,mutationId:++this.#y,options:e.defaultMutationOptions(t),state:s});return this.add(n),n}add(e){this.#v.add(e);const t=xt(e);if("string"==typeof t){const s=this.#b.get(t);s?s.push(e):this.#b.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#v.delete(e)){const t=xt(e);if("string"==typeof t){const s=this.#b.get(t);if(s)if(s.length>1){const t=s.indexOf(e);-1!==t&&s.splice(t,1)}else s[0]===e&&this.#b.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=xt(e);if("string"==typeof t){const s=this.#b.get(t),n=s?.find(e=>"pending"===e.state.status);return!n||n===e}return!0}runNext(e){const t=xt(e);if("string"==typeof t){const s=this.#b.get(t)?.find(t=>t!==e&&t.state.isPaused);return s?.continue()??Promise.resolve()}return Promise.resolve()}clear(){Ze.batch(()=>{this.#v.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#v.clear(),this.#b.clear()})}getAll(){return Array.from(this.#v)}find(e){const t={exact:!0,...e};return this.getAll().find(e=>Ae(t,e))}findAll(e={}){return this.getAll().filter(t=>Ae(e,t))}notify(e){Ze.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(e=>e.state.isPaused);return Ze.batch(()=>Promise.all(e.map(e=>e.continue().catch(Pe))))}};function xt(e){return e.options.scope?.id}function ft(e){return{onFetch:(t,s)=>{const n=t.options,r=t.fetchOptions?.meta?.fetchMore?.direction,a=t.state.data?.pages||[],i=t.state.data?.pageParams||[];let l={pages:[],pageParams:[]},o=0;const c=async()=>{let s=!1;const c=e=>{!function(e,s,n){let r,a=!1;Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(r??=t.signal,a||(a=!0,r.aborted?n():r.addEventListener("abort",n,{once:!0})),r)})}(e,0,()=>s=!0)},d=Xe(t.options,t.fetchOptions),u=async(e,n,r)=>{if(s)return Promise.reject();if(null==n&&e.pages.length)return Promise.resolve(e);const a=(()=>{const e={client:t.client,queryKey:t.queryKey,pageParam:n,direction:r?"backward":"forward",meta:t.options.meta};return c(e),e})(),i=await d(a),{maxPages:l}=t.options,o=r?Ge:Qe;return{pages:o(e.pages,i,l),pageParams:o(e.pageParams,n,l)}};if(r&&a.length){const e="backward"===r,t={pages:a,pageParams:i},s=(e?bt:vt)(n,t);l=await u(t,s,e)}else{const t=e??a.length;do{const e=0===o?i[0]??n.initialPageParam:vt(n,l);if(o>0&&null==e)break;l=await u(l,e),o++}while(o<t)}return l};t.options.persister?t.fetchFn=()=>t.options.persister?.(c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s):t.fetchFn=c}}}function vt(e,{pages:t,pageParams:s}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,s[n],s):void 0}function bt(e,{pages:t,pageParams:s}){return t.length>0?e.getPreviousPageParam?.(t[0],t,s[0],s):void 0}var yt=window.ReactJSXRuntime,jt=a.createContext(void 0),wt=e=>{const t=a.useContext(jt);if(e)return e;if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Nt=({client:e,children:t})=>(a.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),(0,yt.jsx)(jt.Provider,{value:e,children:t}));const Ct={default:"bg-slate-100 text-slate-700",primary:"bg-wp-primary/10 text-wp-primary",success:"bg-green-100 text-green-700",warning:"bg-yellow-100 text-yellow-700",error:"bg-red-100 text-red-700",info:"bg-blue-100 text-blue-700"},kt={sm:"px-1.5 py-0.5 text-xs",md:"px-2 py-1 text-xs",lg:"px-2.5 py-1 text-sm"};function St({children:e,variant:t="default",size:s="md",dot:n=!1,className:r=""}){const a=Ct[t]||Ct.default,i=kt[s]||kt.md;return(0,yt.jsxs)("span",{className:`\n        inline-flex items-center gap-1 font-medium rounded-full\n        ${a}\n        ${i}\n        ${r}\n      `.trim(),children:[n&&(0,yt.jsx)("span",{className:`\n            w-1.5 h-1.5 rounded-full\n            ${"success"===t?"bg-green-500":""}\n            ${"warning"===t?"bg-yellow-500":""}\n            ${"error"===t?"bg-red-500":""}\n            ${"info"===t?"bg-blue-500":""}\n            ${"primary"===t?"bg-wp-primary":""}\n            ${"default"===t?"bg-slate-500":""}\n          `.trim()}),e]})}St.Status=function({status:e,...t}){const s={active:{variant:"success",children:"Active",dot:!0},inactive:{variant:"default",children:"Inactive",dot:!0},pending:{variant:"warning",children:"Pending",dot:!0},processing:{variant:"info",children:"Processing",dot:!0},error:{variant:"error",children:"Error",dot:!0},complete:{variant:"success",children:"Complete",dot:!0}},n=s[e]||s.inactive;return(0,yt.jsx)(St,{...n,...t})},St.EntityType=function({type:e,...t}){const s={person:{variant:"primary",children:"Person"},organization:{variant:"info",children:"Organization"},location:{variant:"success",children:"Location"},event:{variant:"warning",children:"Event"},product:{variant:"default",children:"Product"},concept:{variant:"default",children:"Concept"}}[e?.toLowerCase()]||{variant:"default",children:e||"Unknown"};return(0,yt.jsx)(St,{...s,...t})};const Rt=()=>(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),Lt=()=>(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})});function Mt({onToggleSidebar:e,vibeAiData:t}){return(0,yt.jsx)("header",{className:"sticky top-0 z-30 bg-white border-b border-slate-200",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between h-14 px-4",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-4",children:[(0,yt.jsx)("button",{onClick:e,className:"p-2 text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-colors","aria-label":"Toggle sidebar",children:(0,yt.jsx)(Rt,{})}),(0,yt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,yt.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-gradient-to-br from-wp-primary to-blue-600 rounded-lg",children:(0,yt.jsx)("span",{className:"text-white font-bold text-sm",children:"AI"})}),(0,yt.jsx)("div",{children:(0,yt.jsx)("h1",{className:"text-lg font-semibold text-slate-800",children:"Entity Index"})}),(0,yt.jsx)(St,{variant:"info",size:"sm",children:"Beta"})]})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,yt.jsxs)("a",{href:"https://developer.example.com/ai-entity-index",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors",children:[(0,yt.jsx)("span",{children:"Docs"}),(0,yt.jsx)(Lt,{})]}),t?.adminUrl&&(0,yt.jsxs)("a",{href:t.adminUrl,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 17l-5-5m0 0l5-5m-5 5h12"})}),(0,yt.jsx)("span",{children:"WP Admin"})]})]})]})})}const Pt=[{path:"/dashboard",label:"Dashboard",icon:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})})},{path:"/entities",label:"Entities",icon:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})},{path:"/kb",label:"Knowledge Base",icon:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),children:[{name:"Overview",path:"/kb"},{name:"Documents",path:"/kb/documents"},{name:"Test Search",path:"/kb/search"},{name:"Settings",path:"/kb/settings"},{name:"Logs",path:"/kb/logs"}]},{path:"/settings",label:"Settings",icon:(0,yt.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})},{path:"/logs",label:"Logs",icon:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}];function _t({collapsed:e}){const t=X();return(0,yt.jsxs)("aside",{className:`\n        fixed left-0 top-14 bottom-0\n        bg-white border-r border-slate-200\n        transition-all duration-300 z-20\n        ${e?"w-16":"w-56"}\n      `,children:[(0,yt.jsx)("nav",{className:"p-3 space-y-1",children:Pt.map(s=>{const n=t.pathname===s.path||"/dashboard"!==s.path&&t.pathname.startsWith(s.path);return(0,yt.jsxs)(Ce,{to:s.path,className:`\n                flex items-center gap-3 px-3 py-2.5 rounded-lg\n                transition-colors duration-150\n                ${n?"bg-wp-primary/10 text-wp-primary":"text-slate-600 hover:bg-slate-100 hover:text-slate-800"}\n              `,title:e?s.label:void 0,children:[(0,yt.jsx)("span",{className:"flex-shrink-0 "+(n?"text-wp-primary":""),children:s.icon}),!e&&(0,yt.jsx)("span",{className:"font-medium truncate",children:s.label})]},s.path)})}),!e&&(0,yt.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-slate-200",children:(0,yt.jsxs)("div",{className:"text-xs text-slate-400",children:[(0,yt.jsx)("p",{children:"AI Entity Index v1.0.0"}),(0,yt.jsx)("p",{className:"mt-1",children:"Powered by Vibe AI"})]})})]})}async function It(e,t={}){const s=(()=>{const e=window.vibeAiData||{};return{apiUrl:e.apiUrl||"/wp-json/vibe-ai/v1",nonce:e.nonce||""}})(),n=`${s.apiUrl}${e}`;s.nonce||console.error("CRITICAL: VibeAiData Nonce is MISSING!",window.vibeAiData);const r={"X-WP-Nonce":s.nonce,...t.headers};t.body&&(r["Content-Type"]="application/json"),console.log(`[DEBUG] API Request: ${e}`,{headers:r,config:s});const a=await fetch(n,{...t,headers:r,credentials:"same-origin"}),i=a.headers.get("content-type"),l=i&&i.includes("application/json");if(!a.ok){403===a.status&&(console.error("CRITICAL: 403 Forbidden. Headers sent:",r),console.error("Window VibeData:",window.vibeAiData));let e=`API Error: ${a.status} ${a.statusText}`;if(l)try{const t=await a.json();e=t.message||t.error||e}catch{}const t=new Error(e);throw t.status=a.status,t.response=a,t}return l?a.json():{success:!0}}const Ft={pipeline:{running:!1,phase:null,progress:0,current_item:null,total_items:0,processed_items:0,started_at:null,eta:null,error:null},stats:{total_entities:0,total_mentions:0,avg_confidence:0,posts_pending:0,posts_processed:0},logs:[]};var Et=function(e={}){const{autoStart:t=!0}=e,[s,n]=(0,a.useState)(Ft),[r,i]=(0,a.useState)(!0),[l,o]=(0,a.useState)(null),c=(0,a.useRef)(null),d=(0,a.useRef)(!0),u=(0,a.useCallback)(async()=>{try{const e=await async function(){return It("/status")}();d.current&&(n(t=>({...t,...e,pipeline:{...t.pipeline,...e.pipeline},stats:{...t.stats,...e.stats},logs:e.logs||t.logs})),o(null))}catch(e){d.current&&o(e.message||"Failed to fetch status")}finally{d.current&&i(!1)}},[]),h=(0,a.useCallback)(()=>{c.current||(c.current=setInterval(()=>{u()},2e3))},[u]),m=(0,a.useCallback)(()=>{c.current&&(clearInterval(c.current),c.current=null)},[]);return(0,a.useEffect)(()=>(d.current=!0,t&&u(),()=>{d.current=!1}),[t,u]),(0,a.useEffect)(()=>(s.pipeline?.running?h():m(),()=>{m()}),[s.pipeline?.running,h,m]),{status:s,pipeline:s.pipeline,stats:s.stats,logs:s.logs,loading:r,error:l,isRunning:s.pipeline?.running||!1,refresh:u,startPolling:h,stopPolling:m}};const Ot=[{key:"queue",label:"Queue",description:"Building post queue"},{key:"extract",label:"Extract",description:"Extracting entities from content"},{key:"resolve",label:"Resolve",description:"Resolving entity identities"},{key:"enrich",label:"Enrich",description:"Enriching entity data"},{key:"link",label:"Link",description:"Creating entity links"},{key:"complete",label:"Complete",description:"Finalizing results"}];var At=function(){const[e,t]=(0,a.useState)({running:!1,phase:null,progress:0,current_item:null,total_items:0,processed_items:0,started_at:null,eta:null,error:null}),[s,n]=(0,a.useState)(!1),[r,i]=(0,a.useState)(!1),[l,o]=(0,a.useState)(null),c=(0,a.useRef)(!0),d=(0,a.useCallback)(async(e={})=>{n(!0),o(null);try{const s=await async function(e={}){return It("/pipeline/start",{method:"POST",body:JSON.stringify(e)})}(e);return c.current&&t(e=>({...e,running:!0,phase:"queue",progress:0,started_at:(new Date).toISOString(),error:null,...s.status})),s}catch(e){throw c.current&&o(e.message||"Failed to start pipeline"),e}finally{c.current&&n(!1)}},[]),u=(0,a.useCallback)(async()=>{i(!0),o(null);try{const e=await async function(){return It("/pipeline/stop",{method:"POST"})}();return c.current&&t(t=>({...t,running:!1,phase:null,...e.status})),e}catch(e){throw c.current&&o(e.message||"Failed to stop pipeline"),e}finally{c.current&&i(!1)}},[]),h=(0,a.useCallback)(async()=>{try{const e=await async function(){return It("/pipeline/status")}();return c.current&&(t(t=>({...t,...e})),o(null)),e}catch(e){throw c.current&&o(e.message||"Failed to fetch pipeline status"),e}},[]),m=(0,a.useCallback)(e=>{t(t=>({...t,...e}))},[]),g=(0,a.useCallback)(()=>e.phase?Ot.findIndex(t=>t.key===e.phase):-1,[e.phase]),p=(0,a.useCallback)(e=>{const t=g();return Ot.findIndex(t=>t.key===e)<t},[g]),x=(0,a.useCallback)(t=>e.running&&e.phase===t,[e.running,e.phase]),f=(0,a.useCallback)(()=>{if(!e.running||!e.started_at||0===e.progress)return null;const t=new Date(e.started_at).getTime(),s=Date.now()-t,n=e.progress/s;if(0===n)return null;const r=(100-e.progress)/n;return new Date(Date.now()+r)},[e.running,e.started_at,e.progress]);return{status:e,running:e.running,phase:e.phase,progress:e.progress,starting:s,stopping:r,error:l,phases:Ot,start:d,stop:u,refresh:h,updateStatus:m,getCurrentPhaseIndex:g,isPhaseComplete:p,isPhaseActive:x,calculateEta:f}};const zt={none:"",sm:"p-3",md:"p-4",lg:"p-6"};function Tt({children:e,padding:t="md",hover:s=!1,border:n=!0,className:r="",...a}){const i=zt[t]||zt.md;return(0,yt.jsx)("div",{className:`\n        bg-white rounded-lg shadow-sm\n        ${n?"border border-slate-200":""}\n        ${s?"hover:shadow-md hover:border-slate-300 transition-shadow":""}\n        ${i}\n        ${r}\n      `.trim(),...a,children:e})}Tt.Header=function({children:e,title:t,subtitle:s,action:n,className:r=""}){return(0,yt.jsxs)("div",{className:`\n        flex items-start justify-between gap-4\n        pb-4 mb-4 border-b border-slate-200\n        ${r}\n      `.trim(),children:[(0,yt.jsxs)("div",{className:"flex-1 min-w-0",children:[t&&(0,yt.jsx)("h3",{className:"text-lg font-semibold text-slate-800 truncate",children:t}),s&&(0,yt.jsx)("p",{className:"mt-1 text-sm text-slate-500",children:s}),e]}),n&&(0,yt.jsx)("div",{className:"flex-shrink-0",children:n})]})},Tt.Body=function({children:e,className:t=""}){return(0,yt.jsx)("div",{className:`${t}`,children:e})},Tt.Footer=function({children:e,className:t=""}){return(0,yt.jsx)("div",{className:`\n        pt-4 mt-4 border-t border-slate-200\n        flex items-center justify-end gap-3\n        ${t}\n      `.trim(),children:e})},Tt.Stat=function({label:e,value:t,change:s,changeType:n="neutral",icon:r,loading:a=!1,className:i=""}){return(0,yt.jsx)(Tt,{className:`${i}`,padding:"md",children:(0,yt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("p",{className:"text-sm font-medium text-slate-500",children:e}),a?(0,yt.jsx)("div",{className:"h-8 w-20 bg-slate-200 animate-pulse rounded mt-1"}):(0,yt.jsx)("p",{className:"mt-1 text-2xl font-semibold text-slate-900",children:t}),void 0!==s&&(0,yt.jsxs)("p",{className:`mt-1 text-sm ${{positive:"text-green-600",negative:"text-red-600",neutral:"text-slate-500"}[n]}`,children:["positive"===n&&"+",s]})]}),r&&(0,yt.jsx)("div",{className:"flex-shrink-0 p-2 bg-slate-100 rounded-lg text-slate-600",children:r})]})})};const Dt={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8",xl:"w-12 h-12"},Bt={xs:"border",sm:"border-2",md:"border-2",lg:"border-[3px]",xl:"border-4"},Vt={primary:"border-wp-primary",white:"border-white",slate:"border-slate-600",current:"border-current"};function Wt({size:e="md",color:t="primary",className:s=""}){const n=Dt[e]||Dt.md,r=Bt[e]||Bt.md,a=Vt[t]||Vt.primary;return(0,yt.jsx)("div",{className:`\n        inline-block rounded-full\n        border-transparent border-t-current\n        animate-spin\n        ${n}\n        ${r}\n        ${a}\n        ${s}\n      `.trim(),role:"status","aria-label":"Loading",children:(0,yt.jsx)("span",{className:"sr-only",children:"Loading..."})})}Wt.Overlay=function({message:e="Loading...",visible:t=!0}){return t?(0,yt.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,yt.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,yt.jsx)(Wt,{size:"xl"}),(0,yt.jsx)("p",{className:"text-sm font-medium text-slate-600",children:e})]})}):null},Wt.Inline=function({message:e="Loading...",size:t="sm"}){return(0,yt.jsxs)("div",{className:"flex items-center gap-2 text-slate-500",children:[(0,yt.jsx)(Wt,{size:t,color:"slate"}),(0,yt.jsx)("span",{className:"text-sm",children:e})]})},Wt.Skeleton=function({lines:e=3,className:t=""}){return(0,yt.jsx)("div",{className:`animate-pulse space-y-3 ${t}`,children:Array.from({length:e}).map((e,t)=>(0,yt.jsx)("div",{className:"h-4 bg-slate-200 rounded",style:{width:100-15*t+"%"}},t))})};const Ht={primary:"\n    bg-wp-primary text-white\n    hover:bg-wp-primary-hover\n    focus:ring-wp-primary/50\n    disabled:bg-wp-primary/50\n  ",secondary:"\n    bg-slate-100 text-slate-700\n    hover:bg-slate-200\n    focus:ring-slate-500/50\n    disabled:bg-slate-50 disabled:text-slate-400\n  ",success:"\n    bg-wp-success text-white\n    hover:bg-green-700\n    focus:ring-green-500/50\n    disabled:bg-green-400\n  ",danger:"\n    bg-wp-accent text-white\n    hover:bg-red-700\n    focus:ring-red-500/50\n    disabled:bg-red-400\n  ",warning:"\n    bg-wp-warning text-slate-900\n    hover:bg-yellow-600\n    focus:ring-yellow-500/50\n    disabled:bg-yellow-300\n  ",ghost:"\n    bg-transparent text-slate-600\n    hover:bg-slate-100\n    focus:ring-slate-500/50\n    disabled:text-slate-300\n  ",link:"\n    bg-transparent text-wp-primary\n    hover:text-wp-primary-hover hover:underline\n    focus:ring-wp-primary/50\n    disabled:text-slate-400\n  "},$t={xs:"px-2 py-1 text-xs gap-1",sm:"px-3 py-1.5 text-sm gap-1.5",md:"px-4 py-2 text-sm gap-2",lg:"px-5 py-2.5 text-base gap-2",xl:"px-6 py-3 text-base gap-2.5"},qt={xs:"p-1",sm:"p-1.5",md:"p-2",lg:"p-2.5",xl:"p-3"};function Ut({children:e,variant:t="primary",size:s="md",loading:n=!1,disabled:r=!1,iconOnly:a=!1,leftIcon:i=null,rightIcon:l=null,type:o="button",className:c="",onClick:d,...u}){const h=Ht[t]||Ht.primary,m=a?qt[s]||qt.md:$t[s]||$t.md,g=r||n;return(0,yt.jsx)("button",{type:o,disabled:g,onClick:d,className:`\n        inline-flex items-center justify-center\n        font-medium rounded-md\n        transition-colors duration-150\n        focus:outline-none focus:ring-2 focus:ring-offset-1\n        disabled:cursor-not-allowed\n        ${h}\n        ${m}\n        ${c}\n      `.trim(),...u,children:n?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(Wt,{size:"xs"===s||"sm"===s?"xs":"sm"}),!a&&(0,yt.jsx)("span",{className:"ml-1.5",children:"Loading..."})]}):(0,yt.jsxs)(yt.Fragment,{children:[i&&(0,yt.jsx)("span",{className:"flex-shrink-0",children:i}),e,l&&(0,yt.jsx)("span",{className:"flex-shrink-0",children:l})]})})}Ut.Group=function({children:e,className:t=""}){return(0,yt.jsx)("div",{className:`\n        inline-flex rounded-md shadow-sm\n        [&>button]:rounded-none\n        [&>button:first-child]:rounded-l-md\n        [&>button:last-child]:rounded-r-md\n        [&>button:not(:first-child)]:-ml-px\n        ${t}\n      `.trim(),children:e})};const Qt=()=>(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,yt.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),Gt=()=>(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,yt.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),Kt=[{key:"queue",label:"Queue",description:"Building post queue"},{key:"extract",label:"Extract",description:"Extracting entities"},{key:"resolve",label:"Resolve",description:"Resolving identities"},{key:"enrich",label:"Enrich",description:"Enriching data"},{key:"link",label:"Link",description:"Creating links"},{key:"complete",label:"Complete",description:"Finalizing"}];function Xt({currentPhase:e,errorPhase:t=null,isRunning:s=!1,phases:n=Kt,className:r=""}){const a=n.findIndex(t=>t.key===e);return(0,yt.jsx)("div",{className:`w-full ${r}`,children:(0,yt.jsxs)("div",{className:"relative flex items-center justify-between",children:[(0,yt.jsx)("div",{className:"absolute top-5 left-0 right-0 h-0.5 bg-slate-200"}),a>0&&(0,yt.jsx)("div",{className:"absolute top-5 left-0 h-0.5 bg-phase-complete transition-all duration-500",style:{width:a/(n.length-1)*100+"%"}}),n.map((n,r)=>{const i=function(e,t,s,n,r,a){return r===e?"error":a||t?n<s?"complete":e===t&&a?"active":"pending":"pending"}(n.key,e,a,r,t,s);return(0,yt.jsxs)("div",{className:"relative flex flex-col items-center z-10",children:[(0,yt.jsxs)("div",{className:`\n                  w-10 h-10 rounded-full flex items-center justify-center\n                  transition-all duration-300\n                  ${"pending"===i?"bg-slate-200 text-slate-400":""}\n                  ${"active"===i?"bg-phase-active text-white phase-pulse":""}\n                  ${"complete"===i?"bg-phase-complete text-white":""}\n                  ${"error"===i?"bg-phase-error text-white":""}\n                `,children:["complete"===i&&(0,yt.jsx)(Qt,{}),"error"===i&&(0,yt.jsx)(Gt,{}),("pending"===i||"active"===i)&&(0,yt.jsx)("span",{className:"text-sm font-semibold",children:r+1})]}),(0,yt.jsxs)("div",{className:"mt-2 text-center",children:[(0,yt.jsx)("p",{className:`\n                    text-sm font-medium\n                    ${"active"===i?"text-phase-active":""}\n                    ${"complete"===i?"text-phase-complete":""}\n                    ${"error"===i?"text-phase-error":""}\n                    ${"pending"===i?"text-slate-400":""}\n                  `,children:n.label}),(0,yt.jsx)("p",{className:"text-xs text-slate-400 mt-0.5 max-w-[80px]",children:n.description})]})]},n.key)})]})})}function Jt(e){if(e<=0)return"Almost done...";const t=Math.floor(e/3600),s=Math.floor(e%3600/60),n=Math.floor(e%60);return t>0?`${t}h ${s}m remaining`:s>0?`${s}m ${n}s remaining`:`${n}s remaining`}function Yt({progress:e=0,isRunning:t=!1,startedAt:s=null,label:n=null,showPercentage:r=!0,showEta:i=!0,variant:l="primary",size:o="md",className:c=""}){const d=Math.min(100,Math.max(0,e)),u=(0,a.useMemo)(()=>{if(!t||!s||d<=0||d>=100)return null;const e=new Date(s).getTime(),n=(Date.now()-e)/1e3,r=d/n;return r<=0?null:(100-d)/r},[t,s,d]),h={primary:"bg-wp-primary",success:"bg-phase-complete",warning:"bg-wp-warning",error:"bg-phase-error"},m={sm:"h-1.5",md:"h-2.5",lg:"h-4"},g=h[l]||h.primary,p=m[o]||m.md;return(0,yt.jsxs)("div",{className:`w-full ${c}`,children:[(n||r)&&(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[n&&(0,yt.jsx)("span",{className:"text-sm font-medium text-slate-700",children:n}),r&&(0,yt.jsxs)("span",{className:"text-sm font-semibold text-slate-600",children:[d.toFixed(1),"%"]})]}),(0,yt.jsx)("div",{className:`relative w-full bg-slate-200 rounded-full overflow-hidden ${p}`,children:(0,yt.jsx)("div",{className:`\n            absolute top-0 left-0 h-full rounded-full\n            transition-all duration-300 ease-out\n            ${g}\n            ${t?"progress-stripes animate-stripe":""}\n          `,style:{width:`${d}%`}})}),i&&null!==u&&(0,yt.jsxs)("div",{className:"mt-2 flex items-center justify-between text-xs text-slate-500",children:[(0,yt.jsx)("span",{children:t?"Processing...":"Idle"}),(0,yt.jsx)("span",{children:Jt(u)})]})]})}Yt.Compact=function({progress:e,isRunning:t,className:s=""}){const n=Math.min(100,Math.max(0,e));return(0,yt.jsxs)("div",{className:`flex items-center gap-2 ${s}`,children:[(0,yt.jsx)("div",{className:"flex-1 h-1.5 bg-slate-200 rounded-full overflow-hidden",children:(0,yt.jsx)("div",{className:`\n            h-full bg-wp-primary rounded-full\n            transition-all duration-300\n            ${t?"progress-stripes animate-stripe":""}\n          `,style:{width:`${n}%`}})}),(0,yt.jsxs)("span",{className:"text-xs font-medium text-slate-500 w-10 text-right",children:[n.toFixed(0),"%"]})]})};const Zt=()=>(0,yt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),es=()=>(0,yt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})}),ts=()=>(0,yt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),ss=()=>(0,yt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})});function ns(e){return e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toLocaleString()}function rs({stats:e={},loading:t=!1,className:s=""}){const{total_entities:n=0,total_mentions:r=0,avg_confidence:a=0,posts_pending:i=0}=e,l=[{label:"Total Entities",value:ns(n),icon:(0,yt.jsx)(Zt,{}),color:"text-wp-primary",bgColor:"bg-wp-primary/10"},{label:"Total Mentions",value:ns(r),icon:(0,yt.jsx)(es,{}),color:"text-green-600",bgColor:"bg-green-100"},{label:"Avg Confidence",value:(o=a,`${(o>1?o:100*o).toFixed(1)}%`),icon:(0,yt.jsx)(ts,{}),color:"text-amber-600",bgColor:"bg-amber-100"},{label:"Posts Pending",value:ns(i),icon:(0,yt.jsx)(ss,{}),color:"text-slate-600",bgColor:"bg-slate-100"}];var o;return(0,yt.jsx)("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 ${s}`,children:l.map(e=>(0,yt.jsx)(Tt,{className:"relative overflow-hidden",children:(0,yt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("p",{className:"text-sm font-medium text-slate-500",children:e.label}),t?(0,yt.jsx)("div",{className:"h-8 w-20 bg-slate-200 animate-pulse rounded mt-1"}):(0,yt.jsx)("p",{className:"mt-1 text-2xl font-bold text-slate-900",children:e.value})]}),(0,yt.jsx)("div",{className:`flex-shrink-0 p-2.5 rounded-lg ${e.bgColor} ${e.color}`,children:e.icon})]})},e.label))})}const as={DEBUG:{label:"DEBUG",className:"text-slate-400"},INFO:{label:"INFO",className:"text-slate-400"},API:{label:"API",className:"text-blue-400"},WARN:{label:"WARN",className:"text-yellow-400"},WARNING:{label:"WARN",className:"text-yellow-400"},ERROR:{label:"ERROR",className:"text-red-400"},SUCCESS:{label:"OK",className:"text-green-400"}};function is({entry:e}){const t=as[e.level?.toUpperCase()]||as.INFO;return(0,yt.jsxs)("div",{className:"terminal-line flex gap-3 py-0.5 hover:bg-slate-800/50",children:[(0,yt.jsxs)("span",{className:"text-slate-500 flex-shrink-0 select-none",children:["[",(s=e.timestamp||e.time||Date.now(),new Date(s).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})),"]"]}),(0,yt.jsx)("span",{className:`flex-shrink-0 font-semibold w-14 ${t.className}`,children:t.label}),(0,yt.jsx)("span",{className:"flex-1 break-all "+("ERROR"===e.level?.toUpperCase()?"text-red-300":"text-slate-300"),children:e.message})]});var s}function ls({logs:e=[],maxEntries:t=50,autoScroll:s=!0,title:n="Pipeline Output",className:r="",onClear:i}){const l=(0,a.useRef)(null),o=(0,a.useRef)(s),c=e.slice(-t);return(0,a.useEffect)(()=>{o.current&&l.current&&(l.current.scrollTop=l.current.scrollHeight)},[e]),(0,yt.jsxs)("div",{className:`bg-slate-900 rounded-lg overflow-hidden flex flex-col ${r}`,children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 bg-slate-800 border-b border-slate-700",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsxs)("div",{className:"flex gap-1.5",children:[(0,yt.jsx)("span",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,yt.jsx)("span",{className:"w-3 h-3 rounded-full bg-yellow-500"}),(0,yt.jsx)("span",{className:"w-3 h-3 rounded-full bg-green-500"})]}),(0,yt.jsx)("span",{className:"text-sm font-medium text-slate-400 ml-2",children:n})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsxs)("span",{className:"text-xs text-slate-500",children:[c.length," / ",t," entries"]}),i&&(0,yt.jsx)("button",{onClick:i,className:"px-2 py-1 text-xs text-slate-400 hover:text-slate-200 hover:bg-slate-700 rounded transition-colors",children:"Clear"})]})]}),(0,yt.jsx)("div",{ref:l,onScroll:()=>{if(!l.current)return;const{scrollTop:e,scrollHeight:t,clientHeight:s}=l.current,n=t-e-s<50;o.current=n},className:"flex-1 px-4 py-3 overflow-y-auto font-mono text-sm scrollbar-thin scrollbar-dark min-h-[200px] max-h-[400px]",children:0===c.length?(0,yt.jsx)("div",{className:"text-slate-500 italic",children:"No log entries yet. Start the pipeline to see output."}):c.map((e,t)=>(0,yt.jsx)(is,{entry:e},e.id||t))}),(0,yt.jsxs)("div",{className:"px-4 py-1.5 bg-slate-800 border-t border-slate-700 flex items-center justify-between",children:[(0,yt.jsx)("div",{className:"flex items-center gap-3",children:(0,yt.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,yt.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),(0,yt.jsx)("span",{className:"text-xs text-slate-400",children:"Live"})]})}),(0,yt.jsx)("div",{className:"flex items-center gap-3 text-xs",children:Object.entries(as).slice(0,4).map(([e,t])=>(0,yt.jsx)("span",{className:"flex items-center gap-1",children:(0,yt.jsx)("span",{className:`${t.className}`,children:t.label})},e))})]})]})}ls.Compact=function({logs:e=[],maxEntries:t=5}){const s=e.slice(-t);return(0,yt.jsx)("div",{className:"bg-slate-900 rounded px-3 py-2 font-mono text-xs",children:0===s.length?(0,yt.jsx)("span",{className:"text-slate-500",children:"Waiting for logs..."}):s.map((e,t)=>{const s=as[e.level?.toUpperCase()]||as.INFO;return(0,yt.jsxs)("div",{className:"truncate",children:[(0,yt.jsxs)("span",{className:s.className,children:[s.label,":"]})," ",(0,yt.jsx)("span",{className:"text-slate-400",children:e.message})]},t)})})};const os=()=>(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,yt.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})}),cs=()=>(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,yt.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})}),ds=()=>(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})});function us({vibeAiData:e}){const{status:t,stats:s,logs:n,loading:r,error:i,isRunning:l,refresh:o}=Et(),{start:c,stop:d,starting:u,stopping:h,error:m,phases:g}=At(),p=(0,a.useCallback)(async()=>{try{await c(),o()}catch(e){}},[c,o]),x=(0,a.useCallback)(async()=>{try{await d(),o()}catch(e){}},[d,o]),f=(0,a.useCallback)(async()=>{try{await c({full_reindex:!0}),o()}catch(e){}},[c,o]),v=i||m;return(0,yt.jsxs)("div",{className:"p-6 space-y-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Dashboard"}),(0,yt.jsx)("p",{className:"mt-1 text-slate-500",children:"Monitor and control the entity extraction pipeline"})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,yt.jsx)(Ut,{variant:"ghost",size:"sm",onClick:o,leftIcon:(0,yt.jsx)(ds,{}),children:"Refresh"}),l?(0,yt.jsx)(Ut,{variant:"danger",onClick:x,loading:h,leftIcon:(0,yt.jsx)(cs,{}),children:"Stop Pipeline"}):(0,yt.jsxs)(Ut.Group,{children:[(0,yt.jsx)(Ut,{variant:"primary",onClick:p,loading:u,leftIcon:(0,yt.jsx)(os,{}),children:"Start Pipeline"}),(0,yt.jsx)(Ut,{variant:"secondary",onClick:f,loading:u,title:"Reprocess all posts",children:"Full Reindex"})]})]})]}),v&&(0,yt.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,yt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,yt.jsx)("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,yt.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-medium text-red-800",children:"Error"}),(0,yt.jsx)("p",{className:"text-sm text-red-600 mt-1",children:v})]})]})}),(0,yt.jsx)(rs,{stats:s,loading:r}),(0,yt.jsxs)(Tt,{padding:"lg",children:[(0,yt.jsx)(Tt.Header,{title:"Pipeline Status",subtitle:l?`Processing: ${t.pipeline?.current_item||"Initializing..."}`:"Pipeline is idle",action:(0,yt.jsx)(St.Status,{status:l?"processing":t.pipeline?.error?"error":"inactive"})}),(0,yt.jsxs)(Tt.Body,{children:[(0,yt.jsx)("div",{className:"mb-8",children:(0,yt.jsx)(Xt,{currentPhase:t.pipeline?.phase,errorPhase:t.pipeline?.error?t.pipeline.phase:null,isRunning:l,phases:g})}),(0,yt.jsx)(Yt,{progress:t.pipeline?.progress||0,isRunning:l,startedAt:t.pipeline?.started_at,label:l?`${t.pipeline?.processed_items||0} / ${t.pipeline?.total_items||0} items processed`:"Ready to start",showPercentage:!0,showEta:l})]})]}),(0,yt.jsx)(Tt,{padding:"none",children:(0,yt.jsx)(ls,{logs:n,maxEntries:50,autoScroll:!0,title:"Pipeline Output"})}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,yt.jsx)(Tt,{hover:!0,className:"cursor-pointer",onClick:()=>window.location.href="#/entities",children:(0,yt.jsxs)("div",{className:"flex items-center gap-4",children:[(0,yt.jsx)("div",{className:"p-3 bg-wp-primary/10 rounded-lg",children:(0,yt.jsx)("svg",{className:"w-6 h-6 text-wp-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-semibold text-slate-800",children:"Browse Entities"}),(0,yt.jsx)("p",{className:"text-sm text-slate-500",children:"View and manage extracted entities"})]})]})}),(0,yt.jsx)(Tt,{hover:!0,className:"cursor-pointer",onClick:()=>window.location.href="#/settings",children:(0,yt.jsxs)("div",{className:"flex items-center gap-4",children:[(0,yt.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,yt.jsxs)("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-semibold text-slate-800",children:"Configure Settings"}),(0,yt.jsx)("p",{className:"text-sm text-slate-500",children:"API keys, prompts, and options"})]})]})}),(0,yt.jsx)(Tt,{hover:!0,className:"cursor-pointer",onClick:()=>window.location.href="#/logs",children:(0,yt.jsxs)("div",{className:"flex items-center gap-4",children:[(0,yt.jsx)("div",{className:"p-3 bg-amber-100 rounded-lg",children:(0,yt.jsx)("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-semibold text-slate-800",children:"View Full Logs"}),(0,yt.jsx)("p",{className:"text-sm text-slate-500",children:"Detailed processing history"})]})]})})]})]})}var hs=class extends et{constructor(e,t){super(),this.options=t,this.#d=e,this.#j=null,this.#w=nt(),this.bindMethods(),this.setOptions(t)}#d;#N=void 0;#C=void 0;#k=void 0;#S;#R;#w;#j;#L;#M;#P;#_;#I;#F;#E=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#N.addObserver(this),ms(this.#N,this.options)?this.#O():this.updateResult(),this.#A())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return gs(this.#N,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return gs(this.#N,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#z(),this.#T(),this.#N.removeObserver(this)}setOptions(e){const t=this.options,s=this.#N;if(this.options=this.#d.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof Ee(this.options.enabled,this.#N))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#D(),this.#N.setOptions(this.options),t._defaulted&&!We(this.options,t)&&this.#d.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#N,observer:this});const n=this.hasListeners();n&&ps(this.#N,s,this.options,t)&&this.#O(),this.updateResult(),!n||this.#N===s&&Ee(this.options.enabled,this.#N)===Ee(t.enabled,this.#N)&&Fe(this.options.staleTime,this.#N)===Fe(t.staleTime,this.#N)||this.#B();const r=this.#V();!n||this.#N===s&&Ee(this.options.enabled,this.#N)===Ee(t.enabled,this.#N)&&r===this.#F||this.#W(r)}getOptimisticResult(e){const t=this.#d.getQueryCache().build(this.#d,e),s=this.createResult(t,e);return n=s,!We(this.getCurrentResult(),n)&&(this.#k=s,this.#R=this.options,this.#S=this.#N.state),s;var n}getCurrentResult(){return this.#k}trackResult(e,t){return new Proxy(e,{get:(e,s)=>(this.trackProp(s),t?.(s),"promise"===s&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#w.status||this.#w.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,s))})}trackProp(e){this.#E.add(e)}getCurrentQuery(){return this.#N}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#d.defaultQueryOptions(e),s=this.#d.getQueryCache().build(this.#d,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#O({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#k))}#O(e){this.#D();let t=this.#N.fetch(this.options,e);return e?.throwOnError||(t=t.catch(Pe)),t}#B(){this.#z();const e=Fe(this.options.staleTime,this.#N);if(Me||this.#k.isStale||!_e(e))return;const t=Ie(this.#k.dataUpdatedAt,e)+1;this.#_=Le.setTimeout(()=>{this.#k.isStale||this.updateResult()},t)}#V(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#N):this.options.refetchInterval)??!1}#W(e){this.#T(),this.#F=e,!Me&&!1!==Ee(this.options.enabled,this.#N)&&_e(this.#F)&&0!==this.#F&&(this.#I=Le.setInterval(()=>{(this.options.refetchIntervalInBackground||tt.isFocused())&&this.#O()},this.#F))}#A(){this.#B(),this.#W(this.#V())}#z(){this.#_&&(Le.clearTimeout(this.#_),this.#_=void 0)}#T(){this.#I&&(Le.clearInterval(this.#I),this.#I=void 0)}createResult(e,t){const s=this.#N,n=this.options,r=this.#k,a=this.#S,i=this.#R,l=e!==s?e.state:this.#C,{state:o}=e;let c,d={...o},u=!1;if(t._optimisticResults){const r=this.hasListeners(),a=!r&&ms(e,t),i=r&&ps(e,s,t,n);(a||i)&&(d={...d,...dt(o.data,e.options)}),"isRestoring"===t._optimisticResults&&(d.fetchStatus="idle")}let{error:h,errorUpdatedAt:m,status:g}=d;c=d.data;let p=!1;if(void 0!==t.placeholderData&&void 0===c&&"pending"===g){let e;r?.isPlaceholderData&&t.placeholderData===i?.placeholderData?(e=r.data,p=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#P?.state.data,this.#P):t.placeholderData,void 0!==e&&(g="success",c=Ue(r?.data,e,t),u=!0)}if(t.select&&void 0!==c&&!p)if(r&&c===a?.data&&t.select===this.#L)c=this.#M;else try{this.#L=t.select,c=t.select(c),c=Ue(r?.data,c,t),this.#M=c,this.#j=null}catch(e){this.#j=e}this.#j&&(h=this.#j,c=this.#M,m=Date.now(),g="error");const x="fetching"===d.fetchStatus,f="pending"===g,v="error"===g,b=f&&x,y=void 0!==c,j={status:g,fetchStatus:d.fetchStatus,isPending:f,isSuccess:"success"===g,isError:v,isInitialLoading:b,isLoading:b,data:c,dataUpdatedAt:d.dataUpdatedAt,error:h,errorUpdatedAt:m,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>l.dataUpdateCount||d.errorUpdateCount>l.errorUpdateCount,isFetching:x,isRefetching:x&&!f,isLoadingError:v&&!y,isPaused:"paused"===d.fetchStatus,isPlaceholderData:u,isRefetchError:v&&y,isStale:xs(e,t),refetch:this.refetch,promise:this.#w,isEnabled:!1!==Ee(t.enabled,e)};if(this.options.experimental_prefetchInRender){const t=void 0!==j.data,n="error"===j.status&&!t,r=e=>{n?e.reject(j.error):t&&e.resolve(j.data)},a=()=>{const e=this.#w=j.promise=nt();r(e)},i=this.#w;switch(i.status){case"pending":e.queryHash===s.queryHash&&r(i);break;case"fulfilled":(n||j.data!==i.value)&&a();break;case"rejected":n&&j.error===i.reason||a()}}return j}updateResult(){const e=this.#k,t=this.createResult(this.#N,this.options);this.#S=this.#N.state,this.#R=this.options,void 0!==this.#S.data&&(this.#P=this.#N),We(t,e)||(this.#k=t,this.#H({listeners:(()=>{if(!e)return!0;const{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!this.#E.size)return!0;const n=new Set(s??this.#E);return this.options.throwOnError&&n.add("error"),Object.keys(this.#k).some(t=>{const s=t;return this.#k[s]!==e[s]&&n.has(s)})})()}))}#D(){const e=this.#d.getQueryCache().build(this.#d,this.options);if(e===this.#N)return;const t=this.#N;this.#N=e,this.#C=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#A()}#H(e){Ze.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#k)}),this.#d.getQueryCache().notify({query:this.#N,type:"observerResultsUpdated"})})}};function ms(e,t){return function(e,t){return!1!==Ee(t.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===t.retryOnMount)}(e,t)||void 0!==e.state.data&&gs(e,t,t.refetchOnMount)}function gs(e,t,s){if(!1!==Ee(t.enabled,e)&&"static"!==Fe(t.staleTime,e)){const n="function"==typeof s?s(e):s;return"always"===n||!1!==n&&xs(e,t)}return!1}function ps(e,t,s,n){return(e!==t||!1===Ee(n.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&xs(e,s)}function xs(e,t){return!1!==Ee(t.enabled,e)&&e.isStaleByTime(Fe(t.staleTime,e))}var fs=a.createContext(function(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}()),vs=a.createContext(!1),bs=(vs.Provider,(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()}));function ys(e,t){return function(e,t,s){const n=a.useContext(vs),r=a.useContext(fs),i=wt(s),l=i.defaultQueryOptions(e);i.getDefaultOptions().queries?._experimental_beforeQuery?.(l);const o=i.getQueryCache().get(l.queryHash);l._optimisticResults=n?"isRestoring":"optimistic",(e=>{if(e.suspense){const t=1e3,s=e=>"static"===e?e:Math.max(e??t,t),n=e.staleTime;e.staleTime="function"==typeof n?(...e)=>s(n(...e)):s(n),"number"==typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,t))}})(l),((e,t,s)=>{const n=s?.state.error&&"function"==typeof e.throwOnError?Je(e.throwOnError,[s.state.error,s]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||n)&&(t.isReset()||(e.retryOnMount=!1))})(l,r,o),(e=>{a.useEffect(()=>{e.clearReset()},[e])})(r);const c=!i.getQueryCache().get(l.queryHash),[d]=a.useState(()=>new t(i,l)),u=d.getOptimisticResult(l),h=!n&&!1!==e.subscribed;if(a.useSyncExternalStore(a.useCallback(e=>{const t=h?d.subscribe(Ze.batchCalls(e)):Pe;return d.updateResult(),t},[d,h]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),a.useEffect(()=>{d.setOptions(l)},[l,d]),((e,t)=>e?.suspense&&t.isPending)(l,u))throw bs(l,d,r);if((({result:e,errorResetBoundary:t,throwOnError:s,query:n,suspense:r})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(r&&void 0===e.data||Je(s,[e.error,n])))({result:u,errorResetBoundary:r,throwOnError:l.throwOnError,query:o,suspense:l.suspense}))throw u.error;if(i.getDefaultOptions().queries?._experimental_afterQuery?.(l,u),l.experimental_prefetchInRender&&!Me&&((e,t)=>e.isLoading&&e.isFetching&&!t)(u,n)){const e=c?bs(l,d,r):o?.promise;e?.catch(Pe).finally(()=>{d.updateResult()})}return l.notifyOnChangeProps?u:d.trackResult(u)}(e,hs,t)}var js=class extends et{#d;#k=void 0;#$;#q;constructor(e,t){super(),this.#d=e,this.setOptions(t),this.bindMethods(),this.#U()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const t=this.options;this.options=this.#d.defaultMutationOptions(e),We(this.options,t)||this.#d.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#$,observer:this}),t?.mutationKey&&this.options.mutationKey&&Te(t.mutationKey)!==Te(this.options.mutationKey)?this.reset():"pending"===this.#$?.state.status&&this.#$.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#$?.removeObserver(this)}onMutationUpdate(e){this.#U(),this.#H(e)}getCurrentResult(){return this.#k}reset(){this.#$?.removeObserver(this),this.#$=void 0,this.#U(),this.#H()}mutate(e,t){return this.#q=t,this.#$?.removeObserver(this),this.#$=this.#d.getMutationCache().build(this.#d,this.options),this.#$.addObserver(this),this.#$.execute(e)}#U(){const e=this.#$?.state??{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0};this.#k={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#H(e){Ze.batch(()=>{if(this.#q&&this.hasListeners()){const t=this.#k.variables,s=this.#k.context,n={client:this.#d,meta:this.options.meta,mutationKey:this.options.mutationKey};if("success"===e?.type){try{this.#q.onSuccess?.(e.data,t,s,n)}catch(e){Promise.reject(e)}try{this.#q.onSettled?.(e.data,null,t,s,n)}catch(e){Promise.reject(e)}}else if("error"===e?.type){try{this.#q.onError?.(e.error,t,s,n)}catch(e){Promise.reject(e)}try{this.#q.onSettled?.(void 0,e.error,t,s,n)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#k)})})}};function ws(e,t){const s=wt(t),[n]=a.useState(()=>new js(s,e));a.useEffect(()=>{n.setOptions(e)},[n,e]);const r=a.useSyncExternalStore(a.useCallback(e=>n.subscribe(Ze.batchCalls(e)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=a.useCallback((e,t)=>{n.mutate(e,t).catch(Pe)},[n]);if(r.error&&Je(n.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:i,mutateAsync:r.mutate}}function Ns(e,t){return"function"==typeof e?e(t):e}function Cs(e,t){return s=>{t.setState(t=>({...t,[e]:Ns(s,t[e])}))}}function ks(e){return e instanceof Function}function Ss(e,t,s){let n,r=[];return a=>{let i;s.key&&s.debug&&(i=Date.now());const l=e(a);if(l.length===r.length&&!l.some((e,t)=>r[t]!==e))return n;let o;if(r=l,s.key&&s.debug&&(o=Date.now()),n=t(...l),null==s||null==s.onChange||s.onChange(n),s.key&&s.debug&&null!=s&&s.debug()){const e=Math.round(100*(Date.now()-i))/100,t=Math.round(100*(Date.now()-o))/100,n=t/16,r=(e,t)=>{for(e=String(e);e.length<t;)e=" "+e;return e};console.info(`%c ${r(t,5)} /${r(e,5)} ms`,`\n            font-size: .6rem;\n            font-weight: bold;\n            color: hsl(${Math.max(0,Math.min(120-120*n,120))}deg 100% 31%);`,null==s?void 0:s.key)}return n}}function Rs(e,t,s,n){return{debug:()=>{var s;return null!=(s=null==e?void 0:e.debugAll)?s:e[t]},key:!1,onChange:n}}const Ls="debugHeaders";function Ms(e,t,s){var n;let r={id:null!=(n=s.id)?n:t.id,column:t,index:s.index,isPlaceholder:!!s.isPlaceholder,placeholderId:s.placeholderId,depth:s.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const e=[],t=s=>{s.subHeaders&&s.subHeaders.length&&s.subHeaders.map(t),e.push(s)};return t(r),e},getContext:()=>({table:e,header:r,column:t})};return e._features.forEach(t=>{null==t.createHeader||t.createHeader(r,e)}),r}const Ps={createTable:e=>{e.getHeaderGroups=Ss(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,s,n,r)=>{var a,i;const l=null!=(a=null==n?void 0:n.map(e=>s.find(t=>t.id===e)).filter(Boolean))?a:[],o=null!=(i=null==r?void 0:r.map(e=>s.find(t=>t.id===e)).filter(Boolean))?i:[];return _s(t,[...l,...s.filter(e=>!(null!=n&&n.includes(e.id)||null!=r&&r.includes(e.id))),...o],e)},Rs(e.options,Ls)),e.getCenterHeaderGroups=Ss(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,s,n,r)=>_s(t,s=s.filter(e=>!(null!=n&&n.includes(e.id)||null!=r&&r.includes(e.id))),e,"center"),Rs(e.options,Ls)),e.getLeftHeaderGroups=Ss(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(t,s,n)=>{var r;return _s(t,null!=(r=null==n?void 0:n.map(e=>s.find(t=>t.id===e)).filter(Boolean))?r:[],e,"left")},Rs(e.options,Ls)),e.getRightHeaderGroups=Ss(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(t,s,n)=>{var r;return _s(t,null!=(r=null==n?void 0:n.map(e=>s.find(t=>t.id===e)).filter(Boolean))?r:[],e,"right")},Rs(e.options,Ls)),e.getFooterGroups=Ss(()=>[e.getHeaderGroups()],e=>[...e].reverse(),Rs(e.options,Ls)),e.getLeftFooterGroups=Ss(()=>[e.getLeftHeaderGroups()],e=>[...e].reverse(),Rs(e.options,Ls)),e.getCenterFooterGroups=Ss(()=>[e.getCenterHeaderGroups()],e=>[...e].reverse(),Rs(e.options,Ls)),e.getRightFooterGroups=Ss(()=>[e.getRightHeaderGroups()],e=>[...e].reverse(),Rs(e.options,Ls)),e.getFlatHeaders=Ss(()=>[e.getHeaderGroups()],e=>e.map(e=>e.headers).flat(),Rs(e.options,Ls)),e.getLeftFlatHeaders=Ss(()=>[e.getLeftHeaderGroups()],e=>e.map(e=>e.headers).flat(),Rs(e.options,Ls)),e.getCenterFlatHeaders=Ss(()=>[e.getCenterHeaderGroups()],e=>e.map(e=>e.headers).flat(),Rs(e.options,Ls)),e.getRightFlatHeaders=Ss(()=>[e.getRightHeaderGroups()],e=>e.map(e=>e.headers).flat(),Rs(e.options,Ls)),e.getCenterLeafHeaders=Ss(()=>[e.getCenterFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),Rs(e.options,Ls)),e.getLeftLeafHeaders=Ss(()=>[e.getLeftFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),Rs(e.options,Ls)),e.getRightLeafHeaders=Ss(()=>[e.getRightFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),Rs(e.options,Ls)),e.getLeafHeaders=Ss(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(e,t,s)=>{var n,r,a,i,l,o;return[...null!=(n=null==(r=e[0])?void 0:r.headers)?n:[],...null!=(a=null==(i=t[0])?void 0:i.headers)?a:[],...null!=(l=null==(o=s[0])?void 0:o.headers)?l:[]].map(e=>e.getLeafHeaders()).flat()},Rs(e.options,Ls))}};function _s(e,t,s,n){var r,a;let i=0;const l=function(e,t){void 0===t&&(t=1),i=Math.max(i,t),e.filter(e=>e.getIsVisible()).forEach(e=>{var s;null!=(s=e.columns)&&s.length&&l(e.columns,t+1)},0)};l(e);let o=[];const c=(e,t)=>{const r={depth:t,id:[n,`${t}`].filter(Boolean).join("_"),headers:[]},a=[];e.forEach(e=>{const i=[...a].reverse()[0];let l,o=!1;if(e.column.depth===r.depth&&e.column.parent?l=e.column.parent:(l=e.column,o=!0),i&&(null==i?void 0:i.column)===l)i.subHeaders.push(e);else{const r=Ms(s,l,{id:[n,t,l.id,null==e?void 0:e.id].filter(Boolean).join("_"),isPlaceholder:o,placeholderId:o?`${a.filter(e=>e.column===l).length}`:void 0,depth:t,index:a.length});r.subHeaders.push(e),a.push(r)}r.headers.push(e),e.headerGroup=r}),o.push(r),t>0&&c(a,t-1)},d=t.map((e,t)=>Ms(s,e,{depth:i,index:t}));c(d,i-1),o.reverse();const u=e=>e.filter(e=>e.column.getIsVisible()).map(e=>{let t=0,s=0,n=[0];return e.subHeaders&&e.subHeaders.length?(n=[],u(e.subHeaders).forEach(e=>{let{colSpan:s,rowSpan:r}=e;t+=s,n.push(r)})):t=1,s+=Math.min(...n),e.colSpan=t,e.rowSpan=s,{colSpan:t,rowSpan:s}});return u(null!=(r=null==(a=o[0])?void 0:a.headers)?r:[]),o}const Is=(e,t,s,n,r,a,i)=>{let l={id:t,index:n,original:s,depth:r,parentId:i,_valuesCache:{},_uniqueValuesCache:{},getValue:t=>{if(l._valuesCache.hasOwnProperty(t))return l._valuesCache[t];const s=e.getColumn(t);return null!=s&&s.accessorFn?(l._valuesCache[t]=s.accessorFn(l.original,n),l._valuesCache[t]):void 0},getUniqueValues:t=>{if(l._uniqueValuesCache.hasOwnProperty(t))return l._uniqueValuesCache[t];const s=e.getColumn(t);return null!=s&&s.accessorFn?s.columnDef.getUniqueValues?(l._uniqueValuesCache[t]=s.columnDef.getUniqueValues(l.original,n),l._uniqueValuesCache[t]):(l._uniqueValuesCache[t]=[l.getValue(t)],l._uniqueValuesCache[t]):void 0},renderValue:t=>{var s;return null!=(s=l.getValue(t))?s:e.options.renderFallbackValue},subRows:null!=a?a:[],getLeafRows:()=>function(e,t){const s=[],n=e=>{e.forEach(e=>{s.push(e);const r=t(e);null!=r&&r.length&&n(r)})};return n(e),s}(l.subRows,e=>e.subRows),getParentRow:()=>l.parentId?e.getRow(l.parentId,!0):void 0,getParentRows:()=>{let e=[],t=l;for(;;){const s=t.getParentRow();if(!s)break;e.push(s),t=s}return e.reverse()},getAllCells:Ss(()=>[e.getAllLeafColumns()],t=>t.map(t=>function(e,t,s,n){const r={id:`${t.id}_${s.id}`,row:t,column:s,getValue:()=>t.getValue(n),renderValue:()=>{var t;return null!=(t=r.getValue())?t:e.options.renderFallbackValue},getContext:Ss(()=>[e,s,t,r],(e,t,s,n)=>({table:e,column:t,row:s,cell:n,getValue:n.getValue,renderValue:n.renderValue}),Rs(e.options,"debugCells"))};return e._features.forEach(n=>{null==n.createCell||n.createCell(r,s,t,e)},{}),r}(e,l,t,t.id)),Rs(e.options,"debugRows")),_getAllCellsByColumnId:Ss(()=>[l.getAllCells()],e=>e.reduce((e,t)=>(e[t.column.id]=t,e),{}),Rs(e.options,"debugRows"))};for(let t=0;t<e._features.length;t++){const s=e._features[t];null==s||null==s.createRow||s.createRow(l,e)}return l},Fs={createColumn:(e,t)=>{e._getFacetedRowModel=t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():t.getPreFilteredRowModel(),e._getFacetedUniqueValues=t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},Es=(e,t,s)=>{var n,r;const a=null==s||null==(n=s.toString())?void 0:n.toLowerCase();return Boolean(null==(r=e.getValue(t))||null==(r=r.toString())||null==(r=r.toLowerCase())?void 0:r.includes(a))};Es.autoRemove=e=>$s(e);const Os=(e,t,s)=>{var n;return Boolean(null==(n=e.getValue(t))||null==(n=n.toString())?void 0:n.includes(s))};Os.autoRemove=e=>$s(e);const As=(e,t,s)=>{var n;return(null==(n=e.getValue(t))||null==(n=n.toString())?void 0:n.toLowerCase())===(null==s?void 0:s.toLowerCase())};As.autoRemove=e=>$s(e);const zs=(e,t,s)=>{var n;return null==(n=e.getValue(t))?void 0:n.includes(s)};zs.autoRemove=e=>$s(e);const Ts=(e,t,s)=>!s.some(s=>{var n;return!(null!=(n=e.getValue(t))&&n.includes(s))});Ts.autoRemove=e=>$s(e)||!(null!=e&&e.length);const Ds=(e,t,s)=>s.some(s=>{var n;return null==(n=e.getValue(t))?void 0:n.includes(s)});Ds.autoRemove=e=>$s(e)||!(null!=e&&e.length);const Bs=(e,t,s)=>e.getValue(t)===s;Bs.autoRemove=e=>$s(e);const Vs=(e,t,s)=>e.getValue(t)==s;Vs.autoRemove=e=>$s(e);const Ws=(e,t,s)=>{let[n,r]=s;const a=e.getValue(t);return a>=n&&a<=r};Ws.resolveFilterValue=e=>{let[t,s]=e,n="number"!=typeof t?parseFloat(t):t,r="number"!=typeof s?parseFloat(s):s,a=null===t||Number.isNaN(n)?-1/0:n,i=null===s||Number.isNaN(r)?1/0:r;if(a>i){const e=a;a=i,i=e}return[a,i]},Ws.autoRemove=e=>$s(e)||$s(e[0])&&$s(e[1]);const Hs={includesString:Es,includesStringSensitive:Os,equalsString:As,arrIncludes:zs,arrIncludesAll:Ts,arrIncludesSome:Ds,equals:Bs,weakEquals:Vs,inNumberRange:Ws};function $s(e){return null==e||""===e}const qs={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:Cs("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,t)=>{e.getAutoFilterFn=()=>{const s=t.getCoreRowModel().flatRows[0],n=null==s?void 0:s.getValue(e.id);return"string"==typeof n?Hs.includesString:"number"==typeof n?Hs.inNumberRange:"boolean"==typeof n||null!==n&&"object"==typeof n?Hs.equals:Array.isArray(n)?Hs.arrIncludes:Hs.weakEquals},e.getFilterFn=()=>{var s,n;return ks(e.columnDef.filterFn)?e.columnDef.filterFn:"auto"===e.columnDef.filterFn?e.getAutoFilterFn():null!=(s=null==(n=t.options.filterFns)?void 0:n[e.columnDef.filterFn])?s:Hs[e.columnDef.filterFn]},e.getCanFilter=()=>{var s,n,r;return(null==(s=e.columnDef.enableColumnFilter)||s)&&(null==(n=t.options.enableColumnFilters)||n)&&(null==(r=t.options.enableFilters)||r)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var s;return null==(s=t.getState().columnFilters)||null==(s=s.find(t=>t.id===e.id))?void 0:s.value},e.getFilterIndex=()=>{var s,n;return null!=(s=null==(n=t.getState().columnFilters)?void 0:n.findIndex(t=>t.id===e.id))?s:-1},e.setFilterValue=s=>{t.setColumnFilters(t=>{const n=e.getFilterFn(),r=null==t?void 0:t.find(t=>t.id===e.id),a=Ns(s,r?r.value:void 0);var i;if(Us(n,a,e))return null!=(i=null==t?void 0:t.filter(t=>t.id!==e.id))?i:[];const l={id:e.id,value:a};var o;return r?null!=(o=null==t?void 0:t.map(t=>t.id===e.id?l:t))?o:[]:null!=t&&t.length?[...t,l]:[l]})}},createRow:(e,t)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=t=>{const s=e.getAllLeafColumns();null==e.options.onColumnFiltersChange||e.options.onColumnFiltersChange(e=>{var n;return null==(n=Ns(t,e))?void 0:n.filter(e=>{const t=s.find(t=>t.id===e.id);return!t||!Us(t.getFilterFn(),e.value,t)})})},e.resetColumnFilters=t=>{var s,n;e.setColumnFilters(t?[]:null!=(s=null==(n=e.initialState)?void 0:n.columnFilters)?s:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function Us(e,t,s){return!(!e||!e.autoRemove)&&e.autoRemove(t,s)||void 0===t||"string"==typeof t&&!t}const Qs={sum:(e,t,s)=>s.reduce((t,s)=>{const n=s.getValue(e);return t+("number"==typeof n?n:0)},0),min:(e,t,s)=>{let n;return s.forEach(t=>{const s=t.getValue(e);null!=s&&(n>s||void 0===n&&s>=s)&&(n=s)}),n},max:(e,t,s)=>{let n;return s.forEach(t=>{const s=t.getValue(e);null!=s&&(n<s||void 0===n&&s>=s)&&(n=s)}),n},extent:(e,t,s)=>{let n,r;return s.forEach(t=>{const s=t.getValue(e);null!=s&&(void 0===n?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}),[n,r]},mean:(e,t)=>{let s=0,n=0;if(t.forEach(t=>{let r=t.getValue(e);null!=r&&(r=+r)>=r&&(++s,n+=r)}),s)return n/s},median:(e,t)=>{if(!t.length)return;const s=t.map(t=>t.getValue(e));if(n=s,!Array.isArray(n)||!n.every(e=>"number"==typeof e))return;var n;if(1===s.length)return s[0];const r=Math.floor(s.length/2),a=s.sort((e,t)=>e-t);return s.length%2!=0?a[r]:(a[r-1]+a[r])/2},unique:(e,t)=>Array.from(new Set(t.map(t=>t.getValue(e))).values()),uniqueCount:(e,t)=>new Set(t.map(t=>t.getValue(e))).size,count:(e,t)=>t.length},Gs={getDefaultColumnDef:()=>({aggregatedCell:e=>{var t,s;return null!=(t=null==(s=e.getValue())||null==s.toString?void 0:s.toString())?t:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:Cs("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,t)=>{e.toggleGrouping=()=>{t.setGrouping(t=>null!=t&&t.includes(e.id)?t.filter(t=>t!==e.id):[...null!=t?t:[],e.id])},e.getCanGroup=()=>{var s,n;return(null==(s=e.columnDef.enableGrouping)||s)&&(null==(n=t.options.enableGrouping)||n)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var s;return null==(s=t.getState().grouping)?void 0:s.includes(e.id)},e.getGroupedIndex=()=>{var s;return null==(s=t.getState().grouping)?void 0:s.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const t=e.getCanGroup();return()=>{t&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const s=t.getCoreRowModel().flatRows[0],n=null==s?void 0:s.getValue(e.id);return"number"==typeof n?Qs.sum:"[object Date]"===Object.prototype.toString.call(n)?Qs.extent:void 0},e.getAggregationFn=()=>{var s,n;if(!e)throw new Error;return ks(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:"auto"===e.columnDef.aggregationFn?e.getAutoAggregationFn():null!=(s=null==(n=t.options.aggregationFns)?void 0:n[e.columnDef.aggregationFn])?s:Qs[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=t=>null==e.options.onGroupingChange?void 0:e.options.onGroupingChange(t),e.resetGrouping=t=>{var s,n;e.setGrouping(t?[]:null!=(s=null==(n=e.initialState)?void 0:n.grouping)?s:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,t)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=s=>{if(e._groupingValuesCache.hasOwnProperty(s))return e._groupingValuesCache[s];const n=t.getColumn(s);return null!=n&&n.columnDef.getGroupingValue?(e._groupingValuesCache[s]=n.columnDef.getGroupingValue(e.original),e._groupingValuesCache[s]):e.getValue(s)},e._groupingValuesCache={}},createCell:(e,t,s,n)=>{e.getIsGrouped=()=>t.getIsGrouped()&&t.id===s.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&t.getIsGrouped(),e.getIsAggregated=()=>{var t;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!(null==(t=s.subRows)||!t.length)}}},Ks={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:Cs("columnOrder",e)}),createColumn:(e,t)=>{e.getIndex=Ss(e=>[tn(t,e)],t=>t.findIndex(t=>t.id===e.id),Rs(t.options,"debugColumns")),e.getIsFirstColumn=s=>{var n;return(null==(n=tn(t,s)[0])?void 0:n.id)===e.id},e.getIsLastColumn=s=>{var n;const r=tn(t,s);return(null==(n=r[r.length-1])?void 0:n.id)===e.id}},createTable:e=>{e.setColumnOrder=t=>null==e.options.onColumnOrderChange?void 0:e.options.onColumnOrderChange(t),e.resetColumnOrder=t=>{var s;e.setColumnOrder(t?[]:null!=(s=e.initialState.columnOrder)?s:[])},e._getOrderColumnsFn=Ss(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(e,t,s)=>n=>{let r=[];if(null!=e&&e.length){const t=[...e],s=[...n];for(;s.length&&t.length;){const e=t.shift(),n=s.findIndex(t=>t.id===e);n>-1&&r.push(s.splice(n,1)[0])}r=[...r,...s]}else r=n;return function(e,t,s){if(null==t||!t.length||!s)return e;const n=e.filter(e=>!t.includes(e.id));return"remove"===s?n:[...t.map(t=>e.find(e=>e.id===t)).filter(Boolean),...n]}(r,t,s)},Rs(e.options,"debugTable"))}},Xs={getInitialState:e=>({columnPinning:{left:[],right:[]},...e}),getDefaultOptions:e=>({onColumnPinningChange:Cs("columnPinning",e)}),createColumn:(e,t)=>{e.pin=s=>{const n=e.getLeafColumns().map(e=>e.id).filter(Boolean);t.setColumnPinning(e=>{var t,r,a,i,l,o;return"right"===s?{left:(null!=(a=null==e?void 0:e.left)?a:[]).filter(e=>!(null!=n&&n.includes(e))),right:[...(null!=(i=null==e?void 0:e.right)?i:[]).filter(e=>!(null!=n&&n.includes(e))),...n]}:"left"===s?{left:[...(null!=(l=null==e?void 0:e.left)?l:[]).filter(e=>!(null!=n&&n.includes(e))),...n],right:(null!=(o=null==e?void 0:e.right)?o:[]).filter(e=>!(null!=n&&n.includes(e)))}:{left:(null!=(t=null==e?void 0:e.left)?t:[]).filter(e=>!(null!=n&&n.includes(e))),right:(null!=(r=null==e?void 0:e.right)?r:[]).filter(e=>!(null!=n&&n.includes(e)))}})},e.getCanPin=()=>e.getLeafColumns().some(e=>{var s,n,r;return(null==(s=e.columnDef.enablePinning)||s)&&(null==(n=null!=(r=t.options.enableColumnPinning)?r:t.options.enablePinning)||n)}),e.getIsPinned=()=>{const s=e.getLeafColumns().map(e=>e.id),{left:n,right:r}=t.getState().columnPinning,a=s.some(e=>null==n?void 0:n.includes(e)),i=s.some(e=>null==r?void 0:r.includes(e));return a?"left":!!i&&"right"},e.getPinnedIndex=()=>{var s,n;const r=e.getIsPinned();return r?null!=(s=null==(n=t.getState().columnPinning)||null==(n=n[r])?void 0:n.indexOf(e.id))?s:-1:0}},createRow:(e,t)=>{e.getCenterVisibleCells=Ss(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,t.getState().columnPinning.right],(e,t,s)=>{const n=[...null!=t?t:[],...null!=s?s:[]];return e.filter(e=>!n.includes(e.column.id))},Rs(t.options,"debugRows")),e.getLeftVisibleCells=Ss(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.column.id===t)).filter(Boolean).map(e=>({...e,position:"left"})),Rs(t.options,"debugRows")),e.getRightVisibleCells=Ss(()=>[e._getAllVisibleCells(),t.getState().columnPinning.right],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.column.id===t)).filter(Boolean).map(e=>({...e,position:"right"})),Rs(t.options,"debugRows"))},createTable:e=>{e.setColumnPinning=t=>null==e.options.onColumnPinningChange?void 0:e.options.onColumnPinningChange(t),e.resetColumnPinning=t=>{var s,n;return e.setColumnPinning(t?{left:[],right:[]}:null!=(s=null==(n=e.initialState)?void 0:n.columnPinning)?s:{left:[],right:[]})},e.getIsSomeColumnsPinned=t=>{var s;const n=e.getState().columnPinning;var r,a;return t?Boolean(null==(s=n[t])?void 0:s.length):Boolean((null==(r=n.left)?void 0:r.length)||(null==(a=n.right)?void 0:a.length))},e.getLeftLeafColumns=Ss(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.id===t)).filter(Boolean),Rs(e.options,"debugColumns")),e.getRightLeafColumns=Ss(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.id===t)).filter(Boolean),Rs(e.options,"debugColumns")),e.getCenterLeafColumns=Ss(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(e,t,s)=>{const n=[...null!=t?t:[],...null!=s?s:[]];return e.filter(e=>!n.includes(e.id))},Rs(e.options,"debugColumns"))}},Js={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},Ys={getDefaultColumnDef:()=>Js,getInitialState:e=>({columnSizing:{},columnSizingInfo:{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]},...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:Cs("columnSizing",e),onColumnSizingInfoChange:Cs("columnSizingInfo",e)}),createColumn:(e,t)=>{e.getSize=()=>{var s,n,r;const a=t.getState().columnSizing[e.id];return Math.min(Math.max(null!=(s=e.columnDef.minSize)?s:Js.minSize,null!=(n=null!=a?a:e.columnDef.size)?n:Js.size),null!=(r=e.columnDef.maxSize)?r:Js.maxSize)},e.getStart=Ss(e=>[e,tn(t,e),t.getState().columnSizing],(t,s)=>s.slice(0,e.getIndex(t)).reduce((e,t)=>e+t.getSize(),0),Rs(t.options,"debugColumns")),e.getAfter=Ss(e=>[e,tn(t,e),t.getState().columnSizing],(t,s)=>s.slice(e.getIndex(t)+1).reduce((e,t)=>e+t.getSize(),0),Rs(t.options,"debugColumns")),e.resetSize=()=>{t.setColumnSizing(t=>{let{[e.id]:s,...n}=t;return n})},e.getCanResize=()=>{var s,n;return(null==(s=e.columnDef.enableResizing)||s)&&(null==(n=t.options.enableColumnResizing)||n)},e.getIsResizing=()=>t.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,t)=>{e.getSize=()=>{let t=0;const s=e=>{var n;e.subHeaders.length?e.subHeaders.forEach(s):t+=null!=(n=e.column.getSize())?n:0};return s(e),t},e.getStart=()=>{if(e.index>0){const t=e.headerGroup.headers[e.index-1];return t.getStart()+t.getSize()}return 0},e.getResizeHandler=s=>{const n=t.getColumn(e.column.id),r=null==n?void 0:n.getCanResize();return a=>{if(!n||!r)return;if(null==a.persist||a.persist(),en(a)&&a.touches&&a.touches.length>1)return;const i=e.getSize(),l=e?e.getLeafHeaders().map(e=>[e.column.id,e.column.getSize()]):[[n.id,n.getSize()]],o=en(a)?Math.round(a.touches[0].clientX):a.clientX,c={},d=(e,s)=>{"number"==typeof s&&(t.setColumnSizingInfo(e=>{var n,r;const a="rtl"===t.options.columnResizeDirection?-1:1,i=(s-(null!=(n=null==e?void 0:e.startOffset)?n:0))*a,l=Math.max(i/(null!=(r=null==e?void 0:e.startSize)?r:0),-.999999);return e.columnSizingStart.forEach(e=>{let[t,s]=e;c[t]=Math.round(100*Math.max(s+s*l,0))/100}),{...e,deltaOffset:i,deltaPercentage:l}}),"onChange"!==t.options.columnResizeMode&&"end"!==e||t.setColumnSizing(e=>({...e,...c})))},u=e=>d("move",e),h=e=>{d("end",e),t.setColumnSizingInfo(e=>({...e,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},m=s||("undefined"!=typeof document?document:null),g={moveHandler:e=>u(e.clientX),upHandler:e=>{null==m||m.removeEventListener("mousemove",g.moveHandler),null==m||m.removeEventListener("mouseup",g.upHandler),h(e.clientX)}},p={moveHandler:e=>(e.cancelable&&(e.preventDefault(),e.stopPropagation()),u(e.touches[0].clientX),!1),upHandler:e=>{var t;null==m||m.removeEventListener("touchmove",p.moveHandler),null==m||m.removeEventListener("touchend",p.upHandler),e.cancelable&&(e.preventDefault(),e.stopPropagation()),h(null==(t=e.touches[0])?void 0:t.clientX)}},x=!!function(){if("boolean"==typeof Zs)return Zs;let e=!1;try{const t={get passive(){return e=!0,!1}},s=()=>{};window.addEventListener("test",s,t),window.removeEventListener("test",s)}catch(t){e=!1}return Zs=e,Zs}()&&{passive:!1};en(a)?(null==m||m.addEventListener("touchmove",p.moveHandler,x),null==m||m.addEventListener("touchend",p.upHandler,x)):(null==m||m.addEventListener("mousemove",g.moveHandler,x),null==m||m.addEventListener("mouseup",g.upHandler,x)),t.setColumnSizingInfo(e=>({...e,startOffset:o,startSize:i,deltaOffset:0,deltaPercentage:0,columnSizingStart:l,isResizingColumn:n.id}))}}},createTable:e=>{e.setColumnSizing=t=>null==e.options.onColumnSizingChange?void 0:e.options.onColumnSizingChange(t),e.setColumnSizingInfo=t=>null==e.options.onColumnSizingInfoChange?void 0:e.options.onColumnSizingInfoChange(t),e.resetColumnSizing=t=>{var s;e.setColumnSizing(t?{}:null!=(s=e.initialState.columnSizing)?s:{})},e.resetHeaderSizeInfo=t=>{var s;e.setColumnSizingInfo(t?{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}:null!=(s=e.initialState.columnSizingInfo)?s:{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]})},e.getTotalSize=()=>{var t,s;return null!=(t=null==(s=e.getHeaderGroups()[0])?void 0:s.headers.reduce((e,t)=>e+t.getSize(),0))?t:0},e.getLeftTotalSize=()=>{var t,s;return null!=(t=null==(s=e.getLeftHeaderGroups()[0])?void 0:s.headers.reduce((e,t)=>e+t.getSize(),0))?t:0},e.getCenterTotalSize=()=>{var t,s;return null!=(t=null==(s=e.getCenterHeaderGroups()[0])?void 0:s.headers.reduce((e,t)=>e+t.getSize(),0))?t:0},e.getRightTotalSize=()=>{var t,s;return null!=(t=null==(s=e.getRightHeaderGroups()[0])?void 0:s.headers.reduce((e,t)=>e+t.getSize(),0))?t:0}}};let Zs=null;function en(e){return"touchstart"===e.type}function tn(e,t){return t?"center"===t?e.getCenterVisibleLeafColumns():"left"===t?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const sn={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:Cs("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=t=>null==e.options.onRowSelectionChange?void 0:e.options.onRowSelectionChange(t),e.resetRowSelection=t=>{var s;return e.setRowSelection(t?{}:null!=(s=e.initialState.rowSelection)?s:{})},e.toggleAllRowsSelected=t=>{e.setRowSelection(s=>{t=void 0!==t?t:!e.getIsAllRowsSelected();const n={...s},r=e.getPreGroupedRowModel().flatRows;return t?r.forEach(e=>{e.getCanSelect()&&(n[e.id]=!0)}):r.forEach(e=>{delete n[e.id]}),n})},e.toggleAllPageRowsSelected=t=>e.setRowSelection(s=>{const n=void 0!==t?t:!e.getIsAllPageRowsSelected(),r={...s};return e.getRowModel().rows.forEach(t=>{nn(r,t.id,n,!0,e)}),r}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=Ss(()=>[e.getState().rowSelection,e.getCoreRowModel()],(t,s)=>Object.keys(t).length?rn(e,s):{rows:[],flatRows:[],rowsById:{}},Rs(e.options,"debugTable")),e.getFilteredSelectedRowModel=Ss(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(t,s)=>Object.keys(t).length?rn(e,s):{rows:[],flatRows:[],rowsById:{}},Rs(e.options,"debugTable")),e.getGroupedSelectedRowModel=Ss(()=>[e.getState().rowSelection,e.getSortedRowModel()],(t,s)=>Object.keys(t).length?rn(e,s):{rows:[],flatRows:[],rowsById:{}},Rs(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const t=e.getFilteredRowModel().flatRows,{rowSelection:s}=e.getState();let n=Boolean(t.length&&Object.keys(s).length);return n&&t.some(e=>e.getCanSelect()&&!s[e.id])&&(n=!1),n},e.getIsAllPageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows.filter(e=>e.getCanSelect()),{rowSelection:s}=e.getState();let n=!!t.length;return n&&t.some(e=>!s[e.id])&&(n=!1),n},e.getIsSomeRowsSelected=()=>{var t;const s=Object.keys(null!=(t=e.getState().rowSelection)?t:{}).length;return s>0&&s<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows;return!e.getIsAllPageRowsSelected()&&t.filter(e=>e.getCanSelect()).some(e=>e.getIsSelected()||e.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>t=>{e.toggleAllRowsSelected(t.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>t=>{e.toggleAllPageRowsSelected(t.target.checked)}},createRow:(e,t)=>{e.toggleSelected=(s,n)=>{const r=e.getIsSelected();t.setRowSelection(a=>{var i;if(s=void 0!==s?s:!r,e.getCanSelect()&&r===s)return a;const l={...a};return nn(l,e.id,s,null==(i=null==n?void 0:n.selectChildren)||i,t),l})},e.getIsSelected=()=>{const{rowSelection:s}=t.getState();return an(e,s)},e.getIsSomeSelected=()=>{const{rowSelection:s}=t.getState();return"some"===ln(e,s)},e.getIsAllSubRowsSelected=()=>{const{rowSelection:s}=t.getState();return"all"===ln(e,s)},e.getCanSelect=()=>{var s;return"function"==typeof t.options.enableRowSelection?t.options.enableRowSelection(e):null==(s=t.options.enableRowSelection)||s},e.getCanSelectSubRows=()=>{var s;return"function"==typeof t.options.enableSubRowSelection?t.options.enableSubRowSelection(e):null==(s=t.options.enableSubRowSelection)||s},e.getCanMultiSelect=()=>{var s;return"function"==typeof t.options.enableMultiRowSelection?t.options.enableMultiRowSelection(e):null==(s=t.options.enableMultiRowSelection)||s},e.getToggleSelectedHandler=()=>{const t=e.getCanSelect();return s=>{var n;t&&e.toggleSelected(null==(n=s.target)?void 0:n.checked)}}}},nn=(e,t,s,n,r)=>{var a;const i=r.getRow(t,!0);s?(i.getCanMultiSelect()||Object.keys(e).forEach(t=>delete e[t]),i.getCanSelect()&&(e[t]=!0)):delete e[t],n&&null!=(a=i.subRows)&&a.length&&i.getCanSelectSubRows()&&i.subRows.forEach(t=>nn(e,t.id,s,n,r))};function rn(e,t){const s=e.getState().rowSelection,n=[],r={},a=function(e,t){return e.map(e=>{var t;const i=an(e,s);if(i&&(n.push(e),r[e.id]=e),null!=(t=e.subRows)&&t.length&&(e={...e,subRows:a(e.subRows)}),i)return e}).filter(Boolean)};return{rows:a(t.rows),flatRows:n,rowsById:r}}function an(e,t){var s;return null!=(s=t[e.id])&&s}function ln(e,t,s){var n;if(null==(n=e.subRows)||!n.length)return!1;let r=!0,a=!1;return e.subRows.forEach(e=>{if((!a||r)&&(e.getCanSelect()&&(an(e,t)?a=!0:r=!1),e.subRows&&e.subRows.length)){const s=ln(e,t);"all"===s?a=!0:"some"===s?(a=!0,r=!1):r=!1}}),r?"all":!!a&&"some"}const on=/([0-9]+)/gm;function cn(e,t){return e===t?0:e>t?1:-1}function dn(e){return"number"==typeof e?isNaN(e)||e===1/0||e===-1/0?"":String(e):"string"==typeof e?e:""}function un(e,t){const s=e.split(on).filter(Boolean),n=t.split(on).filter(Boolean);for(;s.length&&n.length;){const e=s.shift(),t=n.shift(),r=parseInt(e,10),a=parseInt(t,10),i=[r,a].sort();if(isNaN(i[0])){if(e>t)return 1;if(t>e)return-1}else{if(isNaN(i[1]))return isNaN(r)?-1:1;if(r>a)return 1;if(a>r)return-1}}return s.length-n.length}const hn={alphanumeric:(e,t,s)=>un(dn(e.getValue(s)).toLowerCase(),dn(t.getValue(s)).toLowerCase()),alphanumericCaseSensitive:(e,t,s)=>un(dn(e.getValue(s)),dn(t.getValue(s))),text:(e,t,s)=>cn(dn(e.getValue(s)).toLowerCase(),dn(t.getValue(s)).toLowerCase()),textCaseSensitive:(e,t,s)=>cn(dn(e.getValue(s)),dn(t.getValue(s))),datetime:(e,t,s)=>{const n=e.getValue(s),r=t.getValue(s);return n>r?1:n<r?-1:0},basic:(e,t,s)=>cn(e.getValue(s),t.getValue(s))},mn=[Ps,{getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:Cs("columnVisibility",e)}),createColumn:(e,t)=>{e.toggleVisibility=s=>{e.getCanHide()&&t.setColumnVisibility(t=>({...t,[e.id]:null!=s?s:!e.getIsVisible()}))},e.getIsVisible=()=>{var s,n;const r=e.columns;return null==(s=r.length?r.some(e=>e.getIsVisible()):null==(n=t.getState().columnVisibility)?void 0:n[e.id])||s},e.getCanHide=()=>{var s,n;return(null==(s=e.columnDef.enableHiding)||s)&&(null==(n=t.options.enableHiding)||n)},e.getToggleVisibilityHandler=()=>t=>{null==e.toggleVisibility||e.toggleVisibility(t.target.checked)}},createRow:(e,t)=>{e._getAllVisibleCells=Ss(()=>[e.getAllCells(),t.getState().columnVisibility],e=>e.filter(e=>e.column.getIsVisible()),Rs(t.options,"debugRows")),e.getVisibleCells=Ss(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(e,t,s)=>[...e,...t,...s],Rs(t.options,"debugRows"))},createTable:e=>{const t=(t,s)=>Ss(()=>[s(),s().filter(e=>e.getIsVisible()).map(e=>e.id).join("_")],e=>e.filter(e=>null==e.getIsVisible?void 0:e.getIsVisible()),Rs(e.options,"debugColumns"));e.getVisibleFlatColumns=t(0,()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=t(0,()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=t(0,()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=t(0,()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=t(0,()=>e.getCenterLeafColumns()),e.setColumnVisibility=t=>null==e.options.onColumnVisibilityChange?void 0:e.options.onColumnVisibilityChange(t),e.resetColumnVisibility=t=>{var s;e.setColumnVisibility(t?{}:null!=(s=e.initialState.columnVisibility)?s:{})},e.toggleAllColumnsVisible=t=>{var s;t=null!=(s=t)?s:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((e,s)=>({...e,[s.id]:t||!(null!=s.getCanHide&&s.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(e=>!(null!=e.getIsVisible&&e.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(e=>null==e.getIsVisible?void 0:e.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>t=>{var s;e.toggleAllColumnsVisible(null==(s=t.target)?void 0:s.checked)}}},Ks,Xs,Fs,qs,{createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},{getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:Cs("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:t=>{var s;const n=null==(s=e.getCoreRowModel().flatRows[0])||null==(s=s._getAllCellsByColumnId()[t.id])?void 0:s.getValue();return"string"==typeof n||"number"==typeof n}}),createColumn:(e,t)=>{e.getCanGlobalFilter=()=>{var s,n,r,a;return(null==(s=e.columnDef.enableGlobalFilter)||s)&&(null==(n=t.options.enableGlobalFilter)||n)&&(null==(r=t.options.enableFilters)||r)&&(null==(a=null==t.options.getColumnCanGlobalFilter?void 0:t.options.getColumnCanGlobalFilter(e))||a)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>Hs.includesString,e.getGlobalFilterFn=()=>{var t,s;const{globalFilterFn:n}=e.options;return ks(n)?n:"auto"===n?e.getGlobalAutoFilterFn():null!=(t=null==(s=e.options.filterFns)?void 0:s[n])?t:Hs[n]},e.setGlobalFilter=t=>{null==e.options.onGlobalFilterChange||e.options.onGlobalFilterChange(t)},e.resetGlobalFilter=t=>{e.setGlobalFilter(t?void 0:e.initialState.globalFilter)}}},{getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:Cs("sorting",e),isMultiSortEvent:e=>e.shiftKey}),createColumn:(e,t)=>{e.getAutoSortingFn=()=>{const s=t.getFilteredRowModel().flatRows.slice(10);let n=!1;for(const t of s){const s=null==t?void 0:t.getValue(e.id);if("[object Date]"===Object.prototype.toString.call(s))return hn.datetime;if("string"==typeof s&&(n=!0,s.split(on).length>1))return hn.alphanumeric}return n?hn.text:hn.basic},e.getAutoSortDir=()=>{const s=t.getFilteredRowModel().flatRows[0];return"string"==typeof(null==s?void 0:s.getValue(e.id))?"asc":"desc"},e.getSortingFn=()=>{var s,n;if(!e)throw new Error;return ks(e.columnDef.sortingFn)?e.columnDef.sortingFn:"auto"===e.columnDef.sortingFn?e.getAutoSortingFn():null!=(s=null==(n=t.options.sortingFns)?void 0:n[e.columnDef.sortingFn])?s:hn[e.columnDef.sortingFn]},e.toggleSorting=(s,n)=>{const r=e.getNextSortingOrder(),a=null!=s;t.setSorting(i=>{const l=null==i?void 0:i.find(t=>t.id===e.id),o=null==i?void 0:i.findIndex(t=>t.id===e.id);let c,d=[],u=a?s:"desc"===r;var h;return c=null!=i&&i.length&&e.getCanMultiSort()&&n?l?"toggle":"add":null!=i&&i.length&&o!==i.length-1?"replace":l?"toggle":"replace","toggle"===c&&(a||r||(c="remove")),"add"===c?(d=[...i,{id:e.id,desc:u}],d.splice(0,d.length-(null!=(h=t.options.maxMultiSortColCount)?h:Number.MAX_SAFE_INTEGER))):d="toggle"===c?i.map(t=>t.id===e.id?{...t,desc:u}:t):"remove"===c?i.filter(t=>t.id!==e.id):[{id:e.id,desc:u}],d})},e.getFirstSortDir=()=>{var s,n;return(null!=(s=null!=(n=e.columnDef.sortDescFirst)?n:t.options.sortDescFirst)?s:"desc"===e.getAutoSortDir())?"desc":"asc"},e.getNextSortingOrder=s=>{var n,r;const a=e.getFirstSortDir(),i=e.getIsSorted();return i?!!(i===a||null!=(n=t.options.enableSortingRemoval)&&!n||s&&null!=(r=t.options.enableMultiRemove)&&!r)&&("desc"===i?"asc":"desc"):a},e.getCanSort=()=>{var s,n;return(null==(s=e.columnDef.enableSorting)||s)&&(null==(n=t.options.enableSorting)||n)&&!!e.accessorFn},e.getCanMultiSort=()=>{var s,n;return null!=(s=null!=(n=e.columnDef.enableMultiSort)?n:t.options.enableMultiSort)?s:!!e.accessorFn},e.getIsSorted=()=>{var s;const n=null==(s=t.getState().sorting)?void 0:s.find(t=>t.id===e.id);return!!n&&(n.desc?"desc":"asc")},e.getSortIndex=()=>{var s,n;return null!=(s=null==(n=t.getState().sorting)?void 0:n.findIndex(t=>t.id===e.id))?s:-1},e.clearSorting=()=>{t.setSorting(t=>null!=t&&t.length?t.filter(t=>t.id!==e.id):[])},e.getToggleSortingHandler=()=>{const s=e.getCanSort();return n=>{s&&(null==n.persist||n.persist(),null==e.toggleSorting||e.toggleSorting(void 0,!!e.getCanMultiSort()&&(null==t.options.isMultiSortEvent?void 0:t.options.isMultiSortEvent(n))))}}},createTable:e=>{e.setSorting=t=>null==e.options.onSortingChange?void 0:e.options.onSortingChange(t),e.resetSorting=t=>{var s,n;e.setSorting(t?[]:null!=(s=null==(n=e.initialState)?void 0:n.sorting)?s:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},Gs,{getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:Cs("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let t=!1,s=!1;e._autoResetExpanded=()=>{var n,r;if(t){if(null!=(n=null!=(r=e.options.autoResetAll)?r:e.options.autoResetExpanded)?n:!e.options.manualExpanding){if(s)return;s=!0,e._queue(()=>{e.resetExpanded(),s=!1})}}else e._queue(()=>{t=!0})},e.setExpanded=t=>null==e.options.onExpandedChange?void 0:e.options.onExpandedChange(t),e.toggleAllRowsExpanded=t=>{(null!=t?t:!e.getIsAllRowsExpanded())?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=t=>{var s,n;e.setExpanded(t?{}:null!=(s=null==(n=e.initialState)?void 0:n.expanded)?s:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(e=>e.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>t=>{null==t.persist||t.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const t=e.getState().expanded;return!0===t||Object.values(t).some(Boolean)},e.getIsAllRowsExpanded=()=>{const t=e.getState().expanded;return"boolean"==typeof t?!0===t:!!Object.keys(t).length&&!e.getRowModel().flatRows.some(e=>!e.getIsExpanded())},e.getExpandedDepth=()=>{let t=0;return(!0===e.getState().expanded?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(e=>{const s=e.split(".");t=Math.max(t,s.length)}),t},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,t)=>{e.toggleExpanded=s=>{t.setExpanded(n=>{var r;const a=!0===n||!(null==n||!n[e.id]);let i={};if(!0===n?Object.keys(t.getRowModel().rowsById).forEach(e=>{i[e]=!0}):i=n,s=null!=(r=s)?r:!a,!a&&s)return{...i,[e.id]:!0};if(a&&!s){const{[e.id]:t,...s}=i;return s}return n})},e.getIsExpanded=()=>{var s;const n=t.getState().expanded;return!!(null!=(s=null==t.options.getIsRowExpanded?void 0:t.options.getIsRowExpanded(e))?s:!0===n||(null==n?void 0:n[e.id]))},e.getCanExpand=()=>{var s,n,r;return null!=(s=null==t.options.getRowCanExpand?void 0:t.options.getRowCanExpand(e))?s:(null==(n=t.options.enableExpanding)||n)&&!(null==(r=e.subRows)||!r.length)},e.getIsAllParentsExpanded=()=>{let s=!0,n=e;for(;s&&n.parentId;)n=t.getRow(n.parentId,!0),s=n.getIsExpanded();return s},e.getToggleExpandedHandler=()=>{const t=e.getCanExpand();return()=>{t&&e.toggleExpanded()}}}},{getInitialState:e=>({...e,pagination:{pageIndex:0,pageSize:10,...null==e?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:Cs("pagination",e)}),createTable:e=>{let t=!1,s=!1;e._autoResetPageIndex=()=>{var n,r;if(t){if(null!=(n=null!=(r=e.options.autoResetAll)?r:e.options.autoResetPageIndex)?n:!e.options.manualPagination){if(s)return;s=!0,e._queue(()=>{e.resetPageIndex(),s=!1})}}else e._queue(()=>{t=!0})},e.setPagination=t=>null==e.options.onPaginationChange?void 0:e.options.onPaginationChange(e=>Ns(t,e)),e.resetPagination=t=>{var s;e.setPagination(t?{pageIndex:0,pageSize:10}:null!=(s=e.initialState.pagination)?s:{pageIndex:0,pageSize:10})},e.setPageIndex=t=>{e.setPagination(s=>{let n=Ns(t,s.pageIndex);const r=void 0===e.options.pageCount||-1===e.options.pageCount?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return n=Math.max(0,Math.min(n,r)),{...s,pageIndex:n}})},e.resetPageIndex=t=>{var s,n;e.setPageIndex(t?0:null!=(s=null==(n=e.initialState)||null==(n=n.pagination)?void 0:n.pageIndex)?s:0)},e.resetPageSize=t=>{var s,n;e.setPageSize(t?10:null!=(s=null==(n=e.initialState)||null==(n=n.pagination)?void 0:n.pageSize)?s:10)},e.setPageSize=t=>{e.setPagination(e=>{const s=Math.max(1,Ns(t,e.pageSize)),n=e.pageSize*e.pageIndex,r=Math.floor(n/s);return{...e,pageIndex:r,pageSize:s}})},e.setPageCount=t=>e.setPagination(s=>{var n;let r=Ns(t,null!=(n=e.options.pageCount)?n:-1);return"number"==typeof r&&(r=Math.max(-1,r)),{...s,pageCount:r}}),e.getPageOptions=Ss(()=>[e.getPageCount()],e=>{let t=[];return e&&e>0&&(t=[...new Array(e)].fill(null).map((e,t)=>t)),t},Rs(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:t}=e.getState().pagination,s=e.getPageCount();return-1===s||0!==s&&t<s-1},e.previousPage=()=>e.setPageIndex(e=>e-1),e.nextPage=()=>e.setPageIndex(e=>e+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var t;return null!=(t=e.options.pageCount)?t:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var t;return null!=(t=e.options.rowCount)?t:e.getPrePaginationRowModel().rows.length}}},{getInitialState:e=>({rowPinning:{top:[],bottom:[]},...e}),getDefaultOptions:e=>({onRowPinningChange:Cs("rowPinning",e)}),createRow:(e,t)=>{e.pin=(s,n,r)=>{const a=n?e.getLeafRows().map(e=>{let{id:t}=e;return t}):[],i=r?e.getParentRows().map(e=>{let{id:t}=e;return t}):[],l=new Set([...i,e.id,...a]);t.setRowPinning(e=>{var t,n,r,a,i,o;return"bottom"===s?{top:(null!=(r=null==e?void 0:e.top)?r:[]).filter(e=>!(null!=l&&l.has(e))),bottom:[...(null!=(a=null==e?void 0:e.bottom)?a:[]).filter(e=>!(null!=l&&l.has(e))),...Array.from(l)]}:"top"===s?{top:[...(null!=(i=null==e?void 0:e.top)?i:[]).filter(e=>!(null!=l&&l.has(e))),...Array.from(l)],bottom:(null!=(o=null==e?void 0:e.bottom)?o:[]).filter(e=>!(null!=l&&l.has(e)))}:{top:(null!=(t=null==e?void 0:e.top)?t:[]).filter(e=>!(null!=l&&l.has(e))),bottom:(null!=(n=null==e?void 0:e.bottom)?n:[]).filter(e=>!(null!=l&&l.has(e)))}})},e.getCanPin=()=>{var s;const{enableRowPinning:n,enablePinning:r}=t.options;return"function"==typeof n?n(e):null==(s=null!=n?n:r)||s},e.getIsPinned=()=>{const s=[e.id],{top:n,bottom:r}=t.getState().rowPinning,a=s.some(e=>null==n?void 0:n.includes(e)),i=s.some(e=>null==r?void 0:r.includes(e));return a?"top":!!i&&"bottom"},e.getPinnedIndex=()=>{var s,n;const r=e.getIsPinned();if(!r)return-1;const a=null==(s="top"===r?t.getTopRows():t.getBottomRows())?void 0:s.map(e=>{let{id:t}=e;return t});return null!=(n=null==a?void 0:a.indexOf(e.id))?n:-1}},createTable:e=>{e.setRowPinning=t=>null==e.options.onRowPinningChange?void 0:e.options.onRowPinningChange(t),e.resetRowPinning=t=>{var s,n;return e.setRowPinning(t?{top:[],bottom:[]}:null!=(s=null==(n=e.initialState)?void 0:n.rowPinning)?s:{top:[],bottom:[]})},e.getIsSomeRowsPinned=t=>{var s;const n=e.getState().rowPinning;var r,a;return t?Boolean(null==(s=n[t])?void 0:s.length):Boolean((null==(r=n.top)?void 0:r.length)||(null==(a=n.bottom)?void 0:a.length))},e._getPinnedRows=(t,s,n)=>{var r;return(null==(r=e.options.keepPinnedRows)||r?(null!=s?s:[]).map(t=>{const s=e.getRow(t,!0);return s.getIsAllParentsExpanded()?s:null}):(null!=s?s:[]).map(e=>t.find(t=>t.id===e))).filter(Boolean).map(e=>({...e,position:n}))},e.getTopRows=Ss(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(t,s)=>e._getPinnedRows(t,s,"top"),Rs(e.options,"debugRows")),e.getBottomRows=Ss(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(t,s)=>e._getPinnedRows(t,s,"bottom"),Rs(e.options,"debugRows")),e.getCenterRows=Ss(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(e,t,s)=>{const n=new Set([...null!=t?t:[],...null!=s?s:[]]);return e.filter(e=>!n.has(e.id))},Rs(e.options,"debugRows"))}},sn,Ys];function gn(e){var t,s;const n=[...mn,...null!=(t=e._features)?t:[]];let r={_features:n};const a=r._features.reduce((e,t)=>Object.assign(e,null==t.getDefaultOptions?void 0:t.getDefaultOptions(r)),{});let i={...null!=(s=e.initialState)?s:{}};r._features.forEach(e=>{var t;i=null!=(t=null==e.getInitialState?void 0:e.getInitialState(i))?t:i});const l=[];let o=!1;const c={_features:n,options:{...a,...e},initialState:i,_queue:e=>{l.push(e),o||(o=!0,Promise.resolve().then(()=>{for(;l.length;)l.shift()();o=!1}).catch(e=>setTimeout(()=>{throw e})))},reset:()=>{r.setState(r.initialState)},setOptions:e=>{const t=Ns(e,r.options);r.options=(e=>r.options.mergeOptions?r.options.mergeOptions(a,e):{...a,...e})(t)},getState:()=>r.options.state,setState:e=>{null==r.options.onStateChange||r.options.onStateChange(e)},_getRowId:(e,t,s)=>{var n;return null!=(n=null==r.options.getRowId?void 0:r.options.getRowId(e,t,s))?n:`${s?[s.id,t].join("."):t}`},getCoreRowModel:()=>(r._getCoreRowModel||(r._getCoreRowModel=r.options.getCoreRowModel(r)),r._getCoreRowModel()),getRowModel:()=>r.getPaginationRowModel(),getRow:(e,t)=>{let s=(t?r.getPrePaginationRowModel():r.getRowModel()).rowsById[e];if(!s&&(s=r.getCoreRowModel().rowsById[e],!s))throw new Error;return s},_getDefaultColumnDef:Ss(()=>[r.options.defaultColumn],e=>{var t;return e=null!=(t=e)?t:{},{header:e=>{const t=e.header.column.columnDef;return t.accessorKey?t.accessorKey:t.accessorFn?t.id:null},cell:e=>{var t,s;return null!=(t=null==(s=e.renderValue())||null==s.toString?void 0:s.toString())?t:null},...r._features.reduce((e,t)=>Object.assign(e,null==t.getDefaultColumnDef?void 0:t.getDefaultColumnDef()),{}),...e}},Rs(e,"debugColumns")),_getColumnDefs:()=>r.options.columns,getAllColumns:Ss(()=>[r._getColumnDefs()],e=>{const t=function(e,s,n){return void 0===n&&(n=0),e.map(e=>{const a=function(e,t,s,n){var r,a;const i={...e._getDefaultColumnDef(),...t},l=i.accessorKey;let o,c=null!=(r=null!=(a=i.id)?a:l?"function"==typeof String.prototype.replaceAll?l.replaceAll(".","_"):l.replace(/\./g,"_"):void 0)?r:"string"==typeof i.header?i.header:void 0;if(i.accessorFn?o=i.accessorFn:l&&(o=l.includes(".")?e=>{let t=e;for(const e of l.split(".")){var s;t=null==(s=t)?void 0:s[e]}return t}:e=>e[i.accessorKey]),!c)throw new Error;let d={id:`${String(c)}`,accessorFn:o,parent:n,depth:s,columnDef:i,columns:[],getFlatColumns:Ss(()=>[!0],()=>{var e;return[d,...null==(e=d.columns)?void 0:e.flatMap(e=>e.getFlatColumns())]},Rs(e.options,"debugColumns")),getLeafColumns:Ss(()=>[e._getOrderColumnsFn()],e=>{var t;if(null!=(t=d.columns)&&t.length){let t=d.columns.flatMap(e=>e.getLeafColumns());return e(t)}return[d]},Rs(e.options,"debugColumns"))};for(const t of e._features)null==t.createColumn||t.createColumn(d,e);return d}(r,e,n,s),i=e;return a.columns=i.columns?t(i.columns,a,n+1):[],a})};return t(e)},Rs(e,"debugColumns")),getAllFlatColumns:Ss(()=>[r.getAllColumns()],e=>e.flatMap(e=>e.getFlatColumns()),Rs(e,"debugColumns")),_getAllFlatColumnsById:Ss(()=>[r.getAllFlatColumns()],e=>e.reduce((e,t)=>(e[t.id]=t,e),{}),Rs(e,"debugColumns")),getAllLeafColumns:Ss(()=>[r.getAllColumns(),r._getOrderColumnsFn()],(e,t)=>t(e.flatMap(e=>e.getLeafColumns())),Rs(e,"debugColumns")),getColumn:e=>r._getAllFlatColumnsById()[e]};Object.assign(r,c);for(let e=0;e<r._features.length;e++){const t=r._features[e];null==t||null==t.createTable||t.createTable(r)}return r}function pn(){return e=>Ss(()=>[e.options.data],t=>{const s={rows:[],flatRows:[],rowsById:{}},n=function(t,r,a){void 0===r&&(r=0);const i=[];for(let o=0;o<t.length;o++){const c=Is(e,e._getRowId(t[o],o,a),t[o],o,r,void 0,null==a?void 0:a.id);var l;s.flatRows.push(c),s.rowsById[c.id]=c,i.push(c),e.options.getSubRows&&(c.originalSubRows=e.options.getSubRows(t[o],o),null!=(l=c.originalSubRows)&&l.length&&(c.subRows=n(c.originalSubRows,r+1,c)))}return i};return s.rows=n(t),s},Rs(e.options,"debugTable",0,()=>e._autoResetPageIndex()))}function xn(e,t){return e?function(e){return"function"==typeof e&&(()=>{const t=Object.getPrototypeOf(e);return t.prototype&&t.prototype.isReactComponent})()}(s=e)||"function"==typeof s||function(e){return"object"==typeof e&&"symbol"==typeof e.$$typeof&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}(s)?a.createElement(e,t):e:null;var s}function fn(e){const t={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[s]=a.useState(()=>({current:gn(t)})),[n,r]=a.useState(()=>s.current.initialState);return s.current.setOptions(t=>({...t,...e,state:{...n,...e.state},onStateChange:t=>{r(t),null==e.onStateChange||e.onStateChange(t)}})),s.current}function vn({isPropagating:e,mentionCount:t}){return e?(0,yt.jsxs)("div",{className:"relative group",children:[(0,yt.jsxs)("svg",{className:"w-4 h-4 text-blue-500 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,yt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,yt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,yt.jsxs)("div",{className:"absolute left-full ml-2 top-1/2 -translate-y-1/2 bg-gray-900 text-white text-xs rounded px-2 py-1 whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-10",children:["Syncing Schema to ",t," posts..."]})]}):null}function bn({value:e,onSave:t,onCancel:s}){const[n,r]=(0,a.useState)(e),i=(0,a.useRef)(null);return(0,a.useEffect)(()=>{i.current?.focus(),i.current?.select()},[]),(0,yt.jsx)("input",{ref:i,type:"text",value:n,onChange:e=>r(e.target.value),onBlur:()=>t(n),onKeyDown:e=>{"Enter"===e.key?t(n):"Escape"===e.key&&s()},className:"w-full px-2 py-1 text-sm border border-blue-500 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"})}function yn({value:e,onSave:t,onCancel:s}){const n=(0,a.useRef)(null);return(0,a.useEffect)(()=>{n.current?.focus()},[]),(0,yt.jsx)("select",{ref:n,value:e,onChange:e=>{t(e.target.value)},onBlur:s,className:"w-full px-2 py-1 text-sm border border-blue-500 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:qn.map(e=>(0,yt.jsx)("option",{value:e.value,children:e.label},e.value))})}function jn({status:e}){const t=Un.find(t=>t.value===e)||Un[0];return(0,yt.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${t.color}`,children:t.label})}function wn({indeterminate:e,checked:t,onChange:s,...n}){const r=(0,a.useRef)(null);return(0,a.useEffect)(()=>{"boolean"==typeof e&&r.current&&(r.current.indeterminate=!t&&e)},[e,t]),(0,yt.jsx)("input",{type:"checkbox",ref:r,checked:t,onChange:s,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",...n})}function Nn({data:e,totalCount:t,totalPages:s,pagination:n,onPaginationChange:r,sorting:i,onSortingChange:l,rowSelection:o,onRowSelectionChange:c,onEntityClick:d,onInlineEdit:u,editingCell:h,onEditingCellChange:m}){const g=(0,a.useMemo)(()=>[{id:"select",header:({table:e})=>(0,yt.jsx)(wn,{checked:e.getIsAllRowsSelected(),indeterminate:e.getIsSomeRowsSelected(),onChange:e.getToggleAllRowsSelectedHandler()}),cell:({row:e})=>(0,yt.jsx)(wn,{checked:e.getIsSelected(),indeterminate:e.getIsSomeSelected(),onChange:e.getToggleSelectedHandler()}),size:40},{accessorKey:"name",header:({column:e})=>(0,yt.jsxs)("button",{onClick:()=>e.toggleSorting(),className:"flex items-center gap-1 font-medium text-gray-900 hover:text-blue-600",children:["Name","asc"===e.getIsSorted()&&(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"desc"===e.getIsSorted()&&(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),!e.getIsSorted()&&(0,yt.jsx)("svg",{className:"w-4 h-4 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})})]}),cell:({row:e})=>{const t=e.original;return h?.id===t.id&&"name"===h?.field?(0,yt.jsx)(bn,{value:t.name,onSave:e=>u(t.id,"name",e),onCancel:()=>m(null)}):(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("button",{onClick:()=>d(t.id),className:"font-medium text-blue-600 hover:text-blue-800 hover:underline text-left",children:t.name}),(0,yt.jsx)("button",{onClick:e=>{e.stopPropagation(),m({id:t.id,field:"name"})},className:"opacity-0 group-hover:opacity-100 p-1 text-gray-400 hover:text-gray-600",title:"Edit name",children:(0,yt.jsx)("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),(0,yt.jsx)(vn,{isPropagating:t.is_propagating,mentionCount:t.mention_count})]})},size:250},{accessorKey:"type",header:({column:e})=>(0,yt.jsxs)("button",{onClick:()=>e.toggleSorting(),className:"flex items-center gap-1 font-medium text-gray-900 hover:text-blue-600",children:["Type","asc"===e.getIsSorted()&&(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"desc"===e.getIsSorted()&&(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),cell:({row:e})=>{const t=e.original,s=h?.id===t.id&&"type"===h?.field,n=qn.find(e=>e.value===t.type)?.label||t.type;return s?(0,yt.jsx)(yn,{value:t.type,onSave:e=>u(t.id,"type",e),onCancel:()=>m(null)}):(0,yt.jsxs)("button",{onClick:()=>m({id:t.id,field:"type"}),className:"inline-flex items-center gap-1 px-2 py-1 text-sm text-gray-700 bg-gray-100 rounded hover:bg-gray-200",children:[n,(0,yt.jsx)("svg",{className:"w-3 h-3 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})},size:140},{accessorKey:"mention_count",header:({column:e})=>(0,yt.jsxs)("button",{onClick:()=>e.toggleSorting(),className:"flex items-center gap-1 font-medium text-gray-900 hover:text-blue-600",children:["Mentions","asc"===e.getIsSorted()&&(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"desc"===e.getIsSorted()&&(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),cell:({row:e})=>(0,yt.jsx)("span",{className:"inline-flex items-center justify-center min-w-[2rem] px-2 py-0.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-full",children:e.original.mention_count||0}),size:100},{accessorKey:"status",header:({column:e})=>(0,yt.jsxs)("button",{onClick:()=>e.toggleSorting(),className:"flex items-center gap-1 font-medium text-gray-900 hover:text-blue-600",children:["Status","asc"===e.getIsSorted()&&(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"desc"===e.getIsSorted()&&(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),cell:({row:e})=>(0,yt.jsx)(jn,{status:e.original.status}),size:120},{id:"schema_map",header:"Schema Map",cell:({row:e})=>{const t=e.original;return t.same_as_url?(0,yt.jsxs)("a",{href:t.same_as_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-sm text-blue-600 hover:text-blue-800 hover:underline",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Link"]}):(0,yt.jsx)("span",{className:"text-gray-400",children:"-"})},size:100}],[h,d,u,m]),p=fn({data:e,columns:g,state:{sorting:i,rowSelection:o,pagination:n},pageCount:s,onSortingChange:l,onRowSelectionChange:c,onPaginationChange:r,getCoreRowModel:pn(),manualSorting:!0,manualPagination:!0,enableRowSelection:!0});return 0===e.length?(0,yt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[(0,yt.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),(0,yt.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No entities found"}),(0,yt.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Start by running the extraction pipeline to discover entities in your content."})]}):(0,yt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,yt.jsx)("div",{className:"overflow-x-auto",children:(0,yt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,yt.jsx)("thead",{className:"bg-gray-50",children:p.getHeaderGroups().map(e=>(0,yt.jsx)("tr",{children:e.headers.map(e=>(0,yt.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:e.getSize()},children:e.isPlaceholder?null:xn(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,yt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:p.getRowModel().rows.map(e=>(0,yt.jsx)("tr",{className:"group hover:bg-gray-50 "+(e.original.is_propagating?"bg-blue-50":""),children:e.getVisibleCells().map(e=>(0,yt.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:xn(e.column.columnDef.cell,e.getContext())},e.id))},e.id))})]})}),(0,yt.jsx)("div",{className:"bg-gray-50 px-4 py-3 border-t border-gray-200",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:(0,yt.jsxs)("span",{children:["Showing ",n.pageIndex*n.pageSize+1," to"," ",Math.min((n.pageIndex+1)*n.pageSize,t)," ","of ",t," entities"]})}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("select",{value:n.pageSize,onChange:e=>r({pageIndex:0,pageSize:Number(e.target.value)}),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:[10,25,50,100].map(e=>(0,yt.jsxs)("option",{value:e,children:[e," per page"]},e))}),(0,yt.jsxs)("div",{className:"flex items-center gap-1",children:[(0,yt.jsx)("button",{onClick:()=>r({...n,pageIndex:0}),disabled:0===n.pageIndex,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),(0,yt.jsx)("button",{onClick:()=>r({...n,pageIndex:n.pageIndex-1}),disabled:0===n.pageIndex,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,yt.jsxs)("span",{className:"px-3 py-1 text-sm",children:["Page ",n.pageIndex+1," of ",s]}),(0,yt.jsx)("button",{onClick:()=>r({...n,pageIndex:n.pageIndex+1}),disabled:n.pageIndex>=s-1,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),(0,yt.jsx)("button",{onClick:()=>r({...n,pageIndex:s-1}),disabled:n.pageIndex>=s-1,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})})]})]})]})})]})}function Cn({selectedCount:e,onMerge:t,onDelete:s,onStatusChange:n,isDeleting:r,isUpdating:i}){const[l,o]=(0,a.useState)(!1),c=(0,a.useRef)(null);return(0,a.useEffect)(()=>{const e=e=>{c.current&&!c.current.contains(e.target)&&o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),0===e?null:(0,yt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-blue-600 text-white text-sm font-medium rounded-full",children:e}),(0,yt.jsxs)("span",{className:"text-sm font-medium text-blue-900",children:[1===e?"entity":"entities"," selected"]})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsxs)("button",{onClick:t,disabled:e<2,className:`\n                            inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium rounded-md\n                            ${e>=2?"bg-purple-600 text-white hover:bg-purple-700":"bg-gray-200 text-gray-400 cursor-not-allowed"}\n                            transition-colors\n                        `,title:e<2?"Select at least 2 entities to merge":"Merge selected entities",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Merge"]}),(0,yt.jsxs)("div",{className:"relative",ref:c,children:[(0,yt.jsx)("button",{onClick:()=>o(!l),disabled:i,className:"\n                                inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium rounded-md\n                                bg-white border border-gray-300 text-gray-700\n                                hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\n                                transition-colors\n                            ",children:i?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,yt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,yt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Updating..."]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})}),"Set Status",(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),l&&(0,yt.jsx)("div",{className:"absolute right-0 mt-1 w-40 bg-white rounded-md shadow-lg border border-gray-200 z-10",children:(0,yt.jsx)("div",{className:"py-1",children:Un.map(e=>(0,yt.jsxs)("button",{onClick:()=>(e=>{n(e),o(!1)})(e.value),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[(0,yt.jsx)("span",{className:`w-2 h-2 rounded-full ${e.color.split(" ")[0]}`}),e.label]},e.value))})})]}),(0,yt.jsx)("button",{onClick:s,disabled:r,className:"\n                            inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium rounded-md\n                            bg-red-600 text-white hover:bg-red-700\n                            disabled:opacity-50 disabled:cursor-not-allowed\n                            transition-colors\n                        ",children:r?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,yt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,yt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})})]})]})})}function kn({label:e,options:t,selected:s,onChange:n,icon:r}){const[i,l]=(0,a.useState)(!1),o=(0,a.useRef)(null);(0,a.useEffect)(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&l(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const c=t.filter(e=>s.includes(e.value)).map(e=>e.label);return(0,yt.jsxs)("div",{className:"relative",ref:o,children:[(0,yt.jsxs)("button",{onClick:()=>l(!i),className:`\n                    inline-flex items-center gap-2 px-3 py-2 text-sm\n                    bg-white border rounded-md\n                    hover:bg-gray-50 transition-colors\n                    ${s.length>0?"border-blue-500 text-blue-700":"border-gray-300 text-gray-700"}\n                `,children:[r,(0,yt.jsx)("span",{children:0===s.length?e:1===s.length?c[0]:`${s.length} selected`}),(0,yt.jsx)("svg",{className:"w-4 h-4 transition-transform "+(i?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&(0,yt.jsxs)("div",{className:"absolute left-0 mt-1 w-56 bg-white rounded-md shadow-lg border border-gray-200 z-20",children:[(0,yt.jsx)("div",{className:"py-1 max-h-64 overflow-y-auto",children:t.map(e=>(0,yt.jsxs)("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-gray-50 cursor-pointer",children:[(0,yt.jsx)("input",{type:"checkbox",checked:s.includes(e.value),onChange:()=>(e=>{const t=s.includes(e)?s.filter(t=>t!==e):[...s,e];n(t)})(e.value),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,yt.jsxs)("span",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.color&&(0,yt.jsx)("span",{className:`w-2 h-2 rounded-full ${e.color.split(" ")[0]}`}),e.label]})]},e.value))}),s.length>0&&(0,yt.jsx)("div",{className:"border-t border-gray-200 px-4 py-2",children:(0,yt.jsx)("button",{onClick:()=>n([]),className:"text-sm text-blue-600 hover:text-blue-800",children:"Clear selection"})})]})]})}function Sn({filters:e,onChange:t,onClear:s}){const[n,r]=(0,a.useState)(e.search),i=function(e){const[t,s]=(0,a.useState)(e);return(0,a.useEffect)(()=>{const t=setTimeout(()=>s(e),300);return()=>clearTimeout(t)},[e,300]),t}(n);(0,a.useEffect)(()=>{i!==e.search&&t({...e,search:i})},[i,e,t]),(0,a.useEffect)(()=>{e.search!==n&&""===e.search&&r("")},[e.search]);const l=(0,a.useCallback)(s=>{t({...e,types:s})},[e,t]),o=(0,a.useCallback)(s=>{t({...e,statuses:s})},[e,t]),c=e.search||e.types.length>0||e.statuses.length>0;return(0,yt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[(0,yt.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,yt.jsxs)("div",{className:"relative flex-1 min-w-[200px] max-w-md",children:[(0,yt.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,yt.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,yt.jsx)("input",{type:"text",value:n,onChange:e=>r(e.target.value),placeholder:"Search entities...",className:"w-full pl-10 pr-4 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),n&&(0,yt.jsx)("button",{onClick:()=>r(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,yt.jsx)(kn,{label:"Type",options:qn,selected:e.types,onChange:l,icon:(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),(0,yt.jsx)(kn,{label:"Status",options:Un,selected:e.statuses,onChange:o,icon:(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})})}),c&&(0,yt.jsxs)("button",{onClick:()=>{r(""),s()},className:"inline-flex items-center gap-1.5 px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear filters"]})]}),c&&(0,yt.jsxs)("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[(0,yt.jsx)("span",{className:"text-xs text-gray-500",children:"Active filters:"}),e.search&&(0,yt.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs",children:['Search: "',e.search,'"',(0,yt.jsx)("button",{onClick:()=>{r(""),t({...e,search:""})},className:"hover:text-blue-900",children:(0,yt.jsx)("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.types.map(t=>{const s=qn.find(e=>e.value===t)?.label||t;return(0,yt.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs",children:[s,(0,yt.jsx)("button",{onClick:()=>l(e.types.filter(e=>e!==t)),className:"hover:text-purple-900",children:(0,yt.jsx)("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},t)}),e.statuses.map(t=>{const s=Un.find(e=>e.value===t);return(0,yt.jsxs)("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs ${s?.color||"bg-gray-100 text-gray-700"}`,children:[s?.label||t,(0,yt.jsx)("button",{onClick:()=>o(e.statuses.filter(e=>e!==t)),className:"hover:opacity-80",children:(0,yt.jsx)("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},t)})]})]})}const Rn=async({targetId:e,sourceIds:t})=>{const s=await fetch(`${window.vibeAI?.restUrl||"/wp-json/"}vibe-ai/v1/entities/merge`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.vibeAI?.nonce||""},body:JSON.stringify({target_id:e,source_ids:t})});if(!s.ok){const e=await s.json();throw new Error(e.message||"Failed to merge entities")}return s.json()};function Ln({isOpen:e,onClose:t,entities:s,onMergeComplete:n}){const[r,i]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(e&&s.length>0){const e=s.reduce((e,t)=>(t.mention_count||0)>(e.mention_count||0)?t:e);i(e.id)}},[e,s]);const l=ws({mutationFn:Rn,onSuccess:()=>{n()}}),o={aliasesToTransfer:s.filter(e=>e.id!==r).reduce((e,t)=>e+(t.alias_count||0)+1,0),mentionsToUpdate:s.filter(e=>e.id!==r).reduce((e,t)=>e+(t.mention_count||0),0),entitiesToMerge:s.filter(e=>e.id!==r).length};return e?(0,yt.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,yt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),(0,yt.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,yt.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl max-w-lg w-full",children:[(0,yt.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Merge Entities"}),(0,yt.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,yt.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Select which entity should be the canonical master. All other entities will be merged into it."})]}),(0,yt.jsxs)("div",{className:"px-6 py-4",children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Which entity should be the Master?"}),(0,yt.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:s.map(e=>(0,yt.jsxs)("label",{className:`\n                                        flex items-center gap-3 p-3 rounded-lg border cursor-pointer\n                                        transition-colors\n                                        ${r===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}\n                                    `,children:[(0,yt.jsx)("input",{type:"radio",name:"master-entity",value:e.id,checked:r===e.id,onChange:()=>i(e.id),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,yt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("span",{className:"font-medium text-gray-900 truncate",children:e.name}),(0,yt.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-700",children:e.type})]}),(0,yt.jsxs)("div",{className:"text-sm text-gray-500 mt-0.5",children:[e.mention_count||0," mentions",e.alias_count>0&&` | ${e.alias_count} aliases`]})]}),r===e.id&&(0,yt.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:"Master"})]},e.id))}),r&&(0,yt.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,yt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Merge Preview"}),(0,yt.jsxs)("ul",{className:"space-y-1 text-sm text-gray-600",children:[(0,yt.jsxs)("li",{className:"flex items-center gap-2",children:[(0,yt.jsx)("svg",{className:"w-4 h-4 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),o.entitiesToMerge," entities will be merged"]}),(0,yt.jsxs)("li",{className:"flex items-center gap-2",children:[(0,yt.jsx)("svg",{className:"w-4 h-4 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),o.aliasesToTransfer," aliases will be transferred"]}),(0,yt.jsxs)("li",{className:"flex items-center gap-2",children:[(0,yt.jsx)("svg",{className:"w-4 h-4 text-purple-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),o.mentionsToUpdate," mentions will be updated"]})]})]}),l.isError&&(0,yt.jsx)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,yt.jsxs)("div",{className:"flex items-start gap-2",children:[(0,yt.jsx)("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("p",{className:"text-sm font-medium text-red-800",children:"Merge failed"}),(0,yt.jsx)("p",{className:"text-sm text-red-600",children:l.error?.message})]})]})})]}),(0,yt.jsxs)("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end gap-3",children:[(0,yt.jsx)("button",{onClick:t,disabled:l.isLoading,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),(0,yt.jsx)("button",{onClick:()=>{if(!r)return;const e=s.filter(e=>e.id!==r).map(e=>e.id);l.mutate({targetId:r,sourceIds:e})},disabled:!r||l.isLoading,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center gap-2",children:l.isLoading?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,yt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,yt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Merging..."]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Confirm Merge"]})})]})]})})]}):null}function Mn({formData:e,slug:t,onChange:s}){return(0,yt.jsxs)("div",{className:"p-6",children:[(0,yt.jsx)("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wider mb-4",children:"Identity"}),(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{htmlFor:"entity-name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Canonical Name"}),(0,yt.jsx)("input",{id:"entity-name",type:"text",value:e.name,onChange:e=>s("name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Enter entity name"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Slug"}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("input",{type:"text",value:t||"",readOnly:!0,className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-md text-sm text-gray-500 cursor-not-allowed"}),(0,yt.jsx)("span",{className:"text-xs text-gray-400 whitespace-nowrap",children:"Auto-generated"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{htmlFor:"entity-type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),(0,yt.jsx)("select",{id:"entity-type",value:e.type,onChange:e=>s("type",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:qn.map(e=>(0,yt.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,yt.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"This determines the Schema.org type used in JSON-LD output."})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{htmlFor:"entity-status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,yt.jsx)("select",{id:"entity-status",value:e.status,onChange:e=>s("status",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:Un.map(e=>(0,yt.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,yt.jsxs)("div",{className:"mt-2 flex items-start gap-2 p-2 bg-gray-50 rounded text-xs text-gray-600",children:[(0,yt.jsx)("svg",{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("strong",{children:"raw"}),": Newly extracted, not reviewed",(0,yt.jsx)("br",{}),(0,yt.jsx)("strong",{children:"reviewed"}),": Human-verified accuracy",(0,yt.jsx)("br",{}),(0,yt.jsx)("strong",{children:"canonical"}),": Official, production-ready",(0,yt.jsx)("br",{}),(0,yt.jsx)("strong",{children:"trash"}),": Soft-deleted, excluded from Schema"]})]})]})]})]})}function Pn({formData:e,onChange:t}){const[s,n]=(0,a.useState)(!1),[r,i]=(0,a.useState)(null),l=(0,a.useCallback)(e=>!e||/^Q\d+$/.test(e),[])(e.wikidata_id),o=(0,a.useCallback)(async()=>{if(e.same_as_url){n(!0),i(null);try{const s=await(async e=>{const t=e.match(/wikipedia\.org\/wiki\/(.+)$/);if(!t)throw new Error("Invalid Wikipedia URL format");const s=decodeURIComponent(t[1]),n=`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(s)}`,r=await fetch(n);if(!r.ok)throw new Error("Failed to fetch Wikipedia data");return r.json()})(e.same_as_url);if(s.extract&&!e.description){const e=s.extract.substring(0,500);t("description",e)}s.wikibase_item&&!e.wikidata_id&&t("wikidata_id",s.wikibase_item)}catch(e){i(e.message)}finally{n(!1)}}},[e.same_as_url,e.description,e.wikidata_id,t]),c=e.description?.length||0,d=c>500;return(0,yt.jsxs)("div",{className:"p-6",children:[(0,yt.jsx)("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wider mb-4",children:"Semantic Links"}),(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{htmlFor:"entity-wikipedia",className:"block text-sm font-medium text-gray-700 mb-1",children:"Wikipedia URL"}),(0,yt.jsxs)("div",{className:"flex gap-2",children:[(0,yt.jsx)("input",{id:"entity-wikipedia",type:"url",value:e.same_as_url,onChange:e=>t("same_as_url",e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"https://en.wikipedia.org/wiki/..."}),(0,yt.jsx)("button",{onClick:o,disabled:!e.same_as_url||s,className:"inline-flex items-center gap-1.5 px-3 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:s?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,yt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,yt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Fetching..."]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Fetch"]})})]}),r&&(0,yt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:r}),(0,yt.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Used as sameAs property in Schema.org output"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{htmlFor:"entity-wikidata",className:"block text-sm font-medium text-gray-700 mb-1",children:"Wikidata ID"}),(0,yt.jsx)("input",{id:"entity-wikidata",type:"text",value:e.wikidata_id,onChange:e=>t("wikidata_id",e.target.value.toUpperCase()),className:"w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm "+(l?"border-gray-300":"border-red-300 bg-red-50"),placeholder:"Q12345"}),!l&&(0,yt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:"Invalid format. Wikidata IDs must start with Q followed by numbers (e.g., Q12345)"}),e.wikidata_id&&l&&(0,yt.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:(0,yt.jsx)("a",{href:`https://www.wikidata.org/wiki/${e.wikidata_id}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"View on Wikidata"})})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{htmlFor:"entity-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,yt.jsx)("textarea",{id:"entity-description",value:e.description,onChange:e=>t("description",e.target.value),rows:4,maxLength:550,className:"w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm resize-none "+(d?"border-red-300 bg-red-50":"border-gray-300"),placeholder:"Brief description for Schema.org output"}),(0,yt.jsxs)("div",{className:"mt-1 flex justify-between text-xs",children:[(0,yt.jsx)("span",{className:"text-gray-500",children:"Used as the description property in Schema.org"}),(0,yt.jsxs)("span",{className:d?"text-red-600 font-medium":"text-gray-400",children:[c,"/",500]})]})]})]})]})}function In({aliases:e,onAdd:t,onRemove:s}){const[n,r]=(0,a.useState)(""),[i,l]=(0,a.useState)(null),o=(0,a.useRef)(null);(0,a.useEffect)(()=>{i&&n&&l(null)},[n,i]);const c=(0,a.useCallback)(()=>{const s=n.trim();s?e.some(e=>e.alias.toLowerCase()===s.toLowerCase())?l("This alias already exists"):(t(s),r(""),l(null),o.current?.focus()):l("Please enter an alias")},[n,e,t]),d=(0,a.useCallback)(e=>{"Enter"===e.key&&(e.preventDefault(),c())},[c]);return(0,yt.jsxs)("div",{className:"p-6",children:[(0,yt.jsx)("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wider mb-4",children:"Aliases"}),(0,yt.jsxs)("div",{className:"mb-4",children:[(0,yt.jsxs)("div",{className:"flex gap-2",children:[(0,yt.jsx)("input",{ref:o,type:"text",value:n,onChange:e=>r(e.target.value),onKeyDown:d,className:"flex-1 px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm "+(i?"border-red-300":"border-gray-300"),placeholder:"Add a new alias..."}),(0,yt.jsxs)("button",{onClick:c,className:"inline-flex items-center gap-1 px-3 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add"]})]}),i&&(0,yt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:i})]}),0===e.length?(0,yt.jsxs)("div",{className:"text-center py-6 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:[(0,yt.jsx)("svg",{className:"mx-auto h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),(0,yt.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"No aliases yet"}),(0,yt.jsx)("p",{className:"text-xs text-gray-400",children:"Add alternate names for this entity"})]}):(0,yt.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map(e=>(0,yt.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1.5 bg-gray-100 text-gray-700 rounded-full text-sm group hover:bg-gray-200 transition-colors",children:[e.alias,(0,yt.jsx)("button",{onClick:()=>s(e.alias_slug||e.alias.toLowerCase().replace(/\s+/g,"-")),className:"ml-1 text-gray-400 hover:text-red-500 transition-colors",title:`Remove "${e.alias}"`,children:(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},e.alias_slug||e.alias))}),(0,yt.jsx)("p",{className:"mt-4 text-xs text-gray-500",children:"Aliases help match variations of this entity name during extraction. Examples: abbreviations, nicknames, alternate spellings."})]})}function Fn({confidence:e}){const t=Math.round(100*e);let s="bg-green-100 text-green-700";return t<60?s="bg-red-100 text-red-700":t<85&&(s="bg-yellow-100 text-yellow-700"),(0,yt.jsxs)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${s}`,children:[t,"%"]})}function En({entityId:e}){const{data:t,isLoading:s,isError:n}=ys({queryKey:["entity-mentions",e],queryFn:()=>(async e=>{const t=await fetch(`${window.vibeAI?.restUrl||"/wp-json/"}vibe-ai/v1/entities/${e}/mentions?limit=5`,{headers:{"X-WP-Nonce":window.vibeAI?.nonce||""}});if(!t.ok)throw new Error("Failed to fetch mentions");return t.json()})(e),enabled:!!e,staleTime:6e4});return(0,yt.jsxs)("div",{className:"p-6",children:[(0,yt.jsx)("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wider mb-4",children:"Mention Context"}),s&&(0,yt.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,yt.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,yt.jsx)("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),"Loading mentions..."]})}),n&&(0,yt.jsx)("div",{className:"text-center py-6 bg-red-50 rounded-lg",children:(0,yt.jsx)("p",{className:"text-sm text-red-600",children:"Failed to load mentions"})}),!s&&!n&&0===t?.length&&(0,yt.jsxs)("div",{className:"text-center py-6 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:[(0,yt.jsx)("svg",{className:"mx-auto h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,yt.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"No mentions found"}),(0,yt.jsx)("p",{className:"text-xs text-gray-400",children:"This entity has not been linked to any posts yet"})]}),!s&&!n&&t?.length>0&&(0,yt.jsxs)("div",{className:"space-y-3",children:[t.map(e=>(0,yt.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:[(0,yt.jsxs)("div",{className:"flex items-start justify-between gap-3 mb-2",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,yt.jsx)("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,yt.jsx)("a",{href:e.post_url||`${window.vibeAI?.adminUrl||"/wp-admin/"}post.php?post=${e.post_id}&action=edit`,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-gray-900 hover:text-blue-600 truncate",title:e.post_title,children:e.post_title||`Post #${e.post_id}`})]}),(0,yt.jsx)(Fn,{confidence:e.confidence})]}),e.context_snippet&&(0,yt.jsx)("div",{className:"mt-2 text-sm text-gray-600 bg-gray-50 rounded p-3 border-l-2 border-gray-300",children:(0,yt.jsxs)("span",{className:"italic",children:['"...',e.context_snippet,'..."']})}),(0,yt.jsxs)("div",{className:"mt-2 flex items-center gap-3 text-xs text-gray-400",children:[e.is_primary&&(0,yt.jsxs)("span",{className:"inline-flex items-center gap-1 text-blue-600",children:[(0,yt.jsx)("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),"Primary entity"]}),(0,yt.jsxs)("span",{children:["Post ID: ",e.post_id]})]})]},e.id)),5===t.length&&(0,yt.jsx)("p",{className:"text-center text-xs text-gray-500 pt-2",children:"Showing top 5 mentions. View all in the Entity Grid."})]})]})}function On({onSave:e,onSaveAndPropagate:t,onForceSync:s,onDelete:n,isSaving:r,isPropagating:a,isSyncing:i,isDeleting:l,hasChanges:o,error:c}){const d=r||a||i||l;return(0,yt.jsxs)("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:[c&&(0,yt.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,yt.jsxs)("div",{className:"flex items-start gap-2",children:[(0,yt.jsx)("svg",{className:"w-5 h-5 text-red-500 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,yt.jsx)("p",{className:"text-sm text-red-600",children:c.message||"An error occurred"})]})}),(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("button",{onClick:n,disabled:d,className:"inline-flex items-center gap-1.5 px-3 py-2 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-md disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,yt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,yt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("button",{onClick:s,disabled:d||o,className:"inline-flex items-center gap-1.5 px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:o?"Save changes first":"Force sync to all posts",children:i?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,yt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,yt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Syncing..."]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Force Sync"]})}),(0,yt.jsx)("button",{onClick:e,disabled:d||!o,className:"inline-flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:r&&!a?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,yt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,yt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),"Save"]})}),(0,yt.jsx)("button",{onClick:t,disabled:d||!o,className:"inline-flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,yt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,yt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Propagating..."]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Save & Propagate"]})})]})]}),o&&(0,yt.jsxs)("p",{className:"mt-3 text-xs text-amber-600 flex items-center gap-1",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"You have unsaved changes"]})]})}const An=async({id:e,data:t})=>{const s=await fetch(`${window.vibeAI?.restUrl||"/wp-json/"}vibe-ai/v1/entities/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json","X-WP-Nonce":window.vibeAI?.nonce||""},body:JSON.stringify(t)});if(!s.ok)throw new Error("Failed to update entity");return s.json()},zn=async e=>{const t=await fetch(`${window.vibeAI?.restUrl||"/wp-json/"}vibe-ai/v1/entities/${e}`,{method:"DELETE",headers:{"X-WP-Nonce":window.vibeAI?.nonce||""}});if(!t.ok)throw new Error("Failed to delete entity");return t.json()},Tn=async e=>{const t=await fetch(`${window.vibeAI?.restUrl||"/wp-json/"}vibe-ai/v1/entities/${e}/propagate`,{method:"POST",headers:{"X-WP-Nonce":window.vibeAI?.nonce||""}});if(!t.ok)throw new Error("Failed to start propagation");return t.json()},Dn=async e=>{const t=await fetch(`${window.vibeAI?.restUrl||"/wp-json/"}vibe-ai/v1/entities/${e}/force-sync`,{method:"POST",headers:{"X-WP-Nonce":window.vibeAI?.nonce||""}});if(!t.ok)throw new Error("Failed to force sync");return t.json()};function Bn({isOpen:e,onClose:t,entityId:s}){const n=wt(),[r,i]=(0,a.useState)(null),[l,o]=(0,a.useState)(!1),{data:c,isLoading:d,isError:u,error:h}=ys({queryKey:["entity",s],queryFn:()=>(async e=>{const t=await fetch(`${window.vibeAI?.restUrl||"/wp-json/"}vibe-ai/v1/entities/${e}`,{headers:{"X-WP-Nonce":window.vibeAI?.nonce||""}});if(!t.ok)throw new Error("Failed to fetch entity");return t.json()})(s),enabled:e&&!!s,staleTime:0});(0,a.useEffect)(()=>{c&&(i({name:c.name||"",type:c.type||"CONCEPT",status:c.status||"raw",same_as_url:c.same_as_url||"",wikidata_id:c.wikidata_id||"",description:c.description||"",aliases:c.aliases||[]}),o(!1))},[c]);const m=ws({mutationFn:An,onSuccess:()=>{n.invalidateQueries({queryKey:["entities"]}),n.invalidateQueries({queryKey:["entity",s]}),o(!1)}}),g=ws({mutationFn:zn,onSuccess:()=>{n.invalidateQueries({queryKey:["entities"]}),t()}}),p=ws({mutationFn:Tn,onSuccess:()=>{n.invalidateQueries({queryKey:["entities"]}),n.invalidateQueries({queryKey:["entity",s]})}}),x=ws({mutationFn:Dn,onSuccess:()=>{n.invalidateQueries({queryKey:["entities"]}),n.invalidateQueries({queryKey:["entity",s]})}}),f=(0,a.useCallback)((e,t)=>{i(s=>{if(!s)return s;const n={...s,[e]:t};return o(!0),n})},[]),v=(0,a.useCallback)(()=>{r&&s&&m.mutate({id:s,data:r})},[r,s,m]),b=(0,a.useCallback)(async()=>{if(r&&s)try{await m.mutateAsync({id:s,data:r}),await p.mutateAsync(s)}catch(e){}},[r,s,m,p]),y=(0,a.useCallback)(()=>{s&&x.mutate(s)},[s,x]),j=(0,a.useCallback)(()=>{s&&window.confirm('Are you sure you want to delete this entity? This will set its status to "trash".')&&g.mutate(s)},[s,g]),w=(0,a.useCallback)(()=>{l?window.confirm("You have unsaved changes. Are you sure you want to close?")&&t():t()},[l,t]),N=(0,a.useCallback)(e=>{i(t=>{if(!t)return t;if(t.aliases.some(t=>t.alias===e))return t;const s={...t,aliases:[...t.aliases,{alias:e,alias_slug:e.toLowerCase().replace(/\s+/g,"-")}]};return o(!0),s})},[]),C=(0,a.useCallback)(e=>{i(t=>{if(!t)return t;const s={...t,aliases:t.aliases.filter(t=>t.alias_slug!==e)};return o(!0),s})},[]);return e?(0,yt.jsxs)("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[(0,yt.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-25 transition-opacity",onClick:w}),(0,yt.jsx)("div",{className:"absolute inset-y-0 right-0 flex max-w-full pl-10",children:(0,yt.jsx)("div",{className:"w-screen max-w-lg",children:(0,yt.jsxs)("div",{className:"flex h-full flex-col bg-white shadow-xl",children:[(0,yt.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:[(0,yt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:d?"Loading...":r?.name||"Entity Details"}),c?.slug&&(0,yt.jsxs)("p",{className:"text-sm text-gray-500 mt-0.5",children:["/",c.slug]})]}),(0,yt.jsx)("button",{onClick:w,className:"rounded-md text-gray-400 hover:text-gray-500 focus:outline-none",children:(0,yt.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c?.is_propagating&&(0,yt.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-sm text-blue-600",children:[(0,yt.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,yt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,yt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Propagating changes to ",c.mention_count," posts..."]})]}),(0,yt.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[d&&(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,yt.jsx)("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,yt.jsx)("span",{className:"text-sm text-gray-500",children:"Loading entity..."})]})}),u&&(0,yt.jsx)("div",{className:"p-6",children:(0,yt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,yt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,yt.jsx)("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-medium text-red-800",children:"Failed to load entity"}),(0,yt.jsx)("p",{className:"text-sm text-red-600 mt-1",children:h?.message})]})]})})}),!d&&!u&&r&&(0,yt.jsxs)("div",{className:"divide-y divide-gray-200",children:[(0,yt.jsx)(Mn,{formData:r,slug:c?.slug,onChange:f}),(0,yt.jsx)(Pn,{formData:r,onChange:f}),(0,yt.jsx)(In,{aliases:r.aliases,onAdd:N,onRemove:C}),(0,yt.jsx)(En,{entityId:s})]})]}),!d&&!u&&r&&(0,yt.jsx)(On,{onSave:v,onSaveAndPropagate:b,onForceSync:y,onDelete:j,isSaving:m.isLoading,isPropagating:p.isLoading,isSyncing:x.isLoading,isDeleting:g.isLoading,hasChanges:l,error:m.error||g.error||p.error||x.error})]})})})]}):null}var Vn=Bn;const Wn=async({id:e,data:t})=>{const s=await fetch(`${window.vibeAI?.restUrl||"/wp-json/"}vibe-ai/v1/entities/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json","X-WP-Nonce":window.vibeAI?.nonce||""},body:JSON.stringify(t)});if(!s.ok)throw new Error("Failed to update entity");return s.json()},Hn=async e=>{const t=await fetch(`${window.vibeAI?.restUrl||"/wp-json/"}vibe-ai/v1/entities/bulk-delete`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.vibeAI?.nonce||""},body:JSON.stringify({ids:e})});if(!t.ok)throw new Error("Failed to delete entities");return t.json()},$n=async({ids:e,status:t})=>{const s=await fetch(`${window.vibeAI?.restUrl||"/wp-json/"}vibe-ai/v1/entities/bulk-status`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.vibeAI?.nonce||""},body:JSON.stringify({ids:e,status:t})});if(!s.ok)throw new Error("Failed to update entities status");return s.json()},qn=[{value:"PERSON",label:"Person"},{value:"ORG",label:"Organization"},{value:"COMPANY",label:"Company"},{value:"LOCATION",label:"Location"},{value:"COUNTRY",label:"Country"},{value:"PRODUCT",label:"Product"},{value:"SOFTWARE",label:"Software"},{value:"EVENT",label:"Event"},{value:"WORK",label:"Creative Work"},{value:"CONCEPT",label:"Concept"}],Un=[{value:"raw",label:"Raw",color:"bg-gray-100 text-gray-700"},{value:"reviewed",label:"Reviewed",color:"bg-blue-100 text-blue-700"},{value:"canonical",label:"Canonical",color:"bg-green-100 text-green-700"},{value:"trash",label:"Trash",color:"bg-red-100 text-red-700"}];function Qn(){const e=wt(),[t,s]=(0,a.useState)({pageIndex:0,pageSize:25}),[n,r]=(0,a.useState)([]),[i,l]=(0,a.useState)({}),[o,c]=(0,a.useState)({search:"",types:[],statuses:[]}),[d,u]=(0,a.useState)(!1),[h,m]=(0,a.useState)(null),[g,p]=(0,a.useState)(!1),[x,f]=(0,a.useState)(null),{data:v,isLoading:b,isError:y,error:j,isFetching:w}=ys({queryKey:["entities",t,o,n],queryFn:()=>(async({page:e,pageSize:t,filters:s,sorting:n})=>{const r=new URLSearchParams({page:e.toString(),per_page:t.toString(),...s.search&&{search:s.search},...s.types?.length&&{types:s.types.join(",")},...s.statuses?.length&&{statuses:s.statuses.join(",")},...n.length&&{orderby:n[0].id,order:n[0].desc?"desc":"asc"}}),a=await fetch(`${window.vibeAI?.restUrl||"/wp-json/"}vibe-ai/v1/entities?${r}`,{headers:{"X-WP-Nonce":window.vibeAI?.nonce||""}});if(!a.ok)throw new Error("Failed to fetch entities");return{entities:await a.json(),totalCount:parseInt(a.headers.get("X-WP-Total")||"0",10),totalPages:parseInt(a.headers.get("X-WP-TotalPages")||"1",10)}})({page:t.pageIndex+1,pageSize:t.pageSize,filters:o,sorting:n}),keepPreviousData:!0,staleTime:3e4}),N=ws({mutationFn:Wn,onMutate:async({id:s,data:r})=>{await e.cancelQueries({queryKey:["entities"]});const a=e.getQueryData(["entities",t,o,n]);return e.setQueryData(["entities",t,o,n],e=>e?{...e,entities:e.entities.map(e=>e.id===s?{...e,...r}:e)}:e),{previousData:a}},onError:(s,r,a)=>{a?.previousData&&e.setQueryData(["entities",t,o,n],a.previousData)},onSettled:()=>{e.invalidateQueries({queryKey:["entities"]})}}),C=ws({mutationFn:Hn,onSuccess:()=>{l({}),e.invalidateQueries({queryKey:["entities"]})}}),k=ws({mutationFn:$n,onSuccess:()=>{l({}),e.invalidateQueries({queryKey:["entities"]})}}),S=(0,a.useMemo)(()=>v?.entities?Object.keys(i).filter(e=>i[e]).map(e=>v.entities[parseInt(e,10)]?.id).filter(Boolean):[],[i,v?.entities]),R=(0,a.useMemo)(()=>v?.entities?Object.keys(i).filter(e=>i[e]).map(e=>v.entities[parseInt(e,10)]).filter(Boolean):[],[i,v?.entities]),L=(0,a.useCallback)(e=>{m(e),p(!0)},[]),M=(0,a.useCallback)((e,t,s)=>{N.mutate({id:e,data:{[t]:s}}),f(null)},[N]),P=(0,a.useCallback)(()=>{0!==S.length&&window.confirm(`Are you sure you want to delete ${S.length} entities? This action cannot be undone.`)&&C.mutate(S)},[S,C]),_=(0,a.useCallback)(e=>{0!==S.length&&k.mutate({ids:S,status:e})},[S,k]),I=(0,a.useCallback)(()=>{S.length<2||u(!0)},[S]),F=(0,a.useCallback)(e=>{c(e),s(e=>({...e,pageIndex:0}))},[]),E=(0,a.useCallback)(()=>{c({search:"",types:[],statuses:[]}),s(e=>({...e,pageIndex:0}))},[]),O=(0,a.useCallback)(()=>{p(!1),m(null)},[]),A=(0,a.useCallback)(()=>{u(!1),l({}),e.invalidateQueries({queryKey:["entities"]})},[e]);return b?(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,yt.jsx)("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,yt.jsx)("span",{className:"text-sm text-gray-500",children:"Loading entities..."})]})}):y?(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:(0,yt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,yt.jsx)("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-medium text-red-800",children:"Failed to load entities"}),(0,yt.jsx)("p",{className:"text-sm text-red-600 mt-1",children:j?.message||"An unexpected error occurred"}),(0,yt.jsx)("button",{onClick:()=>e.invalidateQueries({queryKey:["entities"]}),className:"mt-3 text-sm text-red-700 hover:text-red-800 underline",children:"Try again"})]})]})})}):(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Entity Manager"}),(0,yt.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Manage your semantic entities - ",v?.totalCount||0," total entities"]})]}),w&&!b&&(0,yt.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,yt.jsx)("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),"Refreshing..."]})]}),(0,yt.jsx)(Sn,{filters:o,onChange:F,onClear:E}),(0,yt.jsx)(Cn,{selectedCount:S.length,onMerge:I,onDelete:P,onStatusChange:_,isDeleting:C.isLoading,isUpdating:k.isLoading}),(0,yt.jsx)(Nn,{data:v?.entities||[],totalCount:v?.totalCount||0,totalPages:v?.totalPages||1,pagination:t,onPaginationChange:s,sorting:n,onSortingChange:r,rowSelection:i,onRowSelectionChange:l,onEntityClick:L,onInlineEdit:M,editingCell:x,onEditingCellChange:f}),(0,yt.jsx)(Ln,{isOpen:d,onClose:()=>u(!1),entities:R,onMergeComplete:A}),(0,yt.jsx)(Bn,{isOpen:g,onClose:O,entityId:h})]})}const Gn=[{value:"anthropic/claude-opus-4.5",label:"Claude Opus 4.5",description:"Most capable model - highest accuracy (Recommended)",tier:"premium"},{value:"anthropic/claude-sonnet-4",label:"Claude Sonnet 4",description:"Fast and intelligent (Standard)",tier:"standard"},{value:"anthropic/claude-3.5-sonnet",label:"Claude 3.5 Sonnet",description:"Previous generation (Legacy)",tier:"standard"}],Kn=async()=>{const e=await fetch(`${window.vibeAI?.restUrl||"/wp-json/"}vibe-ai/v1/settings`,{headers:{"X-WP-Nonce":window.vibeAI?.nonce||""}});if(!e.ok)throw new Error("Failed to fetch settings");return e.json()},Xn=async e=>{const t=await fetch(`${window.vibeAI?.restUrl||"/wp-json/"}vibe-ai/v1/settings`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.vibeAI?.nonce||""},body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to save settings");return t.json()};function Jn({id:e,label:t,value:s,min:n,max:r,step:a,onChange:i,helpText:l,displayValue:o}){return(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsx)("label",{htmlFor:e,className:"block text-sm font-medium text-gray-700",children:t}),(0,yt.jsx)("span",{className:"text-sm font-semibold text-blue-600",children:o||s})]}),(0,yt.jsx)("input",{id:e,type:"range",value:s,min:n,max:r,step:a,onChange:e=>i(parseFloat(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"}),l&&(0,yt.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:l})]})}function Yn({postTypes:e,selected:t,onChange:s}){return(0,yt.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,yt.jsxs)("label",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors",children:[(0,yt.jsx)("input",{type:"checkbox",checked:t.includes(e.name),onChange:()=>(e=>{const n=t.includes(e)?t.filter(t=>t!==e):[...t,e];s(n)})(e.name),className:"mt-0.5 w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.label}),void 0!==e.count&&(0,yt.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",e.count," items)"]}),e.description&&(0,yt.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:e.description})]})]},e.name))})}function Zn(){const e=wt(),[t,s]=(0,a.useState)(null),[n,r]=(0,a.useState)(!1),{data:i,isLoading:l,isError:o,error:c}=ys({queryKey:["settings"],queryFn:Kn});(0,a.useEffect)(()=>{i&&(s({ai_model:i.ai_model||"anthropic/claude-opus-4.5",batch_size:i.batch_size||25,confidence_threshold:i.confidence_threshold||.6,post_types:i.post_types||["post","page","product","attachment"]}),r(!1))},[i]);const d=ws({mutationFn:Xn,onSuccess:()=>{e.invalidateQueries({queryKey:["settings"]}),r(!1)}}),u=(0,a.useCallback)((e,t)=>{s(s=>{if(!s)return s;const n={...s,[e]:t};return r(!0),n})},[]),h=(0,a.useCallback)(()=>{t&&d.mutate(t)},[t,d]);return l?(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,yt.jsx)("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,yt.jsx)("span",{className:"text-sm text-gray-500",children:"Loading settings..."})]})}):o?(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:(0,yt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,yt.jsx)("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-medium text-red-800",children:"Failed to load settings"}),(0,yt.jsx)("p",{className:"text-sm text-red-600 mt-1",children:c?.message})]})]})})}):t?(0,yt.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,yt.jsxs)("div",{className:"mb-8",children:[(0,yt.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Settings"}),(0,yt.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Configure the AI Entity Index plugin settings"})]}),(0,yt.jsxs)("div",{className:"space-y-8",children:[(0,yt.jsxs)("section",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,yt.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:[(0,yt.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"API Settings"}),(0,yt.jsx)("p",{className:"text-sm text-gray-500 mt-0.5",children:"Configure the AI model used for entity extraction"})]}),(0,yt.jsxs)("div",{className:"px-6 py-6",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{htmlFor:"ai-model",className:"block text-sm font-medium text-gray-700 mb-3",children:"AI Model"}),(0,yt.jsx)("div",{className:"space-y-2",children:Gn.map(e=>(0,yt.jsxs)("label",{className:`\n                                            flex items-start gap-3 p-4 rounded-lg border cursor-pointer transition-colors\n                                            ${t.ai_model===e.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}\n                                        `,children:[(0,yt.jsx)("input",{type:"radio",name:"ai-model",value:e.value,checked:t.ai_model===e.value,onChange:()=>u("ai_model",e.value),className:"mt-0.5 w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("span",{className:"font-medium text-gray-900",children:e.label}),(0,yt.jsx)("span",{className:`\n                                                    inline-flex items-center px-2 py-0.5 rounded text-xs font-medium\n                                                    ${"premium"===e.tier?"bg-purple-100 text-purple-700":""}\n                                                    ${"standard"===e.tier?"bg-blue-100 text-blue-700":""}\n                                                    ${"budget"===e.tier?"bg-green-100 text-green-700":""}\n                                                `,children:e.tier})]}),(0,yt.jsx)("p",{className:"text-sm text-gray-500 mt-0.5",children:e.description})]})]},e.value))})]}),(0,yt.jsx)("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:(0,yt.jsxs)("div",{className:"flex items-start gap-2",children:[(0,yt.jsx)("svg",{className:"w-5 h-5 text-amber-500 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,yt.jsxs)("div",{className:"text-sm text-amber-800",children:[(0,yt.jsx)("strong",{children:"Note:"})," API key must be configured in wp-config.php as"," ",(0,yt.jsx)("code",{className:"bg-amber-100 px-1 rounded",children:"VIBE_AI_OPENROUTER_KEY"})]})]})})]})]}),(0,yt.jsxs)("section",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,yt.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:[(0,yt.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Processing Settings"}),(0,yt.jsx)("p",{className:"text-sm text-gray-500 mt-0.5",children:"Adjust batch processing and quality thresholds"})]}),(0,yt.jsxs)("div",{className:"px-6 py-6 space-y-6",children:[(0,yt.jsx)(Jn,{id:"batch-size",label:"Batch Size",value:t.batch_size,min:5,max:50,step:5,onChange:e=>u("batch_size",e),displayValue:`${t.batch_size} posts/batch`,helpText:"Number of posts to process in each batch. Higher values are faster but may hit rate limits."}),(0,yt.jsx)(Jn,{id:"confidence-threshold",label:"Confidence Threshold",value:t.confidence_threshold,min:.4,max:.95,step:.05,onChange:e=>u("confidence_threshold",e),displayValue:`${Math.round(100*t.confidence_threshold)}%`,helpText:"Minimum confidence score for entities to be included in Schema.org output."}),(0,yt.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,yt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Confidence Tiers"}),(0,yt.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[(0,yt.jsxs)("div",{className:"p-2 bg-green-100 rounded text-green-700",children:[(0,yt.jsx)("strong",{children:"High (85-100%)"}),(0,yt.jsx)("br",{}),"Auto-approve"]}),(0,yt.jsxs)("div",{className:"p-2 bg-yellow-100 rounded text-yellow-700",children:[(0,yt.jsx)("strong",{children:"Medium (60-84%)"}),(0,yt.jsx)("br",{}),"Flag for review"]}),(0,yt.jsxs)("div",{className:"p-2 bg-red-100 rounded text-red-700",children:[(0,yt.jsx)("strong",{children:"Low (40-59%)"}),(0,yt.jsx)("br",{}),"Exclude from Schema"]})]})]})]})]}),(0,yt.jsxs)("section",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,yt.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:[(0,yt.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Post Types"}),(0,yt.jsx)("p",{className:"text-sm text-gray-500 mt-0.5",children:"Select which post types should be processed for entity extraction"})]}),(0,yt.jsxs)("div",{className:"px-6 py-6",children:[(0,yt.jsx)(Yn,{postTypes:i?.available_post_types||[{name:"post",label:"Posts",description:"Standard blog posts"},{name:"page",label:"Pages",description:"Static pages"}],selected:t.post_types,onChange:e=>u("post_types",e)}),0===t.post_types.length&&(0,yt.jsx)("div",{className:"mt-3 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:(0,yt.jsxs)("p",{className:"text-sm text-amber-800",children:[(0,yt.jsx)("strong",{children:"Warning:"})," No post types selected. Entity extraction will not process any content."]})})]})]}),(0,yt.jsxs)("div",{className:"flex items-center justify-between py-4",children:[(0,yt.jsxs)("div",{children:[n&&(0,yt.jsxs)("span",{className:"text-sm text-amber-600 flex items-center gap-1",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"You have unsaved changes"]}),d.isSuccess&&!n&&(0,yt.jsxs)("span",{className:"text-sm text-green-600 flex items-center gap-1",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Settings saved successfully"]}),d.isError&&(0,yt.jsxs)("span",{className:"text-sm text-red-600 flex items-center gap-1",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),d.error?.message||"Failed to save settings"]})]}),(0,yt.jsx)("button",{onClick:h,disabled:!n||d.isLoading,className:"inline-flex items-center gap-2 px-6 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d.isLoading?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,yt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,yt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save Settings"]})})]})]})]}):null}const er=[{value:"all",label:"All Levels",color:"bg-gray-100 text-gray-700"},{value:"info",label:"INFO",color:"bg-blue-100 text-blue-700"},{value:"warn",label:"WARN",color:"bg-yellow-100 text-yellow-700"},{value:"error",label:"ERROR",color:"bg-red-100 text-red-700"},{value:"api",label:"API",color:"bg-purple-100 text-purple-700"}];function tr({level:e}){const t=er.find(t=>t.value===e.toLowerCase())||er[0];return(0,yt.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${t.color}`,children:e.toUpperCase()})}function sr({log:e,isExpanded:t,onToggle:s}){const n=e.context&&Object.keys(e.context).length>0;return(0,yt.jsxs)("div",{className:`\n                border rounded-lg overflow-hidden transition-colors\n                ${"error"===e.level?"border-red-200 bg-red-50":""}\n                ${"warn"===e.level?"border-yellow-200 bg-yellow-50":""}\n                ${"error"!==e.level&&"warn"!==e.level?"border-gray-200 bg-white":""}\n            `,children:[(0,yt.jsxs)("button",{onClick:s,className:"w-full px-4 py-3 flex items-start gap-3 text-left hover:bg-opacity-80 transition-colors",children:[n&&(0,yt.jsx)("svg",{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0 transition-transform "+(t?"rotate-90":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),!n&&(0,yt.jsx)("div",{className:"w-4"}),(0,yt.jsx)("span",{className:"text-xs text-gray-400 font-mono flex-shrink-0 mt-0.5",children:new Date(e.timestamp).toLocaleTimeString()}),(0,yt.jsx)(tr,{level:e.level}),(0,yt.jsx)("span",{className:"text-sm text-gray-700 flex-1",children:e.message})]}),t&&n&&(0,yt.jsx)("div",{className:"px-4 pb-4 pt-0",children:(0,yt.jsx)("div",{className:"ml-8 p-3 bg-gray-800 rounded-lg overflow-x-auto",children:(0,yt.jsx)("pre",{className:"text-xs text-gray-300 font-mono whitespace-pre-wrap",children:JSON.stringify(e.context,null,2)})})})]})}function nr({value:e,onChange:t}){const s=(new Date).toISOString().split("T")[0];return(0,yt.jsx)("input",{type:"date",value:e||"",max:s,onChange:e=>t(e.target.value||null),className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}function rr(){const[e,t]=(0,a.useState)(1),[s,n]=(0,a.useState)(50),[r,i]=(0,a.useState)("all"),[l,o]=(0,a.useState)(null),[c,d]=(0,a.useState)(new Set),{data:u,isLoading:h,isError:m,error:g,isFetching:p}=ys({queryKey:["activity-logs",e,s,r,l],queryFn:()=>(async({page:e,pageSize:t,level:s,date:n})=>{const r=new URLSearchParams({page:e.toString(),per_page:t.toString(),...s&&"all"!==s&&{level:s},...n&&{date:n}}),a=await fetch(`${window.vibeAI?.restUrl||"/wp-json/"}vibe-ai/v1/logs?${r}`,{headers:{"X-WP-Nonce":window.vibeAI?.nonce||""}});if(!a.ok)throw new Error("Failed to fetch logs");return{logs:await a.json(),totalCount:parseInt(a.headers.get("X-WP-Total")||"0",10),totalPages:parseInt(a.headers.get("X-WP-TotalPages")||"1",10)}})({page:e,pageSize:s,level:r,date:l}),keepPreviousData:!0,staleTime:3e4,refetchInterval:6e4}),x=(0,a.useCallback)(e=>{d(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),f=(0,a.useCallback)(e=>{i(e),t(1)},[]),v=(0,a.useCallback)(e=>{o(e),t(1)},[]),b=(0,a.useCallback)(()=>{i("all"),o(null),t(1)},[]),y=(0,a.useMemo)(()=>u?.logs?u.logs.reduce((e,t)=>("info"===t.level||"api"===t.level?e.info++:"warn"===t.level?e.warn++:"error"===t.level&&e.error++,e),{info:0,warn:0,error:0}):{info:0,warn:0,error:0},[u?.logs]);return h?(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,yt.jsx)("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,yt.jsx)("span",{className:"text-sm text-gray-500",children:"Loading logs..."})]})}):m?(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:(0,yt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,yt.jsx)("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-medium text-red-800",children:"Failed to load logs"}),(0,yt.jsx)("p",{className:"text-sm text-red-600 mt-1",children:g?.message})]})]})})}):(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Activity Log"}),(0,yt.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Historical job execution and system events"})]}),p&&!h&&(0,yt.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,yt.jsx)("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),"Refreshing..."]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,yt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("span",{className:"text-sm font-medium text-blue-700",children:"Info/API"}),(0,yt.jsx)("span",{className:"text-2xl font-bold text-blue-900",children:y.info})]})}),(0,yt.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("span",{className:"text-sm font-medium text-yellow-700",children:"Warnings"}),(0,yt.jsx)("span",{className:"text-2xl font-bold text-yellow-900",children:y.warn})]})}),(0,yt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("span",{className:"text-sm font-medium text-red-700",children:"Errors"}),(0,yt.jsx)("span",{className:"text-2xl font-bold text-red-900",children:y.error})]})})]}),(0,yt.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,yt.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Level:"}),(0,yt.jsx)("select",{value:r,onChange:e=>f(e.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:er.map(e=>(0,yt.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Date:"}),(0,yt.jsx)(nr,{value:l,onChange:v})]}),("all"!==r||l)&&(0,yt.jsxs)("button",{onClick:b,className:"inline-flex items-center gap-1.5 px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear filters"]}),(0,yt.jsxs)("span",{className:"text-sm text-gray-500 ml-auto",children:[u?.totalCount||0," entries"]})]})}),0===u?.logs?.length?(0,yt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[(0,yt.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,yt.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No logs found"}),(0,yt.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"all"!==r||l?"Try adjusting your filters":"Activity logs will appear here as the pipeline processes content"})]}):(0,yt.jsx)("div",{className:"space-y-2",children:u?.logs?.map(e=>(0,yt.jsx)(sr,{log:e,isExpanded:c.has(e.id),onToggle:()=>x(e.id)},e.id))}),u?.totalPages>1&&(0,yt.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 px-4 py-3",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,yt.jsxs)("span",{children:["Page ",e," of ",u.totalPages]}),(0,yt.jsx)("select",{value:s,onChange:e=>{n(Number(e.target.value)),t(1)},className:"px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:[25,50,100].map(e=>(0,yt.jsxs)("option",{value:e,children:[e," per page"]},e))})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-1",children:[(0,yt.jsx)("button",{onClick:()=>t(1),disabled:1===e,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),(0,yt.jsx)("button",{onClick:()=>t(e=>Math.max(1,e-1)),disabled:1===e,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,yt.jsx)("button",{onClick:()=>t(e=>Math.min(u.totalPages,e+1)),disabled:e>=u.totalPages,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),(0,yt.jsx)("button",{onClick:()=>t(u.totalPages),disabled:e>=u.totalPages,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})})]})]})})]})}const ar=()=>{const e=window.vibeAiData||{};return{apiUrl:e.apiUrl||"/wp-json/vibe-ai/v1",nonce:e.nonce||""}};async function ir(e,t={}){const s=ar(),n=`${s.apiUrl}${e}`,r={"Content-Type":"application/json","X-WP-Nonce":s.nonce,...t.headers},a=await fetch(n,{...t,headers:r,credentials:"same-origin"});if(!a.ok){const e=await a.json().catch(()=>({})),t=new Error(e.message||`API Error: ${a.status}`);throw t.status=a.status,t}return a.json()}const lr=(e,t={})=>{const s=new URLSearchParams(Object.entries(t).filter(([,e])=>null!=e&&""!==e)).toString();return ir(s?`${e}?${s}`:e)},or=(e,t={})=>ir(e,{method:"POST",body:JSON.stringify(t)});function cr(){const e=wt();return ws({mutationFn:(e={})=>or("/kb/reindex",e),onSuccess:()=>{e.invalidateQueries(["kb-status"]),e.invalidateQueries(["kb-docs"])}})}const dr=()=>(0,yt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),ur=()=>(0,yt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})}),hr=()=>(0,yt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),mr=()=>(0,yt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),gr=()=>(0,yt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),pr=()=>(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})});function xr(e){return e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e?.toLocaleString()||"0"}function fr(e){if(!e)return"Never";const t=new Date(e),s=new Date,n=Math.floor((s-t)/1e3);return n<60?"Just now":n<3600?`${Math.floor(n/60)}m ago`:n<86400?`${Math.floor(n/3600)}h ago`:n<604800?`${Math.floor(n/86400)}d ago`:t.toLocaleDateString()}function vr({stats:e={},loading:t=!1}){const s=[{label:"Total Documents",value:xr(e.total_docs||0),icon:(0,yt.jsx)(dr,{}),color:"text-wp-primary",bgColor:"bg-wp-primary/10"},{label:"Total Chunks",value:xr(e.total_chunks||0),icon:(0,yt.jsx)(ur,{}),color:"text-blue-600",bgColor:"bg-blue-100"},{label:"Indexed",value:xr(e.indexed||0),icon:(0,yt.jsx)(hr,{}),color:"text-green-600",bgColor:"bg-green-100"},{label:"Failed",value:xr(e.failed||0),icon:(0,yt.jsx)(mr,{}),color:"text-red-600",bgColor:"bg-red-100"},{label:"Last Run",value:fr(e.last_run),icon:(0,yt.jsx)(gr,{}),color:"text-slate-600",bgColor:"bg-slate-100"}];return(0,yt.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:s.map(e=>(0,yt.jsx)(Tt,{className:"relative overflow-hidden",children:(0,yt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("p",{className:"text-sm font-medium text-slate-500",children:e.label}),t?(0,yt.jsx)("div",{className:"h-8 w-20 bg-slate-200 animate-pulse rounded mt-1"}):(0,yt.jsx)("p",{className:"mt-1 text-2xl font-bold text-slate-900",children:e.value})]}),(0,yt.jsx)("div",{className:`flex-shrink-0 p-2.5 rounded-lg ${e.bgColor} ${e.color}`,children:e.icon})]})},e.label))})}function br({activity:e=[]}){return e&&0!==e.length?(0,yt.jsx)("div",{className:"divide-y divide-slate-200",children:e.slice(0,10).map((e,t)=>(0,yt.jsxs)("div",{className:"py-3 flex items-center gap-3",children:[(0,yt.jsx)("div",{className:`\n              w-2 h-2 rounded-full flex-shrink-0\n              ${"indexed"===e.type?"bg-green-500":""}\n              ${"error"===e.type?"bg-red-500":""}\n              ${"pending"===e.type?"bg-yellow-500":""}\n              ${["indexed","error","pending"].includes(e.type)?"":"bg-slate-400"}\n            `}),(0,yt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,yt.jsx)("p",{className:"text-sm text-slate-700 truncate",children:e.title}),(0,yt.jsx)("p",{className:"text-xs text-slate-500",children:e.message})]}),(0,yt.jsx)("span",{className:"text-xs text-slate-400 flex-shrink-0",children:fr(e.timestamp)})]},e.id||t))}):(0,yt.jsxs)("div",{className:"text-center py-8 text-slate-500",children:[(0,yt.jsx)(dr,{className:"mx-auto w-12 h-12 text-slate-300 mb-3"}),(0,yt.jsx)("p",{children:"No recent activity"})]})}function yr({vibeAiData:e}){const t=Y(),{data:s,isLoading:n,error:r,refetch:i}=ys({queryKey:["kb-status"],queryFn:()=>lr("/kb/status"),refetchInterval:e=>!!e?.pipeline?.running&&2e3,staleTime:1e3}),l=cr(),o=s?.pipeline?.running||!1,c=s?.stats||{},d=s?.recent_activity||[],u=(0,a.useCallback)(async()=>{try{await l.mutateAsync({full:!0}),i()}catch(e){}},[l,i]);return(0,yt.jsxs)("div",{className:"p-6 space-y-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Knowledge Base"}),(0,yt.jsx)("p",{className:"mt-1 text-slate-500",children:"Manage document indexing for AI-powered search"})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,yt.jsx)(Ut,{variant:"ghost",size:"sm",onClick:()=>i(),leftIcon:(0,yt.jsx)(pr,{}),children:"Refresh"}),(0,yt.jsx)(Ut,{variant:"primary",onClick:u,loading:l.isLoading,disabled:o,children:o?"Indexing...":"Reindex All"})]})]}),r&&(0,yt.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,yt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,yt.jsx)("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,yt.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-medium text-red-800",children:"Error"}),(0,yt.jsx)("p",{className:"text-sm text-red-600 mt-1",children:r.message||"Failed to load KB status"})]})]})}),(0,yt.jsx)(vr,{stats:c,loading:n}),(0,yt.jsxs)(Tt,{padding:"lg",children:[(0,yt.jsx)(Tt.Header,{title:"Pipeline Status",subtitle:o?`Processing: ${s?.pipeline?.current_item||"Initializing..."}`:"Pipeline is idle",action:(0,yt.jsx)(St.Status,{status:o?"processing":s?.pipeline?.error?"error":"inactive"})}),(0,yt.jsx)(Tt.Body,{children:(0,yt.jsx)(Yt,{progress:s?.pipeline?.progress||0,isRunning:o,startedAt:s?.pipeline?.started_at,label:o?`${s?.pipeline?.processed_items||0} / ${s?.pipeline?.total_items||0} documents processed`:"Ready to index",showPercentage:!0,showEta:o})})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,yt.jsxs)(Tt,{padding:"lg",children:[(0,yt.jsx)(Tt.Header,{title:"Quick Actions"}),(0,yt.jsx)(Tt.Body,{children:(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,yt.jsxs)("button",{onClick:()=>t("/kb/documents"),className:"flex flex-col items-center gap-2 p-4 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[(0,yt.jsx)(dr,{}),(0,yt.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Browse Documents"})]}),(0,yt.jsxs)("button",{onClick:()=>t("/kb/search"),className:"flex flex-col items-center gap-2 p-4 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[(0,yt.jsx)("svg",{className:"w-6 h-6 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),(0,yt.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Test Search"})]}),(0,yt.jsxs)("button",{onClick:()=>t("/kb/settings"),className:"flex flex-col items-center gap-2 p-4 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[(0,yt.jsxs)("svg",{className:"w-6 h-6 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,yt.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"KB Settings"})]}),(0,yt.jsxs)("button",{onClick:()=>t("/kb/logs"),className:"flex flex-col items-center gap-2 p-4 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[(0,yt.jsx)("svg",{className:"w-6 h-6 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,yt.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"View Logs"})]})]})})]}),(0,yt.jsxs)(Tt,{padding:"lg",children:[(0,yt.jsx)(Tt.Header,{title:"Recent Activity",action:(0,yt.jsx)("button",{onClick:()=>t("/kb/logs"),className:"text-sm text-wp-primary hover:text-wp-primary-hover",children:"View all"})}),(0,yt.jsx)(Tt.Body,{children:(0,yt.jsx)(br,{activity:d})})]})]})]})}function jr({chunk:e,index:t,isExpanded:s,onToggleExpand:n}){const[r,i]=(0,a.useState)(!1),l=(0,a.useCallback)(async()=>{e.anchor&&await async function(e){try{return await navigator.clipboard.writeText(e),!0}catch{return!1}}(e.anchor)&&(i(!0),setTimeout(()=>i(!1),2e3))},[e.anchor]);return(0,yt.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden bg-white",children:[(0,yt.jsx)("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,yt.jsx)("span",{className:"inline-flex items-center justify-center w-6 h-6 text-xs font-semibold text-gray-600 bg-gray-200 rounded-full",children:t+1}),e.heading_path&&e.heading_path.length>0&&(0,yt.jsx)("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:e.heading_path.map((e,t)=>(0,yt.jsxs)("span",{className:"flex items-center",children:[t>0&&(0,yt.jsx)("span",{className:"mx-1 text-gray-400",children:"/"}),(0,yt.jsx)("span",{children:e})]},t))})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,yt.jsxs)("span",{className:"text-xs text-gray-500",children:["~",e.token_count||0," tokens"]}),e.has_vector?(0,yt.jsxs)(St,{variant:"success",size:"sm",children:[(0,yt.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,yt.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Vector"]}):(0,yt.jsxs)(St,{variant:"warning",size:"sm",children:[(0,yt.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,yt.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),"No Vector"]})]})]})}),(0,yt.jsxs)("div",{className:"px-4 py-3",children:[e.anchor&&(0,yt.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,yt.jsx)("span",{className:"text-xs text-gray-500",children:"Anchor:"}),(0,yt.jsxs)("code",{className:"px-2 py-0.5 text-xs font-mono bg-gray-100 rounded",children:["#",e.anchor]}),(0,yt.jsx)("button",{onClick:l,className:"text-gray-400 hover:text-gray-600",title:"Copy anchor",children:r?(0,yt.jsx)("svg",{className:"w-4 h-4 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),(0,yt.jsx)("div",{className:"text-sm text-gray-700 leading-relaxed",children:s?(0,yt.jsx)("p",{className:"whitespace-pre-wrap",children:e.text}):(0,yt.jsx)("p",{children:e.text?.length>300?e.text.substring(0,300).trim()+"...":e.text})}),e.text?.length>300&&(0,yt.jsx)("button",{onClick:n,className:"mt-2 text-sm text-blue-600 hover:text-blue-800",children:s?"Show less":"Expand"})]})]})}function wr({doc:e,onClose:t,onReindex:s}){const[n,r]=(0,a.useState)(new Set),{data:i,isLoading:l,isError:o,error:c,refetch:d}=ys({queryKey:["kb-doc-chunks",e.post_id],queryFn:()=>(async e=>{const t=await fetch(`${window.vibeAiData?.apiUrl||"/wp-json/vibe-ai/v1"}/kb/docs/${e}`,{headers:{"X-WP-Nonce":window.vibeAiData?.nonce||""}});if(!t.ok)throw new Error("Failed to fetch document chunks");return t.json()})(e.post_id),enabled:!!e.post_id});(0,a.useEffect)(()=>{const e=e=>{"Escape"===e.key&&t()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t]),(0,a.useEffect)(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]);const u=(0,a.useCallback)(e=>{r(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),h=(0,a.useCallback)(()=>{s&&s(e.post_id)},[e.post_id,s]),m=i?.chunks||[];return(0,yt.jsxs)("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[(0,yt.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),(0,yt.jsxs)("div",{className:"absolute right-0 top-0 bottom-0 w-full max-w-2xl bg-white shadow-xl flex flex-col",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 bg-white",children:[(0,yt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,yt.jsx)("h2",{className:"text-lg font-semibold text-gray-900 truncate",children:e.title}),(0,yt.jsxs)("p",{className:"text-sm text-gray-500 mt-0.5",children:[m.length," chunk",1!==m.length?"s":""," indexed"]})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-3 ml-4",children:[(0,yt.jsx)(Ut,{variant:"secondary",size:"sm",onClick:h,children:"Reindex Chunks"}),(0,yt.jsx)("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),(0,yt.jsx)("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:l?(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,yt.jsx)("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,yt.jsx)("span",{className:"text-sm text-gray-500",children:"Loading chunks..."})]})}):o?(0,yt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,yt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,yt.jsx)("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-medium text-red-800",children:"Failed to load chunks"}),(0,yt.jsx)("p",{className:"text-sm text-red-600 mt-1",children:c?.message}),(0,yt.jsx)("button",{onClick:()=>d(),className:"mt-2 text-sm text-red-700 hover:text-red-800 underline",children:"Try again"})]})]})}):0===m.length?(0,yt.jsxs)("div",{className:"text-center py-12",children:[(0,yt.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,yt.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No chunks found"}),(0,yt.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"This document has not been chunked yet. Try reindexing."}),(0,yt.jsx)(Ut,{variant:"primary",size:"sm",className:"mt-4",onClick:h,children:"Reindex Document"})]}):(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,yt.jsxs)("span",{className:"text-sm text-gray-600",children:["Total: ",m.length," chunks, ~",m.reduce((e,t)=>e+(t.token_count||0),0)," tokens"]}),(0,yt.jsx)("div",{className:"flex items-center gap-2",children:(0,yt.jsxs)("span",{className:"text-sm text-gray-500",children:[m.filter(e=>e.has_vector).length," with vectors"]})})]}),m.map((e,t)=>(0,yt.jsx)(jr,{chunk:e,index:t,isExpanded:n.has(t),onToggleExpand:()=>u(t)},e.id||t))]})}),(0,yt.jsx)("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 inline-flex items-center gap-1",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"View Original"]}),(0,yt.jsx)(Ut,{variant:"secondary",onClick:t,children:"Close"})]})})]})]})}const Nr={indexed:{variant:"success",label:"Indexed"},pending:{variant:"warning",label:"Pending"},error:{variant:"error",label:"Error"},excluded:{variant:"default",label:"Excluded"}},Cr=[{value:"",label:"All Types"},{value:"post",label:"Posts"},{value:"page",label:"Pages"},{value:"product",label:"Products"},{value:"article",label:"Articles"}],kr=[{value:"",label:"All Statuses"},{value:"indexed",label:"Indexed"},{value:"pending",label:"Pending"},{value:"error",label:"Error"},{value:"excluded",label:"Excluded"}];function Sr({indeterminate:e,checked:t,onChange:s,...n}){const r=(0,a.useRef)(null);return(0,a.useEffect)(()=>{"boolean"==typeof e&&r.current&&(r.current.indeterminate=!t&&e)},[e,t]),(0,yt.jsx)("input",{type:"checkbox",ref:r,checked:t,onChange:s,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",...n})}function Rr({status:e}){const t=Nr[e]||Nr.pending;return(0,yt.jsx)(St,{variant:t.variant,dot:!0,children:t.label})}function Lr({doc:e,onReindex:t,onToggleExclude:s,onViewChunks:n}){const[r,i]=(0,a.useState)(!1),l=(0,a.useRef)(null);return(0,a.useEffect)(()=>{const e=e=>{l.current&&!l.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,yt.jsxs)("div",{className:"relative",ref:l,children:[(0,yt.jsx)("button",{onClick:()=>i(!r),className:"p-1 rounded hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,yt.jsx)("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})})}),r&&(0,yt.jsxs)("div",{className:"absolute right-0 mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10",children:[(0,yt.jsx)("button",{onClick:()=>{t(e.post_id),i(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100",children:"Reindex"}),(0,yt.jsx)("button",{onClick:()=>{s(e.post_id),i(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100",children:"excluded"===e.status?"Include":"Exclude"}),(0,yt.jsx)("button",{onClick:()=>{n(e),i(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100",children:"View Chunks"})]})]})}function Mr({vibeAiData:e}){const[t,s]=(0,a.useState)({pageIndex:0,pageSize:25}),[n,r]=(0,a.useState)({}),[i,l]=(0,a.useState)({search:"",post_type:"",status:""}),[o,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!1),{data:h,isLoading:m,isError:g,error:p,isFetching:x,refetch:f}=function(e,t,s={}){return ys({queryKey:["kb-docs",e,t,s],queryFn:async()=>{const n=ar(),r=new URLSearchParams({page:e.toString(),per_page:t.toString(),...s.search&&{search:s.search},...s.post_type&&{post_type:s.post_type},...s.status&&{status:s.status}}),a=await fetch(`${n.apiUrl}/kb/docs?${r}`,{headers:{"X-WP-Nonce":n.nonce},credentials:"same-origin"});if(!a.ok)throw new Error("Failed to fetch documents");return{docs:await a.json(),total_count:parseInt(a.headers.get("X-WP-Total")||"0",10),total_pages:parseInt(a.headers.get("X-WP-TotalPages")||"1",10)}},keepPreviousData:!0,staleTime:3e4})}(t.pageIndex+1,t.pageSize,i),v=cr(),[b,y]=(0,a.useState)("");(0,a.useEffect)(()=>{const e=setTimeout(()=>{l(e=>({...e,search:b})),s(e=>({...e,pageIndex:0}))},300);return()=>clearTimeout(e)},[b]);const j=(0,a.useCallback)(async e=>{try{await v.mutateAsync({post_ids:[e]}),f()}catch(e){}},[v,f]),w=(0,a.useCallback)(async e=>{console.log("Toggle exclude for:",e),f()},[f]),N=(0,a.useCallback)(e=>{c(e),u(!0)},[]),C=(0,a.useCallback)(async()=>{const e=Object.keys(n).filter(e=>n[e]).map(e=>h?.docs?.[parseInt(e,10)]?.post_id).filter(Boolean);if(0!==e.length)try{await v.mutateAsync({post_ids:e}),r({}),f()}catch(e){}},[n,h?.docs,v,f]),k=(0,a.useCallback)(async()=>{const e=Object.keys(n).filter(e=>n[e]).map(e=>h?.docs?.[parseInt(e,10)]?.post_id).filter(Boolean);0!==e.length&&(console.log("Bulk exclude:",e),r({}),f())},[n,h?.docs,f]),S=(0,a.useMemo)(()=>[{id:"select",header:({table:e})=>(0,yt.jsx)(Sr,{checked:e.getIsAllRowsSelected(),indeterminate:e.getIsSomeRowsSelected(),onChange:e.getToggleAllRowsSelectedHandler()}),cell:({row:e})=>(0,yt.jsx)(Sr,{checked:e.getIsSelected(),onChange:e.getToggleSelectedHandler()}),size:40},{accessorKey:"title",header:"Title",cell:({row:e})=>(0,yt.jsx)("div",{className:"max-w-xs",children:(0,yt.jsx)("a",{href:e.original.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-blue-600 hover:text-blue-800 hover:underline truncate block",children:e.original.title})}),size:250},{accessorKey:"post_type",header:"Type",cell:({row:e})=>(0,yt.jsx)("span",{className:"text-sm text-gray-600 capitalize",children:e.original.post_type}),size:100},{accessorKey:"status",header:"Status",cell:({row:e})=>(0,yt.jsx)(Rr,{status:e.original.status}),size:120},{accessorKey:"chunk_count",header:"Chunks",cell:({row:e})=>(0,yt.jsx)("span",{className:"inline-flex items-center justify-center min-w-[2rem] px-2 py-0.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-full",children:e.original.chunk_count||0}),size:80},{accessorKey:"last_indexed",header:"Last Indexed",cell:({row:e})=>{const t=e.original.last_indexed;return t?(0,yt.jsx)("span",{className:"text-sm text-gray-600",children:new Date(t).toLocaleDateString()}):(0,yt.jsx)("span",{className:"text-gray-400",children:"-"})},size:120},{id:"actions",header:"",cell:({row:e})=>(0,yt.jsx)(Lr,{doc:e.original,onReindex:j,onToggleExclude:w,onViewChunks:N}),size:60}],[j,w,N]),R=fn({data:h?.docs||[],columns:S,state:{rowSelection:n,pagination:t},pageCount:h?.total_pages||1,onRowSelectionChange:r,onPaginationChange:s,getCoreRowModel:pn(),manualPagination:!0,enableRowSelection:!0}),L=Object.keys(n).filter(e=>n[e]).length;return m?(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,yt.jsx)("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,yt.jsx)("span",{className:"text-sm text-gray-500",children:"Loading documents..."})]})}):g?(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:(0,yt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,yt.jsx)("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-medium text-red-800",children:"Failed to load documents"}),(0,yt.jsx)("p",{className:"text-sm text-red-600 mt-1",children:p?.message})]})]})})}):(0,yt.jsxs)("div",{className:"p-6 space-y-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Documents"}),(0,yt.jsxs)("p",{className:"mt-1 text-slate-500",children:["Manage documents in the Knowledge Base - ",h?.total_count||0," total"]})]}),x&&!m&&(0,yt.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,yt.jsx)("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),"Refreshing..."]})]}),(0,yt.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,yt.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,yt.jsx)("div",{className:"flex-1 min-w-[200px]",children:(0,yt.jsx)("input",{type:"text",placeholder:"Search documents...",value:b,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),(0,yt.jsx)("select",{value:i.post_type,onChange:e=>{l(t=>({...t,post_type:e.target.value})),s(e=>({...e,pageIndex:0}))},className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:Cr.map(e=>(0,yt.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,yt.jsx)("select",{value:i.status,onChange:e=>{l(t=>({...t,status:e.target.value})),s(e=>({...e,pageIndex:0}))},className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:kr.map(e=>(0,yt.jsx)("option",{value:e.value,children:e.label},e.value))}),(i.search||i.post_type||i.status)&&(0,yt.jsx)("button",{onClick:()=>{l({search:"",post_type:"",status:""}),y(""),s(e=>({...e,pageIndex:0}))},className:"text-sm text-gray-600 hover:text-gray-900",children:"Clear filters"})]})}),L>0&&(0,yt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("span",{className:"text-sm font-medium text-blue-700",children:[L," document",L>1?"s":""," selected"]}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)(Ut,{variant:"secondary",size:"sm",onClick:C,loading:v.isLoading,children:"Reindex Selected"}),(0,yt.jsx)(Ut,{variant:"secondary",size:"sm",onClick:k,children:"Exclude Selected"}),(0,yt.jsx)("button",{onClick:()=>r({}),className:"text-sm text-blue-600 hover:text-blue-800 ml-2",children:"Clear selection"})]})]})}),0===h?.docs?.length?(0,yt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[(0,yt.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,yt.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No documents found"}),(0,yt.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:i.search||i.post_type||i.status?"Try adjusting your filters":"Start by configuring post types in KB Settings"})]}):(0,yt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,yt.jsx)("div",{className:"overflow-x-auto",children:(0,yt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,yt.jsx)("thead",{className:"bg-gray-50",children:R.getHeaderGroups().map(e=>(0,yt.jsx)("tr",{children:e.headers.map(e=>(0,yt.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:e.getSize()},children:e.isPlaceholder?null:xn(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,yt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:R.getRowModel().rows.map(e=>(0,yt.jsx)("tr",{className:"hover:bg-gray-50",children:e.getVisibleCells().map(e=>(0,yt.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:xn(e.column.columnDef.cell,e.getContext())},e.id))},e.id))})]})}),(0,yt.jsx)("div",{className:"bg-gray-50 px-4 py-3 border-t border-gray-200",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:(0,yt.jsxs)("span",{children:["Showing ",t.pageIndex*t.pageSize+1," to"," ",Math.min((t.pageIndex+1)*t.pageSize,h?.total_count||0)," ","of ",h?.total_count||0," documents"]})}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("select",{value:t.pageSize,onChange:e=>s({pageIndex:0,pageSize:Number(e.target.value)}),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:[10,25,50,100].map(e=>(0,yt.jsxs)("option",{value:e,children:[e," per page"]},e))}),(0,yt.jsxs)("div",{className:"flex items-center gap-1",children:[(0,yt.jsx)("button",{onClick:()=>s(e=>({...e,pageIndex:0})),disabled:0===t.pageIndex,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),(0,yt.jsx)("button",{onClick:()=>s(e=>({...e,pageIndex:e.pageIndex-1})),disabled:0===t.pageIndex,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,yt.jsxs)("span",{className:"px-3 py-1 text-sm",children:["Page ",t.pageIndex+1," of ",h?.total_pages||1]}),(0,yt.jsx)("button",{onClick:()=>s(e=>({...e,pageIndex:e.pageIndex+1})),disabled:t.pageIndex>=(h?.total_pages||1)-1,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),(0,yt.jsx)("button",{onClick:()=>s(e=>({...e,pageIndex:(h?.total_pages||1)-1})),disabled:t.pageIndex>=(h?.total_pages||1)-1,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})})]})]})]})})]}),d&&o&&(0,yt.jsx)(wr,{doc:o,onClose:()=>{u(!1),c(null)},onReindex:j})]})}function Pr(e){return`${(100*e).toFixed(1)}%`}function _r(e,t=200){return!e||e.length<=t?e:e.substring(0,t).trim()+"..."}function Ir({path:e}){return e&&0!==e.length?(0,yt.jsx)("div",{className:"flex items-center gap-1 text-xs text-gray-500 flex-wrap",children:e.map((e,t)=>(0,yt.jsxs)("span",{className:"flex items-center",children:[t>0&&(0,yt.jsx)("svg",{className:"w-3 h-3 mx-1 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,yt.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),(0,yt.jsx)("span",{className:"text-gray-600",children:e})]},t))}):null}function Fr({result:e,onViewSource:t,isExpanded:s,onToggleExpand:n}){return(0,yt.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:border-gray-300 transition-colors",children:(0,yt.jsxs)("div",{className:"p-4",children:[(0,yt.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,yt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,yt.jsx)("h3",{className:"text-sm font-medium text-gray-900 truncate",children:e.title}),(0,yt.jsx)(Ir,{path:e.heading_path})]}),(0,yt.jsx)(St,{variant:(r=e.score,r>=.8?"success":r>=.6?"warning":"error"),size:"sm",children:Pr(e.score)})]}),(0,yt.jsx)("div",{className:"mt-3",children:(0,yt.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:s?e.text:_r(e.text,200)})}),(0,yt.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsxs)("button",{onClick:t,className:"inline-flex items-center gap-1 text-sm text-blue-600 hover:text-blue-800",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"View Source"]}),(0,yt.jsx)("button",{onClick:n,className:"text-sm text-gray-500 hover:text-gray-700",children:s?"Show less":"Show details"})]}),(0,yt.jsx)("span",{className:"text-xs text-gray-400",children:e.post_type})]}),s&&(0,yt.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-100",children:(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("span",{className:"text-gray-500",children:"Post ID:"}),(0,yt.jsx)("span",{className:"ml-2 text-gray-700",children:e.post_id})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("span",{className:"text-gray-500",children:"Chunk ID:"}),(0,yt.jsx)("span",{className:"ml-2 text-gray-700",children:e.chunk_id||"-"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("span",{className:"text-gray-500",children:"Anchor:"}),(0,yt.jsx)("span",{className:"ml-2 text-gray-700 font-mono",children:e.anchor||"-"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("span",{className:"text-gray-500",children:"Tokens:"}),(0,yt.jsx)("span",{className:"ml-2 text-gray-700",children:e.token_count||"-"})]})]})})]})});var r}function Er({hasQuery:e}){return(0,yt.jsxs)("div",{className:"text-center py-12",children:[(0,yt.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),(0,yt.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:e?"No results found":"Search your Knowledge Base"}),(0,yt.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:e?"Try adjusting your search query or filters":"Enter a search query to find relevant content chunks"})]})}function Or({vibeAiData:e}){const[t,s]=(0,a.useState)(""),[n,r]=(0,a.useState)(8),[i,l]=(0,a.useState)({post_type:"",date_from:"",date_to:""}),[o,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(null),[h,m]=(0,a.useState)(new Set),g=ws({mutationFn:({query:e,topK:t,filters:s})=>or("/kb/search",{query:e,top_k:t,filters:s})}),[p,x]=(0,a.useState)("");(0,a.useEffect)(()=>{const e=setTimeout(()=>{x(t)},500);return()=>clearTimeout(e)},[t]),(0,a.useEffect)(()=>{p.trim().length>=3&&f()},[p,n,i]);const f=(0,a.useCallback)(async()=>{if(!t.trim())return;const e=performance.now();try{const s=await g.mutateAsync({query:t.trim(),topK:n,filters:{...i.post_type&&{post_type:i.post_type},...i.date_from&&{date_from:i.date_from},...i.date_to&&{date_to:i.date_to}}});c(s.results||[]),u(Math.round(performance.now()-e)),m(new Set)}catch(e){c([])}},[t,n,i,g]),v=(0,a.useCallback)(e=>{const t=e.anchor?`${e.url}#${e.anchor}`:e.url;window.open(t,"_blank")},[]),b=(0,a.useCallback)(e=>{m(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),y=(0,a.useCallback)(()=>{s(""),c(null),u(null),m(new Set)},[]);return(0,yt.jsxs)("div",{className:"p-6 space-y-6",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Test Search"}),(0,yt.jsx)("p",{className:"mt-1 text-slate-500",children:"Test semantic search against your Knowledge Base"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 space-y-6",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{htmlFor:"search-query",className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Query"}),(0,yt.jsxs)("div",{className:"relative",children:[(0,yt.jsx)("input",{id:"search-query",type:"text",value:t,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key&&f()},placeholder:"Enter your search query...",className:"w-full px-4 py-3 text-lg border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),t&&(0,yt.jsx)("button",{onClick:y,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Results (Top-K): ",(0,yt.jsx)("span",{className:"text-blue-600 font-semibold",children:n})]}),(0,yt.jsx)("input",{type:"range",min:1,max:20,step:1,value:n,onChange:e=>r(parseInt(e.target.value,10)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Post Type"}),(0,yt.jsxs)("select",{value:i.post_type,onChange:e=>l(t=>({...t,post_type:e.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,yt.jsx)("option",{value:"",children:"All Types"}),(0,yt.jsx)("option",{value:"post",children:"Posts"}),(0,yt.jsx)("option",{value:"page",children:"Pages"}),(0,yt.jsx)("option",{value:"product",children:"Products"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Date"}),(0,yt.jsx)("input",{type:"date",value:i.date_from,onChange:e=>l(t=>({...t,date_from:e.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To Date"}),(0,yt.jsx)("input",{type:"date",value:i.date_to,onChange:e=>l(t=>({...t,date_to:e.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)(Ut,{variant:"primary",size:"lg",onClick:f,loading:g.isLoading,disabled:!t.trim(),children:[(0,yt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search"]}),null!==d&&(0,yt.jsxs)("span",{className:"text-sm text-gray-500",children:["Query time: ",d,"ms"]})]})]}),g.isError&&(0,yt.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,yt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,yt.jsx)("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,yt.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-medium text-red-800",children:"Search failed"}),(0,yt.jsx)("p",{className:"text-sm text-red-600 mt-1",children:g.error?.message||"An error occurred while searching"})]})]})}),(0,yt.jsxs)("div",{className:"space-y-4",children:[null!==o&&o.length>0&&(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("h2",{className:"text-lg font-medium text-gray-900",children:[o.length," result",1!==o.length?"s":""," found"]}),(0,yt.jsx)("button",{onClick:()=>m(h.size===o.length?new Set:new Set(o.map((e,t)=>t))),className:"text-sm text-blue-600 hover:text-blue-800",children:h.size===o.length?"Collapse all":"Expand all"})]}),null===o?(0,yt.jsx)(Er,{hasQuery:!1}):0===o.length?(0,yt.jsx)(Er,{hasQuery:!0}):(0,yt.jsx)("div",{className:"space-y-4",children:o.map((e,t)=>(0,yt.jsx)(Fr,{result:e,isExpanded:h.has(t),onToggleExpand:()=>b(t),onViewSource:()=>v(e)},e.chunk_id||t))})]})]})}const Ar=[{name:"post",label:"Posts",description:"Standard blog posts"},{name:"page",label:"Pages",description:"Static pages"},{name:"product",label:"Products",description:"WooCommerce products"},{name:"attachment",label:"Media",description:"Media library attachments"}],zr={enabled:!0,post_types:["post","page","product","attachment"],embedding_model:"openai/text-embedding-3-small",chunk_target_tokens:450,chunk_overlap_tokens:60,batch_size:25,max_scan_vectors:1e4,pii_detection:!1,block_on_pii:!1};function Tr({id:e,label:t,value:s,min:n,max:r,step:a,onChange:i,helpText:l,displayValue:o}){return(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsx)("label",{htmlFor:e,className:"block text-sm font-medium text-gray-700",children:t}),(0,yt.jsx)("span",{className:"text-sm font-semibold text-blue-600",children:o||s})]}),(0,yt.jsx)("input",{id:e,type:"range",value:s,min:n,max:r,step:a,onChange:e=>i(parseFloat(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"}),l&&(0,yt.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:l})]})}function Dr({id:e,label:t,description:s,checked:n,onChange:r}){return(0,yt.jsxs)("label",{htmlFor:e,className:"flex items-start gap-3 cursor-pointer",children:[(0,yt.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,yt.jsx)("input",{id:e,type:"checkbox",checked:n,onChange:e=>r(e.target.checked),className:"sr-only"}),(0,yt.jsx)("div",{className:`\n            w-10 h-6 rounded-full transition-colors\n            ${n?"bg-blue-600":"bg-gray-300"}\n          `}),(0,yt.jsx)("div",{className:`\n            absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform\n            ${n?"translate-x-4":"translate-x-0"}\n          `})]}),(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("span",{className:"text-sm font-medium text-gray-900",children:t}),s&&(0,yt.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:s})]})]})}function Br({postTypes:e,selected:t,onChange:s}){return(0,yt.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,yt.jsxs)("label",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors",children:[(0,yt.jsx)("input",{type:"checkbox",checked:t.includes(e.name),onChange:()=>(e=>{const n=t.includes(e)?t.filter(t=>t!==e):[...t,e];s(n)})(e.name),className:"mt-0.5 w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.label}),e.description&&(0,yt.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:e.description})]})]},e.name))})}function Vr({vibeAiData:e}){const{data:t,isLoading:s,isError:n,error:r}=ys({queryKey:["kb-settings"],queryFn:()=>lr("/kb/settings"),staleTime:6e4}),i=function(){const e=wt();return ws({mutationFn:e=>or("/kb/settings",e),onSuccess:()=>{e.invalidateQueries(["kb-settings"])}})}(),[l,o]=(0,a.useState)(null),[c,d]=(0,a.useState)(!1);(0,a.useEffect)(()=>{var e,s,n;t&&(o({enabled:null!==(e=t.enabled)&&void 0!==e?e:zr.enabled,post_types:t.post_types||zr.post_types,embedding_model:t.embedding_model||zr.embedding_model,chunk_target_tokens:t.chunk_target_tokens||zr.chunk_target_tokens,chunk_overlap_tokens:t.chunk_overlap_tokens||zr.chunk_overlap_tokens,batch_size:t.batch_size||zr.batch_size,max_scan_vectors:t.max_scan_vectors||zr.max_scan_vectors,pii_detection:null!==(s=t.pii_detection)&&void 0!==s?s:zr.pii_detection,block_on_pii:null!==(n=t.block_on_pii)&&void 0!==n?n:zr.block_on_pii}),d(!1))},[t]);const u=(0,a.useCallback)((e,t)=>{o(s=>{if(!s)return s;const n={...s,[e]:t};return d(!0),n})},[]),h=(0,a.useCallback)(async()=>{if(l)try{await i.mutateAsync(l),d(!1)}catch(e){}},[l,i]),m=(0,a.useCallback)(()=>{window.confirm("Are you sure you want to reset all settings to defaults?")&&(o(zr),d(!0))},[]);return s?(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,yt.jsx)("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,yt.jsx)("span",{className:"text-sm text-gray-500",children:"Loading settings..."})]})}):n?(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:(0,yt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,yt.jsx)("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-medium text-red-800",children:"Failed to load settings"}),(0,yt.jsx)("p",{className:"text-sm text-red-600 mt-1",children:r?.message})]})]})})}):l?(0,yt.jsxs)("div",{className:"p-6 max-w-3xl mx-auto",children:[(0,yt.jsxs)("div",{className:"mb-8",children:[(0,yt.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Knowledge Base Settings"}),(0,yt.jsx)("p",{className:"mt-1 text-slate-500",children:"Configure document indexing and embedding settings"})]}),(0,yt.jsxs)("div",{className:"space-y-8",children:[(0,yt.jsxs)("section",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,yt.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:(0,yt.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"General"})}),(0,yt.jsx)("div",{className:"px-6 py-6",children:(0,yt.jsx)(Dr,{id:"kb-enabled",label:"Enable Knowledge Base",description:"When enabled, documents will be indexed for AI-powered search",checked:l.enabled,onChange:e=>u("enabled",e)})})]}),(0,yt.jsxs)("section",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,yt.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:[(0,yt.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Post Types"}),(0,yt.jsx)("p",{className:"text-sm text-gray-500 mt-0.5",children:"Select which post types should be indexed"})]}),(0,yt.jsxs)("div",{className:"px-6 py-6",children:[(0,yt.jsx)(Br,{postTypes:t?.available_post_types||Ar,selected:l.post_types,onChange:e=>u("post_types",e)}),0===l.post_types.length&&(0,yt.jsx)("div",{className:"mt-3 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:(0,yt.jsxs)("p",{className:"text-sm text-amber-800",children:[(0,yt.jsx)("strong",{children:"Warning:"})," No post types selected. No content will be indexed."]})})]})]}),(0,yt.jsxs)("section",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,yt.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:[(0,yt.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Embedding Model"}),(0,yt.jsx)("p",{className:"text-sm text-gray-500 mt-0.5",children:"Configure the embedding model for vector search"})]}),(0,yt.jsxs)("div",{className:"px-6 py-6",children:[(0,yt.jsx)("label",{htmlFor:"embedding-model",className:"block text-sm font-medium text-gray-700 mb-2",children:"Model Name"}),(0,yt.jsx)("input",{id:"embedding-model",type:"text",value:l.embedding_model,onChange:e=>u("embedding_model",e.target.value),placeholder:"openai/text-embedding-3-small",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,yt.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"OpenRouter embedding model (e.g., openai/text-embedding-3-small, openai/text-embedding-3-large)"})]})]}),(0,yt.jsxs)("section",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,yt.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:[(0,yt.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Chunk Settings"}),(0,yt.jsx)("p",{className:"text-sm text-gray-500 mt-0.5",children:"Configure how documents are split into chunks"})]}),(0,yt.jsxs)("div",{className:"px-6 py-6 space-y-6",children:[(0,yt.jsx)(Tr,{id:"chunk-target-tokens",label:"Target Tokens per Chunk",value:l.chunk_target_tokens,min:200,max:800,step:50,onChange:e=>u("chunk_target_tokens",e),displayValue:`${l.chunk_target_tokens} tokens`,helpText:"Target size for each chunk. Larger chunks provide more context but may be less precise."}),(0,yt.jsx)(Tr,{id:"chunk-overlap-tokens",label:"Overlap Tokens",value:l.chunk_overlap_tokens,min:20,max:150,step:10,onChange:e=>u("chunk_overlap_tokens",e),displayValue:`${l.chunk_overlap_tokens} tokens`,helpText:"Number of tokens to overlap between consecutive chunks for continuity."})]})]}),(0,yt.jsxs)("section",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,yt.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:[(0,yt.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Batch Settings"}),(0,yt.jsx)("p",{className:"text-sm text-gray-500 mt-0.5",children:"Configure processing batch sizes"})]}),(0,yt.jsxs)("div",{className:"px-6 py-6 space-y-6",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{htmlFor:"batch-size",className:"block text-sm font-medium text-gray-700 mb-2",children:"Batch Size"}),(0,yt.jsx)("input",{id:"batch-size",type:"number",min:5,max:100,value:l.batch_size,onChange:e=>u("batch_size",parseInt(e.target.value,10)||25),className:"w-32 px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,yt.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Number of documents to process per batch (5-100)"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{htmlFor:"max-scan-vectors",className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Scan Vectors"}),(0,yt.jsx)("input",{id:"max-scan-vectors",type:"number",min:1e3,max:5e4,step:1e3,value:l.max_scan_vectors,onChange:e=>u("max_scan_vectors",parseInt(e.target.value,10)||1e4),className:"w-32 px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,yt.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Maximum vectors to scan during search (1,000-50,000)"})]})]})]}),(0,yt.jsxs)("section",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,yt.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:[(0,yt.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Safety Controls"}),(0,yt.jsx)("p",{className:"text-sm text-gray-500 mt-0.5",children:"Configure privacy and safety settings"})]}),(0,yt.jsxs)("div",{className:"px-6 py-6 space-y-4",children:[(0,yt.jsx)(Dr,{id:"pii-detection",label:"PII Detection",description:"Scan documents for personally identifiable information during indexing",checked:l.pii_detection,onChange:e=>u("pii_detection",e)}),(0,yt.jsx)(Dr,{id:"block-on-pii",label:"Block Indexing on PII",description:"Prevent indexing documents that contain detected PII",checked:l.block_on_pii,onChange:e=>u("block_on_pii",e)}),l.block_on_pii&&!l.pii_detection&&(0,yt.jsx)("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:(0,yt.jsxs)("p",{className:"text-sm text-amber-800",children:[(0,yt.jsx)("strong",{children:"Note:"})," PII Detection must be enabled for this setting to take effect."]})})]})]}),(0,yt.jsxs)("div",{className:"flex items-center justify-between py-4",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-4",children:[c&&(0,yt.jsxs)("span",{className:"text-sm text-amber-600 flex items-center gap-1",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"You have unsaved changes"]}),i.isSuccess&&!c&&(0,yt.jsxs)("span",{className:"text-sm text-green-600 flex items-center gap-1",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Settings saved successfully"]}),i.isError&&(0,yt.jsxs)("span",{className:"text-sm text-red-600 flex items-center gap-1",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),i.error?.message||"Failed to save settings"]})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,yt.jsx)(Ut,{variant:"secondary",onClick:m,children:"Reset to Defaults"}),(0,yt.jsxs)(Ut,{variant:"primary",onClick:h,disabled:!c,loading:i.isLoading,children:[(0,yt.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save Settings"]})]})]})]})]}):null}const Wr=[{value:"",label:"All Events"},{value:"document_built",label:"Document Built"},{value:"chunk_built",label:"Chunk Built"},{value:"embed_batch",label:"Embed Batch"},{value:"search",label:"Search"},{value:"error",label:"Error"}],Hr=[{value:"",label:"All Levels",color:"bg-gray-100 text-gray-700"},{value:"info",label:"INFO",color:"bg-blue-100 text-blue-700"},{value:"warning",label:"WARNING",color:"bg-yellow-100 text-yellow-700"},{value:"error",label:"ERROR",color:"bg-red-100 text-red-700"}];function $r({level:e}){const t=Hr.find(t=>t.value===e?.toLowerCase())||Hr[0];return(0,yt.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${t.color}`,children:(e||"INFO").toUpperCase()})}function qr({eventType:e}){const t={document_built:"bg-green-100 text-green-700",chunk_built:"bg-blue-100 text-blue-700",embed_batch:"bg-purple-100 text-purple-700",search:"bg-indigo-100 text-indigo-700",error:"bg-red-100 text-red-700"}[e]||"bg-gray-100 text-gray-700",s=e?.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())||"Unknown";return(0,yt.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${t}`,children:s})}function Ur({log:e,isExpanded:t,onToggle:s}){const n=e.context&&Object.keys(e.context).length>0;return(0,yt.jsxs)("div",{className:`\n        border rounded-lg overflow-hidden transition-colors\n        ${"error"===e.level?"border-red-200 bg-red-50":""}\n        ${"warning"===e.level?"border-yellow-200 bg-yellow-50":""}\n        ${"error"!==e.level&&"warning"!==e.level?"border-gray-200 bg-white":""}\n      `,children:[(0,yt.jsxs)("button",{onClick:s,className:"w-full px-4 py-3 flex items-start gap-3 text-left hover:bg-opacity-80 transition-colors",children:[n?(0,yt.jsx)("svg",{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0 transition-transform "+(t?"rotate-90":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}):(0,yt.jsx)("div",{className:"w-4"}),(0,yt.jsx)("span",{className:"text-xs text-gray-400 font-mono flex-shrink-0 mt-0.5",children:new Date(e.timestamp).toLocaleTimeString()}),(0,yt.jsx)($r,{level:e.level}),e.event_type&&(0,yt.jsx)(qr,{eventType:e.event_type}),(0,yt.jsx)("span",{className:"text-sm text-gray-700 flex-1 truncate",children:e.message})]}),t&&n&&(0,yt.jsx)("div",{className:"px-4 pb-4 pt-0",children:(0,yt.jsx)("div",{className:"ml-8 p-3 bg-gray-800 rounded-lg overflow-x-auto",children:(0,yt.jsx)("pre",{className:"text-xs text-gray-300 font-mono whitespace-pre-wrap",children:JSON.stringify(e.context,null,2)})})})]})}function Qr({vibeAiData:e}){const[t,s]=(0,a.useState)(1),[n,r]=(0,a.useState)(50),[i,l]=(0,a.useState)(""),[o,c]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),[h,m]=(0,a.useState)(new Set),[g,p]=(0,a.useState)(!1),{data:x,isLoading:f,isError:v,error:b,isFetching:y,refetch:j}=ys({queryKey:["kb-logs",t,n,i,o,d],queryFn:()=>(async({page:e,pageSize:t,eventType:s,level:n,date:r})=>{const a=new URLSearchParams({page:e.toString(),per_page:t.toString(),...s&&{event_type:s},...n&&{level:n},...r&&{date:r}}),i=await fetch(`${window.vibeAiData?.apiUrl||"/wp-json/vibe-ai/v1"}/kb/logs?${a}`,{headers:{"X-WP-Nonce":window.vibeAiData?.nonce||""}});if(!i.ok)throw new Error("Failed to fetch logs");return{logs:await i.json(),totalCount:parseInt(i.headers.get("X-WP-Total")||"0",10),totalPages:parseInt(i.headers.get("X-WP-TotalPages")||"1",10)}})({page:t,pageSize:n,eventType:i,level:o,date:d}),keepPreviousData:!0,staleTime:3e4,refetchInterval:!!g&&5e3}),w=(0,a.useCallback)(e=>{m(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),N=(0,a.useCallback)(e=>t=>{e(t),s(1)},[]),C=(0,a.useCallback)(()=>{l(""),c(""),u(""),s(1)},[]),k=(0,a.useMemo)(()=>x?.logs?x.logs.reduce((e,t)=>{const s=t.level?.toLowerCase();return"info"===s?e.info++:"warning"===s?e.warning++:"error"===s&&e.error++,e},{info:0,warning:0,error:0}):{info:0,warning:0,error:0},[x?.logs]);if(f)return(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,yt.jsx)("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,yt.jsx)("span",{className:"text-sm text-gray-500",children:"Loading logs..."})]})});if(v)return(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:(0,yt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,yt.jsx)("svg",{className:"w-5 h-5 text-red-500 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-medium text-red-800",children:"Failed to load logs"}),(0,yt.jsx)("p",{className:"text-sm text-red-600 mt-1",children:b?.message})]})]})})});const S=(new Date).toISOString().split("T")[0];return(0,yt.jsxs)("div",{className:"p-6 space-y-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"KB Logs"}),(0,yt.jsx)("p",{className:"mt-1 text-slate-500",children:"View Knowledge Base indexing and search logs"})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-4",children:[y&&!f&&(0,yt.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,yt.jsx)("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),"Refreshing..."]}),(0,yt.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,yt.jsx)("input",{type:"checkbox",checked:g,onChange:e=>p(e.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,yt.jsx)("span",{className:"text-sm text-gray-600",children:"Auto-refresh"})]}),(0,yt.jsxs)("button",{onClick:()=>j(),className:"inline-flex items-center gap-1 px-3 py-1.5 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,yt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("span",{className:"text-sm font-medium text-blue-700",children:"Info"}),(0,yt.jsx)("span",{className:"text-2xl font-bold text-blue-900",children:k.info})]})}),(0,yt.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("span",{className:"text-sm font-medium text-yellow-700",children:"Warnings"}),(0,yt.jsx)("span",{className:"text-2xl font-bold text-yellow-900",children:k.warning})]})}),(0,yt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("span",{className:"text-sm font-medium text-red-700",children:"Errors"}),(0,yt.jsx)("span",{className:"text-2xl font-bold text-red-900",children:k.error})]})})]}),(0,yt.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,yt.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Event:"}),(0,yt.jsx)("select",{value:i,onChange:e=>N(l)(e.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Wr.map(e=>(0,yt.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Level:"}),(0,yt.jsx)("select",{value:o,onChange:e=>N(c)(e.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Hr.map(e=>(0,yt.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Date:"}),(0,yt.jsx)("input",{type:"date",value:d,max:S,onChange:e=>N(u)(e.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(i||o||d)&&(0,yt.jsxs)("button",{onClick:C,className:"inline-flex items-center gap-1.5 px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:[(0,yt.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear filters"]}),(0,yt.jsxs)("span",{className:"text-sm text-gray-500 ml-auto",children:[x?.totalCount||0," entries"]})]})}),0===x?.logs?.length?(0,yt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[(0,yt.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,yt.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No logs found"}),(0,yt.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:i||o||d?"Try adjusting your filters":"KB logs will appear here as documents are indexed"})]}):(0,yt.jsx)("div",{className:"space-y-2",children:x?.logs?.map(e=>(0,yt.jsx)(Ur,{log:e,isExpanded:h.has(e.id),onToggle:()=>w(e.id)},e.id))}),x?.totalPages>1&&(0,yt.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 px-4 py-3",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,yt.jsxs)("span",{children:["Page ",t," of ",x.totalPages]}),(0,yt.jsx)("select",{value:n,onChange:e=>{r(Number(e.target.value)),s(1)},className:"px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:[25,50,100].map(e=>(0,yt.jsxs)("option",{value:e,children:[e," per page"]},e))})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-1",children:[(0,yt.jsx)("button",{onClick:()=>s(1),disabled:1===t,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),(0,yt.jsx)("button",{onClick:()=>s(e=>Math.max(1,e-1)),disabled:1===t,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,yt.jsx)("button",{onClick:()=>s(e=>Math.min(x.totalPages,e+1)),disabled:t>=x.totalPages,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),(0,yt.jsx)("button",{onClick:()=>s(x.totalPages),disabled:t>=x.totalPages,className:"p-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:(0,yt.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})})]})]})})]})}function Gr({vibeAiData:e}){return(0,yt.jsxs)(he,{children:[(0,yt.jsx)(de,{path:"/",element:(0,yt.jsx)(yr,{vibeAiData:e})}),(0,yt.jsx)(de,{path:"/documents",element:(0,yt.jsx)(Mr,{vibeAiData:e})}),(0,yt.jsx)(de,{path:"/search",element:(0,yt.jsx)(Or,{vibeAiData:e})}),(0,yt.jsx)(de,{path:"/settings",element:(0,yt.jsx)(Vr,{vibeAiData:e})}),(0,yt.jsx)(de,{path:"/logs",element:(0,yt.jsx)(Qr,{vibeAiData:e})}),(0,yt.jsx)(de,{path:"*",element:(0,yt.jsx)(ce,{to:"/kb",replace:!0})})]})}const Kr=window.vibeAiData||{apiUrl:"/wp-json/vibe-ai/v1",nonce:"",adminUrl:"/wp-admin/",pluginUrl:"",version:"1.0.0",pollingInterval:2e3},Xr=new class{#Q;#f;#h;#G;#K;#X;#J;#Y;constructor(e={}){this.#Q=e.queryCache||new mt,this.#f=e.mutationCache||new pt,this.#h=e.defaultOptions||{},this.#G=new Map,this.#K=new Map,this.#X=0}mount(){this.#X++,1===this.#X&&(this.#J=tt.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#Q.onFocus())}),this.#Y=st.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#Q.onOnline())}))}unmount(){this.#X--,0===this.#X&&(this.#J?.(),this.#J=void 0,this.#Y?.(),this.#Y=void 0)}isFetching(e){return this.#Q.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#f.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#Q.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=this.#Q.build(this,t),n=s.state.data;return void 0===n?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(Fe(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return this.#Q.findAll(e).map(({queryKey:e,state:t})=>[e,t.data])}setQueryData(e,t,s){const n=this.defaultQueryOptions({queryKey:e}),r=this.#Q.get(n.queryHash),a=r?.state.data,i=function(e,t){return"function"==typeof e?e(t):e}(t,a);if(void 0!==i)return this.#Q.build(this,n).setData(i,{...s,manual:!0})}setQueriesData(e,t,s){return Ze.batch(()=>this.#Q.findAll(e).map(({queryKey:e})=>[e,this.setQueryData(e,t,s)]))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#Q.get(t.queryHash)?.state}removeQueries(e){const t=this.#Q;Ze.batch(()=>{t.findAll(e).forEach(e=>{t.remove(e)})})}resetQueries(e,t){const s=this.#Q;return Ze.batch(()=>(s.findAll(e).forEach(e=>{e.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const s={revert:!0,...t},n=Ze.batch(()=>this.#Q.findAll(e).map(e=>e.cancel(s)));return Promise.all(n).then(Pe).catch(Pe)}invalidateQueries(e,t={}){return Ze.batch(()=>(this.#Q.findAll(e).forEach(e=>{e.invalidate()}),"none"===e?.refetchType?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t)))}refetchQueries(e,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},n=Ze.batch(()=>this.#Q.findAll(e).filter(e=>!e.isDisabled()&&!e.isStatic()).map(e=>{let t=e.fetch(void 0,s);return s.throwOnError||(t=t.catch(Pe)),"paused"===e.state.fetchStatus?Promise.resolve():t}));return Promise.all(n).then(Pe)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const s=this.#Q.build(this,t);return s.isStaleByTime(Fe(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Pe).catch(Pe)}fetchInfiniteQuery(e){return e.behavior=ft(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Pe).catch(Pe)}ensureInfiniteQueryData(e){return e.behavior=ft(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return st.isOnline()?this.#f.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#Q}getMutationCache(){return this.#f}getDefaultOptions(){return this.#h}setDefaultOptions(e){this.#h=e}setQueryDefaults(e,t){this.#G.set(Te(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#G.values()],s={};return t.forEach(t=>{De(e,t.queryKey)&&Object.assign(s,t.defaultOptions)}),s}setMutationDefaults(e,t){this.#K.set(Te(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#K.values()],s={};return t.forEach(t=>{De(e,t.mutationKey)&&Object.assign(s,t.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#h.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=ze(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Ke&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#h.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#Q.clear(),this.#f.clear()}}({defaultOptions:{queries:{staleTime:3e5,retry:1,refetchOnWindowFocus:!1}}});function Jr(){const[e,t]=(0,a.useState)(!1),[s,n]=(0,a.useState)(null),r=(0,a.useCallback)(()=>{t(e=>!e)},[]),i=(0,a.useCallback)(e=>{n(e)},[]),l=(0,a.useCallback)(()=>{n(null)},[]);return(0,yt.jsx)(Nt,{client:Xr,children:(0,yt.jsx)(ye,{children:(0,yt.jsxs)("div",{id:"vibe-ai-admin",className:"flex flex-col min-h-screen bg-slate-50",children:[(0,yt.jsx)(Mt,{onToggleSidebar:r,vibeAiData:Kr}),(0,yt.jsxs)("div",{className:"flex flex-1",children:[(0,yt.jsx)(_t,{collapsed:e}),(0,yt.jsx)("main",{className:"flex-1 transition-all duration-300 "+(e?"ml-16":"ml-56"),children:(0,yt.jsxs)(he,{children:[(0,yt.jsx)(de,{path:"/",element:(0,yt.jsx)(ce,{to:"/dashboard",replace:!0})}),(0,yt.jsx)(de,{path:"/dashboard",element:(0,yt.jsx)(us,{vibeAiData:Kr})}),(0,yt.jsx)(de,{path:"/entities",element:(0,yt.jsx)(Qn,{vibeAiData:Kr,onEntitySelect:i})}),(0,yt.jsx)(de,{path:"/entities/:id",element:(0,yt.jsx)(Qn,{vibeAiData:Kr,onEntitySelect:i})}),(0,yt.jsx)(de,{path:"/settings",element:(0,yt.jsx)(Zn,{vibeAiData:Kr})}),(0,yt.jsx)(de,{path:"/logs",element:(0,yt.jsx)(rr,{vibeAiData:Kr})}),(0,yt.jsx)(de,{path:"/kb/*",element:(0,yt.jsx)(Gr,{vibeAiData:Kr})}),(0,yt.jsx)(de,{path:"*",element:(0,yt.jsx)(ce,{to:"/dashboard",replace:!0})})]})}),s&&(0,yt.jsx)(Vn,{entityId:s,onClose:l,vibeAiData:Kr})]})]})})})}const Yr=()=>{const e=document.getElementById("vibe-ai-admin");e?(0,r.H)(e).render((0,yt.jsx)(a.StrictMode,{children:(0,yt.jsx)(Jr,{})})):console.error("AI Entity Index: Admin container #vibe-ai-admin not found")};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",Yr):Yr()}();